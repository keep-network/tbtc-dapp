{
  "contractName": "CheckBitcoinSigs",
  "abi": [
    {
      "constant": true,
      "inputs": [
        {
          "name": "_pubkey",
          "type": "bytes"
        }
      ],
      "name": "accountFromPubkey",
      "outputs": [
        {
          "name": "",
          "type": "address"
        }
      ],
      "payable": false,
      "stateMutability": "pure",
      "type": "function"
    },
    {
      "constant": true,
      "inputs": [
        {
          "name": "_pubkey",
          "type": "bytes"
        }
      ],
      "name": "p2wpkhFromPubkey",
      "outputs": [
        {
          "name": "",
          "type": "bytes"
        }
      ],
      "payable": false,
      "stateMutability": "pure",
      "type": "function"
    },
    {
      "constant": true,
      "inputs": [
        {
          "name": "_pubkey",
          "type": "bytes"
        },
        {
          "name": "_digest",
          "type": "bytes32"
        },
        {
          "name": "_v",
          "type": "uint8"
        },
        {
          "name": "_r",
          "type": "bytes32"
        },
        {
          "name": "_s",
          "type": "bytes32"
        }
      ],
      "name": "checkSig",
      "outputs": [
        {
          "name": "",
          "type": "bool"
        }
      ],
      "payable": false,
      "stateMutability": "pure",
      "type": "function"
    },
    {
      "constant": true,
      "inputs": [
        {
          "name": "_p2wpkhOutputScript",
          "type": "bytes"
        },
        {
          "name": "_pubkey",
          "type": "bytes"
        },
        {
          "name": "_digest",
          "type": "bytes32"
        },
        {
          "name": "_v",
          "type": "uint8"
        },
        {
          "name": "_r",
          "type": "bytes32"
        },
        {
          "name": "_s",
          "type": "bytes32"
        }
      ],
      "name": "checkBitcoinSig",
      "outputs": [
        {
          "name": "",
          "type": "bool"
        }
      ],
      "payable": false,
      "stateMutability": "pure",
      "type": "function"
    },
    {
      "constant": true,
      "inputs": [
        {
          "name": "_candidate",
          "type": "bytes"
        },
        {
          "name": "_digest",
          "type": "bytes32"
        }
      ],
      "name": "isSha256Preimage",
      "outputs": [
        {
          "name": "",
          "type": "bool"
        }
      ],
      "payable": false,
      "stateMutability": "pure",
      "type": "function"
    },
    {
      "constant": true,
      "inputs": [
        {
          "name": "_candidate",
          "type": "bytes"
        },
        {
          "name": "_digest",
          "type": "bytes32"
        }
      ],
      "name": "isKeccak256Preimage",
      "outputs": [
        {
          "name": "",
          "type": "bool"
        }
      ],
      "payable": false,
      "stateMutability": "pure",
      "type": "function"
    },
    {
      "constant": true,
      "inputs": [
        {
          "name": "_outpoint",
          "type": "bytes"
        },
        {
          "name": "_inputPKH",
          "type": "bytes20"
        },
        {
          "name": "_inputValue",
          "type": "bytes8"
        },
        {
          "name": "_outputValue",
          "type": "bytes8"
        },
        {
          "name": "_outputPKH",
          "type": "bytes20"
        }
      ],
      "name": "oneInputOneOutputSighash",
      "outputs": [
        {
          "name": "",
          "type": "bytes32"
        }
      ],
      "payable": false,
      "stateMutability": "pure",
      "type": "function"
    }
  ],
  "metadata": "{\"compiler\":{\"version\":\"0.4.25+commit.59dbf8f1\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"constant\":true,\"inputs\":[{\"name\":\"_candidate\",\"type\":\"bytes\"},{\"name\":\"_digest\",\"type\":\"bytes32\"}],\"name\":\"isSha256Preimage\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"pure\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_candidate\",\"type\":\"bytes\"},{\"name\":\"_digest\",\"type\":\"bytes32\"}],\"name\":\"isKeccak256Preimage\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"pure\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_pubkey\",\"type\":\"bytes\"}],\"name\":\"p2wpkhFromPubkey\",\"outputs\":[{\"name\":\"\",\"type\":\"bytes\"}],\"payable\":false,\"stateMutability\":\"pure\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_p2wpkhOutputScript\",\"type\":\"bytes\"},{\"name\":\"_pubkey\",\"type\":\"bytes\"},{\"name\":\"_digest\",\"type\":\"bytes32\"},{\"name\":\"_v\",\"type\":\"uint8\"},{\"name\":\"_r\",\"type\":\"bytes32\"},{\"name\":\"_s\",\"type\":\"bytes32\"}],\"name\":\"checkBitcoinSig\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"pure\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_outpoint\",\"type\":\"bytes\"},{\"name\":\"_inputPKH\",\"type\":\"bytes20\"},{\"name\":\"_inputValue\",\"type\":\"bytes8\"},{\"name\":\"_outputValue\",\"type\":\"bytes8\"},{\"name\":\"_outputPKH\",\"type\":\"bytes20\"}],\"name\":\"oneInputOneOutputSighash\",\"outputs\":[{\"name\":\"\",\"type\":\"bytes32\"}],\"payable\":false,\"stateMutability\":\"pure\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_pubkey\",\"type\":\"bytes\"}],\"name\":\"accountFromPubkey\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"pure\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_pubkey\",\"type\":\"bytes\"},{\"name\":\"_digest\",\"type\":\"bytes32\"},{\"name\":\"_v\",\"type\":\"uint8\"},{\"name\":\"_r\",\"type\":\"bytes32\"},{\"name\":\"_s\",\"type\":\"bytes32\"}],\"name\":\"checkSig\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"pure\",\"type\":\"function\"}],\"devdoc\":{\"methods\":{\"accountFromPubkey(bytes)\":{\"details\":\"the address is the last 20 bytes of the keccak256 of the address\",\"params\":{\"_pubkey\":\"the public key\"},\"return\":\"the account address\"},\"checkBitcoinSig(bytes,bytes,bytes32,uint8,bytes32,bytes32)\":{\"details\":\"does this my verifying the p2wpkh matches an ethereum account\",\"params\":{\"_digest\":\"the message digest signed\",\"_p2wpkhOutputScript\":\"the bitcoin output script\",\"_pubkey\":\"the public key to check\",\"_r\":\"the signature r value\",\"_s\":\"the signature s value\",\"_v\":\"the signature recovery value\"},\"return\":\"true if signature is valid, else false\"},\"checkSig(bytes,bytes32,uint8,bytes32,bytes32)\":{\"details\":\"does this using ecrecover because Ethereum has no soul\",\"params\":{\"_digest\":\"the message digest signed\",\"_pubkey\":\"the public key to check (64 bytes)\",\"_r\":\"the signature r value\",\"_s\":\"the signature s value\",\"_v\":\"the signature recovery value\"},\"return\":\"true if signature is valid, else false\"},\"isKeccak256Preimage(bytes,bytes32)\":{\"details\":\"this step is necessary for ECDSA security!\",\"params\":{\"_candidate\":\"the purported preimage\",\"_digest\":\"the digest\"},\"return\":\"the p2wkph output script\"},\"isSha256Preimage(bytes,bytes32)\":{\"details\":\"this is NOT the hash256!  this step is necessary for ECDSA security!\",\"params\":{\"_candidate\":\"the purported preimage\",\"_digest\":\"the digest\"},\"return\":\"the p2wkph output script\"},\"oneInputOneOutputSighash(bytes,bytes20,bytes8,bytes8,bytes20)\":{\"details\":\"documented in bip143. many values are hardcoded here\",\"params\":{\"_inputPKH\":\"the input pubkeyhash (hash160(sender_pubkey))\",\"_inputValue\":\"the value of the input in satoshi\",\"_outpoint\":\"the bitcoin output script\",\"_outputPKH\":\"the output pubkeyhash (hash160(recipient_pubkey))\",\"_outputValue\":\"the value of the output in satoshi\"},\"return\":\"the double-sha256 (hash256) signature hash as defined by bip143\"},\"p2wpkhFromPubkey(bytes)\":{\"details\":\"pads uncompressed pubkeys to 65 bytes as required by Bitcoin\",\"params\":{\"_pubkey\":\"the public key\"},\"return\":\"the p2wkph output script\"}}},\"userdoc\":{\"methods\":{\"accountFromPubkey(bytes)\":{\"notice\":\"derives an Ethereum Account address from a pubkey\"},\"checkBitcoinSig(bytes,bytes,bytes32,uint8,bytes32,bytes32)\":{\"notice\":\"checks a signed message against a bitcoin p2wpkh output script\"},\"checkSig(bytes,bytes32,uint8,bytes32,bytes32)\":{\"notice\":\"checks a signed message's validity under a pubkey\"},\"isKeccak256Preimage(bytes,bytes32)\":{\"notice\":\"checks if a message is the keccak256 preimage of a digest\"},\"isSha256Preimage(bytes,bytes32)\":{\"notice\":\"checks if a message is the sha256 preimage of a digest\"},\"oneInputOneOutputSighash(bytes,bytes20,bytes8,bytes8,bytes20)\":{\"notice\":\"calculates the signature hash of a Bitcoin transaction with the provided details\"},\"p2wpkhFromPubkey(bytes)\":{\"notice\":\"calculates the p2wpkh output script of a pubkey\"}}}},\"settings\":{\"compilationTarget\":{\"/Users/liamz/go/src/github.com/keep-network/tbtc/implementation/contracts/bitcoin-spv/SigCheck.sol\":\"CheckBitcoinSigs\"},\"evmVersion\":\"byzantium\",\"libraries\":{},\"optimizer\":{\"enabled\":true,\"runs\":200},\"remappings\":[]},\"sources\":{\"/Users/liamz/go/src/github.com/keep-network/tbtc/implementation/contracts/bitcoin-spv/BTCUtils.sol\":{\"keccak256\":\"0x63ad2de34645a8bc8f998ae8d57eea559ff8d987761211ee32d56288d873ded6\",\"urls\":[\"bzzr://abff5be7f9fd5296c7ba65f39173ad2e86bd040eeaebedb2e7e446fb627264d2\"]},\"/Users/liamz/go/src/github.com/keep-network/tbtc/implementation/contracts/bitcoin-spv/BytesLib.sol\":{\"keccak256\":\"0x930a1b7b14b0e918f10c12aa8644d7824437b507ed448f03356b080f522f27ed\",\"urls\":[\"bzzr://e0dacffdd3ca5ebe76039a597b72b52b00daa08a2582a1640aa6c30c3cdbd9e5\"]},\"/Users/liamz/go/src/github.com/keep-network/tbtc/implementation/contracts/bitcoin-spv/SafeMath.sol\":{\"keccak256\":\"0x0708e2bd2b186fb4843e85d0ab834392a8070040450e604756eb074c196f3abf\",\"urls\":[\"bzzr://4464e9fa55d1c5e1d998f0bab88f544a4dce589e6ad0d42416d0a91e2dda447e\"]},\"/Users/liamz/go/src/github.com/keep-network/tbtc/implementation/contracts/bitcoin-spv/SigCheck.sol\":{\"keccak256\":\"0x9f7c9a86ff9ce960eabcb787ef2dc56129d0928d73fb332fb3a5457ead7a8287\",\"urls\":[\"bzzr://8e5c793d1c80229fa14bef89cb1b7de3504ebc7de6564c4592e6eb243c796d23\"]}},\"version\":1}",
  "bytecode": "0x611118610030600b82828239805160001a6073146000811461002057610022565bfe5b5030600052607381538281f30073000000000000000000000000000000000000000030146080604052600436106100995763ffffffff7c01000000000000000000000000000000000000000000000000000000006000350416633cab9126811461009e5780633f43b4a0146101005780633f69fc971461014e5780637452ab241461020f578063831567a0146102ad5780638ad522f91461034e578063cac9c974146103c3575b600080fd5b6040805160206004803580820135601f81018490048402850184019095528484526100ec94369492936024939284019190819084018382808284375094975050933594506104239350505050565b604080519115158252519081900360200190f35b6040805160206004803580820135601f81018490048402850184019095528484526100ec94369492936024939284019190819084018382808284375094975050933594506104bc9350505050565b6040805160206004803580820135601f810184900484028501840190955284845261019a94369492936024939284019190819084018382808284375094975061052a9650505050505050565b6040805160208082528351818301528351919283929083019185019080838360005b838110156101d45781810151838201526020016101bc565b50505050905090810190601f1680156102015780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6040805160206004803580820135601f81018490048402850184019095528484526100ec94369492936024939284019190819084018382808284375050604080516020601f89358b018035918201839004830284018301909452808352979a9998810197919650918201945092508291508401838280828437509497505084359550505050602082013560ff169160408101359150606001356107c1565b6040805160206004803580820135601f810184900484028501840190955284845261033c943694929360249392840191908190840183828082843750949750506bffffffffffffffffffffffff1985358116965077ffffffffffffffffffffffffffffffffffffffffffffffff19602087013581169660408101359091169550606001351692506108d6915050565b60408051918252519081900360200190f35b6040805160206004803580820135601f810184900484028501840190955284845261039a943694929360249392840191908190840183828082843750949750610e169650505050505050565b6040805173ffffffffffffffffffffffffffffffffffffffff9092168252519081900360200190f35b6040805160206004803580820135601f81018490048402850184019095528484526100ec9436949293602493928401919081908401838280828437509497505084359550505050602082013560ff16916040810135915060600135610eb3565b600081600019166002846040518082805190602001908083835b6020831061045c5780518252601f19909201916020918201910161043d565b51815160209384036101000a600019018019909216911617905260405191909301945091925050808303816000865af115801561049d573d6000803e3d6000fd5b5050506040513d60208110156104b257600080fd5b5051149392505050565b60008160001916836040518082805190602001908083835b602083106104f35780518252601f1990920191602091820191016104d4565b5181516020939093036101000a60001901801990911692169190911790526040519201829003909120939093149695505050505050565b6060808251604014156105c9578260405160200180807f040000000000000000000000000000000000000000000000000000000000000081525060010182805190602001908083835b602083106105925780518252601f199092019160209182019101610573565b6001836020036101000a03801982511681845116808217855250505050505090500191505060405160208183030381529060405292505b82516041146105d757600080fd5b6040517f48cf5c9400000000000000000000000000000000000000000000000000000000815260206004820181815285516024840152855173__BTCUtils______________________________936348cf5c949388939283926044019185019080838360005b8381101561065557818101518382015260200161063d565b50505050905090810190601f1680156106825780820380516001836020036101000a031916815260200191505b509250505060006040518083038186803b15801561069f57600080fd5b505af41580156106b3573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f1916820160405260208110156106dc57600080fd5b8101908080516401000000008111156106f457600080fd5b8201602081018481111561070757600080fd5b815164010000000081118282018710171561072157600080fd5b505092919050505090508060405160200180807e1400000000000000000000000000000000000000000000000000000000000081525060020182805190602001908083835b602083106107855780518252601f199092019160209182019101610766565b6001836020036101000a038019825116818451168082178552505050505050905001915050604051602081830303815290604052915050919050565b60008060606000896040518082805190602001908083835b602083106107f85780518252601f1990920191602091820191016107d9565b6001836020036101000a0380198251168184511680821785525050505050509050019150506040518091039020600019166108328a61052a565b6040518082805190602001908083835b602083106108615780518252601f199092019160209182019101610842565b5181516000196020949094036101000a8401908116901991909116179052604051939091018390039092208e51951497506108ad948e945060019350909101905063ffffffff610f5116565b91506108bc8289898989610eb3565b90508280156108c85750805b9a9950505050505050505050565b604080517f1976a914000000000000000000000000000000000000000000000000000000006020808301919091526bffffffffffffffffffffffff1980881660248401527f88ac00000000000000000000000000000000000000000000000000000000000060388401528351601a818503018152603a8401855277ffffffffffffffffffffffffffffffffffffffffffffffff198716605a8501527f1600140000000000000000000000000000000000000000000000000000000000606285015290851660658401528351605981850301815260798401948590527f39efb09a00000000000000000000000000000000000000000000000000000000909452607d83018281528451609d85015284516000959294869460609473__BTCUtils______________________________946339efb09a9491939092839260bd90920191908501908083838c5b83811015610a38578181015183820152602001610a20565b50505050905090810190601f168015610a655780820380516001836020036101000a031916815260200191505b509250505060206040518083038186803b158015610a8257600080fd5b505af4158015610a96573d6000803e3d6000fd5b505050506040513d6020811015610aac57600080fd5b50516040517f39efb09a0000000000000000000000000000000000000000000000000000000081526020600482018181528c5160248401528c5193955073__BTCUtils______________________________936339efb09a938e9383926044909201919085019080838360005b83811015610b31578181015183820152602001610b19565b50505050905090810190601f168015610b5e5780820380516001836020036101000a031916815260200191505b509250505060206040518083038186803b158015610b7b57600080fd5b505af4158015610b8f573d6000803e3d6000fd5b505050506040513d6020811015610ba557600080fd5b50516040517f01000000000000000000000000000000000000000000000000000000000000006020828101918252602483018490527f8cb9012517c817fead650287d61bdd9c68803b6bf9c64133dcab3e65b5a50cb960448401528c518d9388938d938993919260640191908701908083835b60208310610c375780518252601f199092019160209182019101610c18565b51815160209384036101000a600019018019909216911617905287519190930192870191508083835b60208310610c7f5780518252601f199092019160209182019101610c60565b51815160209384036101000a600019018019909216911617905277ffffffffffffffffffffffffffffffffffffffffffffffff1996909616920191825250600060088201819052600c820193909352602c81018390527f0100000000000000000000000000000000000000000000000000000000000000603082015260408051808303601401815260348301918290527f39efb09a000000000000000000000000000000000000000000000000000000009091526038820185815281516058840152815191995073__BTCUtils______________________________98506339efb09a9750899650948594607890930193508601918190849084905b83811015610d93578181015183820152602001610d7b565b50505050905090810190601f168015610dc05780820380516001836020036101000a031916815260200191505b509250505060206040518083038186803b158015610ddd57600080fd5b505af4158015610df1573d6000803e3d6000fd5b505050506040513d6020811015610e0757600080fd5b50519998505050505050505050565b6000606082516040141515610e2a57600080fd5b826040518082805190602001908083835b60208310610e5a5780518252601f199092019160209182019101610e3b565b51815160209384036101000a6000190180199092169116179052604080519290940182900382208282015283518083039091018152908301909252508051909350610eac925083915060131901611034565b9392505050565b6000806000610ec188610e16565b60408051600080825260208083018085528c905260ff8b1683850152606083018a905260808301899052925193955060019360a08084019493601f19830193908390039091019190865af1158015610f1d573d6000803e3d6000fd5b5050604051601f19015173ffffffffffffffffffffffffffffffffffffffff90811693169290921498975050505050505050565b606080828401855110151515610fc857604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601360248201527f536c696365206f7574206f6620626f756e647300000000000000000000000000604482015290519081900360640190fd5b82158015610fe15760405191506020820160405261102b565b6040519150601f8416801560200281840101858101878315602002848b0101015b8183101561101a578051835260209283019201611002565b5050858452601f01601f1916604052505b50949350505050565b600080826014018451101515156110d257604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152602160248201527f4164647265737320636f6e76657273696f6e206f7574206f6620626f756e647360448201527f2e00000000000000000000000000000000000000000000000000000000000000606482015290519081900360840190fd5b505001602001516c010000000000000000000000009004905600a165627a7a723058209606e1377e9104bcef9c81c3a6c3a91e4ed90af973707c6f976e26b0097c9ea70029",
  "deployedBytecode": "0x73000000000000000000000000000000000000000030146080604052600436106100995763ffffffff7c01000000000000000000000000000000000000000000000000000000006000350416633cab9126811461009e5780633f43b4a0146101005780633f69fc971461014e5780637452ab241461020f578063831567a0146102ad5780638ad522f91461034e578063cac9c974146103c3575b600080fd5b6040805160206004803580820135601f81018490048402850184019095528484526100ec94369492936024939284019190819084018382808284375094975050933594506104239350505050565b604080519115158252519081900360200190f35b6040805160206004803580820135601f81018490048402850184019095528484526100ec94369492936024939284019190819084018382808284375094975050933594506104bc9350505050565b6040805160206004803580820135601f810184900484028501840190955284845261019a94369492936024939284019190819084018382808284375094975061052a9650505050505050565b6040805160208082528351818301528351919283929083019185019080838360005b838110156101d45781810151838201526020016101bc565b50505050905090810190601f1680156102015780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6040805160206004803580820135601f81018490048402850184019095528484526100ec94369492936024939284019190819084018382808284375050604080516020601f89358b018035918201839004830284018301909452808352979a9998810197919650918201945092508291508401838280828437509497505084359550505050602082013560ff169160408101359150606001356107c1565b6040805160206004803580820135601f810184900484028501840190955284845261033c943694929360249392840191908190840183828082843750949750506bffffffffffffffffffffffff1985358116965077ffffffffffffffffffffffffffffffffffffffffffffffff19602087013581169660408101359091169550606001351692506108d6915050565b60408051918252519081900360200190f35b6040805160206004803580820135601f810184900484028501840190955284845261039a943694929360249392840191908190840183828082843750949750610e169650505050505050565b6040805173ffffffffffffffffffffffffffffffffffffffff9092168252519081900360200190f35b6040805160206004803580820135601f81018490048402850184019095528484526100ec9436949293602493928401919081908401838280828437509497505084359550505050602082013560ff16916040810135915060600135610eb3565b600081600019166002846040518082805190602001908083835b6020831061045c5780518252601f19909201916020918201910161043d565b51815160209384036101000a600019018019909216911617905260405191909301945091925050808303816000865af115801561049d573d6000803e3d6000fd5b5050506040513d60208110156104b257600080fd5b5051149392505050565b60008160001916836040518082805190602001908083835b602083106104f35780518252601f1990920191602091820191016104d4565b5181516020939093036101000a60001901801990911692169190911790526040519201829003909120939093149695505050505050565b6060808251604014156105c9578260405160200180807f040000000000000000000000000000000000000000000000000000000000000081525060010182805190602001908083835b602083106105925780518252601f199092019160209182019101610573565b6001836020036101000a03801982511681845116808217855250505050505090500191505060405160208183030381529060405292505b82516041146105d757600080fd5b6040517f48cf5c9400000000000000000000000000000000000000000000000000000000815260206004820181815285516024840152855173__BTCUtils______________________________936348cf5c949388939283926044019185019080838360005b8381101561065557818101518382015260200161063d565b50505050905090810190601f1680156106825780820380516001836020036101000a031916815260200191505b509250505060006040518083038186803b15801561069f57600080fd5b505af41580156106b3573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f1916820160405260208110156106dc57600080fd5b8101908080516401000000008111156106f457600080fd5b8201602081018481111561070757600080fd5b815164010000000081118282018710171561072157600080fd5b505092919050505090508060405160200180807e1400000000000000000000000000000000000000000000000000000000000081525060020182805190602001908083835b602083106107855780518252601f199092019160209182019101610766565b6001836020036101000a038019825116818451168082178552505050505050905001915050604051602081830303815290604052915050919050565b60008060606000896040518082805190602001908083835b602083106107f85780518252601f1990920191602091820191016107d9565b6001836020036101000a0380198251168184511680821785525050505050509050019150506040518091039020600019166108328a61052a565b6040518082805190602001908083835b602083106108615780518252601f199092019160209182019101610842565b5181516000196020949094036101000a8401908116901991909116179052604051939091018390039092208e51951497506108ad948e945060019350909101905063ffffffff610f5116565b91506108bc8289898989610eb3565b90508280156108c85750805b9a9950505050505050505050565b604080517f1976a914000000000000000000000000000000000000000000000000000000006020808301919091526bffffffffffffffffffffffff1980881660248401527f88ac00000000000000000000000000000000000000000000000000000000000060388401528351601a818503018152603a8401855277ffffffffffffffffffffffffffffffffffffffffffffffff198716605a8501527f1600140000000000000000000000000000000000000000000000000000000000606285015290851660658401528351605981850301815260798401948590527f39efb09a00000000000000000000000000000000000000000000000000000000909452607d83018281528451609d85015284516000959294869460609473__BTCUtils______________________________946339efb09a9491939092839260bd90920191908501908083838c5b83811015610a38578181015183820152602001610a20565b50505050905090810190601f168015610a655780820380516001836020036101000a031916815260200191505b509250505060206040518083038186803b158015610a8257600080fd5b505af4158015610a96573d6000803e3d6000fd5b505050506040513d6020811015610aac57600080fd5b50516040517f39efb09a0000000000000000000000000000000000000000000000000000000081526020600482018181528c5160248401528c5193955073__BTCUtils______________________________936339efb09a938e9383926044909201919085019080838360005b83811015610b31578181015183820152602001610b19565b50505050905090810190601f168015610b5e5780820380516001836020036101000a031916815260200191505b509250505060206040518083038186803b158015610b7b57600080fd5b505af4158015610b8f573d6000803e3d6000fd5b505050506040513d6020811015610ba557600080fd5b50516040517f01000000000000000000000000000000000000000000000000000000000000006020828101918252602483018490527f8cb9012517c817fead650287d61bdd9c68803b6bf9c64133dcab3e65b5a50cb960448401528c518d9388938d938993919260640191908701908083835b60208310610c375780518252601f199092019160209182019101610c18565b51815160209384036101000a600019018019909216911617905287519190930192870191508083835b60208310610c7f5780518252601f199092019160209182019101610c60565b51815160209384036101000a600019018019909216911617905277ffffffffffffffffffffffffffffffffffffffffffffffff1996909616920191825250600060088201819052600c820193909352602c81018390527f0100000000000000000000000000000000000000000000000000000000000000603082015260408051808303601401815260348301918290527f39efb09a000000000000000000000000000000000000000000000000000000009091526038820185815281516058840152815191995073__BTCUtils______________________________98506339efb09a9750899650948594607890930193508601918190849084905b83811015610d93578181015183820152602001610d7b565b50505050905090810190601f168015610dc05780820380516001836020036101000a031916815260200191505b509250505060206040518083038186803b158015610ddd57600080fd5b505af4158015610df1573d6000803e3d6000fd5b505050506040513d6020811015610e0757600080fd5b50519998505050505050505050565b6000606082516040141515610e2a57600080fd5b826040518082805190602001908083835b60208310610e5a5780518252601f199092019160209182019101610e3b565b51815160209384036101000a6000190180199092169116179052604080519290940182900382208282015283518083039091018152908301909252508051909350610eac925083915060131901611034565b9392505050565b6000806000610ec188610e16565b60408051600080825260208083018085528c905260ff8b1683850152606083018a905260808301899052925193955060019360a08084019493601f19830193908390039091019190865af1158015610f1d573d6000803e3d6000fd5b5050604051601f19015173ffffffffffffffffffffffffffffffffffffffff90811693169290921498975050505050505050565b606080828401855110151515610fc857604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601360248201527f536c696365206f7574206f6620626f756e647300000000000000000000000000604482015290519081900360640190fd5b82158015610fe15760405191506020820160405261102b565b6040519150601f8416801560200281840101858101878315602002848b0101015b8183101561101a578051835260209283019201611002565b5050858452601f01601f1916604052505b50949350505050565b600080826014018451101515156110d257604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152602160248201527f4164647265737320636f6e76657273696f6e206f7574206f6620626f756e647360448201527f2e00000000000000000000000000000000000000000000000000000000000000606482015290519081900360840190fd5b505001602001516c010000000000000000000000009004905600a165627a7a723058209606e1377e9104bcef9c81c3a6c3a91e4ed90af973707c6f976e26b0097c9ea70029",
  "sourceMap": "182:6317:6:-;;132:2:-1;166:7;155:9;146:7;137:37;252:7;246:14;243:1;238:23;232:4;229:33;270:1;265:20;;;;222:63;;265:20;274:9;222:63;;298:9;295:1;288:20;328:4;319:7;311:22;352:7;343;336:24",
  "deployedSourceMap": "182:6317:6:-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;3799:163;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;3799:163:6;;-1:-1:-1;;3799:163:6;;;-1:-1:-1;3799:163:6;;-1:-1:-1;;;;3799:163:6;;;;;;;;;;;;;;;;;;;4268:169;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;4268:169:6;;-1:-1:-1;;4268:169:6;;;-1:-1:-1;4268:169:6;;-1:-1:-1;;;;4268:169:6;1098:357;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;1098:357:6;;-1:-1:-1;1098:357:6;;-1:-1:-1;;;;;;;1098:357:6;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;8:100:-1;33:3;30:1;27:10;8:100;;;90:11;;;84:18;71:11;;;64:39;52:2;45:10;8:100;;;12:14;1098:357:6;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2897:573;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;;2897:573:6;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;2897:573:6;;;;-1:-1:-1;2897:573:6;-1:-1:-1;2897:573:6;;-1:-1:-1;2897:573:6;;;;;;;;-1:-1:-1;2897:573:6;;-1:-1:-1;;2897:573:6;;;-1:-1:-1;;;;2897:573:6;;;;;;;;;;;;-1:-1:-1;2897:573:6;;;;;5089:1408;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;5089:1408:6;;-1:-1:-1;;;;5089:1408:6;;;;;-1:-1:-1;;;5089:1408:6;;;;;;;;;;;;;;;-1:-1:-1;5089:1408:6;;;;;-1:-1:-1;5089:1408:6;;-1:-1:-1;;5089:1408:6;;;;;;;;;;;;;;;;;525:318;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;525:318:6;;-1:-1:-1;525:318:6;;-1:-1:-1;;;;;;;525:318:6;;;;;;;;;;;;;;;;;;;;1939:315;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;1939:315:6;;-1:-1:-1;;1939:315:6;;;-1:-1:-1;;;;1939:315:6;;;;;;;;;;;;-1:-1:-1;1939:315:6;;;;;3799:163;3903:4;3948:7;3926:29;;;:18;3933:10;3926:18;;;;;;;;;;;;;36:153:-1;66:2;58:11;;36:153;;176:10;;164:23;;-1:-1;;139:12;;;;98:2;89:12;;;;114;36:153;;;299:10;344;;263:2;259:12;;;254:3;250:22;-1:-1;;246:30;311:9;;295:26;;;340:21;;377:20;365:33;;3926:18:6;;;;;;;-1:-1:-1;263:2;;-1:-1;;3926:18:6;;;;-1:-1:-1;3926:18:6;;;;8:9:-1;5:2;;;45:16;42:1;39;24:38;77:16;74:1;67:27;5:2;3926:18:6;;;;;;13:2:-1;8:3;5:11;2:2;;;29:1;26;19:12;2:2;-1:-1;3926:18:6;:29;;3799:163;-1:-1:-1;;;3799:163:6:o;4268:169::-;4375:4;4423:7;4398:32;;;4408:10;4398:21;;;;;;;;;;;;;36:153:-1;66:2;58:11;;36:153;;176:10;;164:23;;-1:-1;;139:12;;;;98:2;89:12;;;;114;36:153;;;299:10;344;;263:2;259:12;;;;254:3;250:22;-1:-1;;246:30;311:9;;295:26;;;340:21;;377:20;;;;365:33;;4398:21:6;;;;;;;;;;:32;;;;;;-1:-1:-1;;;;;;4268:169:6:o;1098:357::-;1160:5;1347:24;1181:7;:14;1199:2;1181:20;1177:95;;;1253:7;1227:34;;;;;;;;;;;;;;;;;;;;;;36:153:-1;66:2;58:11;;36:153;;176:10;;164:23;;-1:-1;;139:12;;;;98:2;89:12;;;;114;36:153;;;274:1;267:3;263:2;259:12;254:3;250:22;246:30;315:4;311:9;305:3;299:10;295:26;356:4;350:3;344:10;340:21;389:7;380;377:20;372:3;365:33;3:399;;;1227:34:6;;;;;;;;;;;49:4:-1;39:7;30;26:21;22:32;13:7;6:49;1227:34:6;;;1217:44;;1177:95;1289:14;;1307:2;1289:20;1281:29;;;;;;1374:17;;;;;;;;;;;;;;;;;;;;:15;;;;:7;;:17;;;;;;;;;;;;;8:100:-1;33:3;30:1;27:10;8:100;;;90:11;;;84:18;71:11;;;64:39;52:2;45:10;8:100;;;12:14;1374:17:6;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;8:9:-1;5:2;;;30:1;27;20:12;5:2;1374:17:6;;;;8:9:-1;5:2;;;45:16;42:1;39;24:38;77:16;74:1;67:27;5:2;1374:17:6;;;;;;39:16:-1;36:1;17:17;2:54;101:4;1374:17:6;80:15:-1;;;-1:-1;;76:31;65:43;;120:4;113:20;13:2;5:11;;2:2;;;29:1;26;19:12;2:2;1374:17:6;;;;;;20:11:-1;15:3;12:20;9:2;;;45:1;42;35:12;9:2;64:21;;126:4;117:14;;142:31;;;139:2;;;186:1;183;176:12;139:2;218:10;;268:11;251:29;;293:43;;;290:58;-1:-1;239:118;236:2;;;370:1;367;360:12;236:2;0:382;;1374:17:6;;;;;;1347:44;;1436:11;1408:40;;;;;;;;;;;;;;;;;;;;;;36:153:-1;66:2;58:11;;36:153;;176:10;;164:23;;-1:-1;;139:12;;;;98:2;89:12;;;;114;36:153;;;274:1;267:3;263:2;259:12;254:3;250:22;246:30;315:4;311:9;305:3;299:10;295:26;356:4;350:3;344:10;340:21;389:7;380;377:20;372:3;365:33;3:399;;;1408:40:6;;;;;;;;;;;49:4:-1;39:7;30;26:21;22:32;13:7;6:49;1408:40:6;;;1401:47;;1098:357;;;;:::o;2897:573::-;3090:4;3106:22;3242:29;3348:15;3181:19;3171:30;;;;;;;;;;;;;36:153:-1;66:2;58:11;;36:153;;176:10;;164:23;;-1:-1;;139:12;;;;98:2;89:12;;;;114;36:153;;;274:1;267:3;263:2;259:12;254:3;250:22;246:30;315:4;311:9;305:3;299:10;295:26;356:4;350:3;344:10;340:21;389:7;380;377:20;372:3;365:33;3:399;;;3171:30:6;;;;;;;;;;;;;;;;3131:70;;;3141:25;3158:7;3141:16;:25::i;:::-;3131:36;;;;;;;;;;;;;36:153:-1;66:2;58:11;;36:153;;176:10;;164:23;;-1:-1;;139:12;;;;98:2;89:12;;;;114;36:153;;;299:10;344;;-1:-1;;263:2;259:12;;;;254:3;250:22;246:30;;340:21;;;311:9;;295:26;;;;377:20;365:33;;3131:36:6;;;;;;;;;;;;3291:14;;3131:70;;;-1:-1:-1;3274:36:6;;3291:7;;-1:-1:-1;274:1;;-1:-1;3291:18:6;;;;-1:-1:-1;3274:36:6;:13;:36;:::i;:::-;3242:68;;3366:47;3375:16;3393:7;3402:2;3406;3410;3366:8;:47::i;:::-;3348:65;;3431:17;:31;;;;;3452:10;3431:31;3423:40;2897:573;-1:-1:-1;;;;;;;;;;2897:573:6:o;5089:1408::-;5528:127;;;;;;;;;;;;-1:-1:-1;;5528:127:6;;;;;;;;;;;;;;22:32:-1;26:21;;;22:32;6:49;;5528:127:6;;;;;-1:-1:-1;;5708:130:6;;;;;;;;;;;;;;;;;;;;22:32:-1;26:21;;;22:32;6:49;;5708:130:6;;;;;;;:140;;;;;;;;;;;;;;;;;;5375:7;;5528:127;;5375:7;;5501:24;;5708:138;;;;:130;;:140;;;;;;;;;;;;;;;;5375:7;8:100:-1;33:3;30:1;27:10;8:100;;;90:11;;;84:18;71:11;;;64:39;52:2;45:10;8:100;;;12:14;5708:140:6;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;8:9:-1;5:2;;;30:1;27;20:12;5:2;5708:140:6;;;;8:9:-1;5:2;;;45:16;42:1;39;24:38;77:16;74:1;67:27;5:2;5708:140:6;;;;;;;13:2:-1;8:3;5:11;2:2;;;29:1;26;19:12;2:2;-1:-1;5708:140:6;5959:19;;;;;5708:140;5959:19;;;;;;;;;;;;;;5708:140;;-1:-1:-1;5959:17:6;;;;:9;;:19;;;;;;;;;;;;;;;8:100:-1;33:3;30:1;27:10;8:100;;;90:11;;;84:18;71:11;;;64:39;52:2;45:10;8:100;;;12:14;5959:19:6;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;8:9:-1;5:2;;;30:1;27;20:12;5:2;5959:19:6;;;;8:9:-1;5:2;;;45:16;42:1;39;24:38;77:16;74:1;67:27;5:2;5959:19:6;;;;;;;13:2:-1;8:3;5:11;2:2;;;29:1;26;19:12;2:2;-1:-1;5959:19:6;5890:557;;;5959:19;5890:557;;;;;;;;;;;;;;;;;;;6119:9;;6155:11;;6203;;6311:12;;5890:557;;;;;;;;;;;;36:153:-1;66:2;58:11;;36:153;;176:10;;164:23;;-1:-1;;139:12;;;;98:2;89:12;;;;114;36:153;;;299:10;344;;263:2;259:12;;;254:3;250:22;-1:-1;;246:30;311:9;;295:26;;;340:21;;377:20;365:33;;5890:557:6;;;;;;;;;;-1:-1:-1;5890:557:6;;;36:153:-1;66:2;58:11;;36:153;;176:10;;164:23;;-1:-1;;139:12;;;;98:2;89:12;;;;114;36:153;;;299:10;344;;263:2;259:12;;;254:3;250:22;-1:-1;;246:30;311:9;;295:26;;;340:21;;377:20;365:33;;-1:-1;;5890:557:6;;;;;;;;;-1:-1:-1;;5890:557:6;;;;;;;;;;;;;;;;;;;;;;;;;;;26:21:-1;;;22:32;;6:49;;5890:557:6;;;;;;;6464:26;;;;;;;;;;;;;;;;;;5890:557;;-1:-1:-1;6464:24:6;;-1:-1:-1;6464:24:6;;-1:-1:-1;5890:557:6;;-1:-1:-1;6464:26:6;;;;;;;;-1:-1:-1;6464:26:6;;;;;;;;;8:100:-1;33:3;30:1;27:10;8:100;;;90:11;;;84:18;71:11;;;64:39;52:2;45:10;8:100;;;12:14;6464:26:6;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;8:9:-1;5:2;;;30:1;27;20:12;5:2;6464:26:6;;;;8:9:-1;5:2;;;45:16;42:1;39;24:38;77:16;74:1;67:27;5:2;6464:26:6;;;;;;;13:2:-1;8:3;5:11;2:2;;;29:1;26;19:12;2:2;-1:-1;6464:26:6;;5089:1408;-1:-1:-1;;;;;;;;;5089:1408:6:o;525:318::-;588:7;704:20;615:7;:14;633:2;615:20;607:29;;;;;;;;754:7;744:18;;;;;;;;;;;;;36:153:-1;66:2;58:11;;36:153;;176:10;;164:23;;-1:-1;;139:12;;;;98:2;89:12;;;;114;36:153;;;299:10;344;;263:2;259:12;;;254:3;250:22;-1:-1;;246:30;311:9;;295:26;;;340:21;;377:20;365:33;;744:18:6;;;;;;;;;;;;727:36;;;;;;26:21:-1;;;22:32;;;6:49;;727:36:6;;;;;;-1:-1:-1;798:14:6;;727:36;;-1:-1:-1;780:38:6;;-1:-1:-1;727:36:6;;-1:-1:-1;;;798:19:6;780:17;:38::i;:::-;773:45;525:318;-1:-1:-1;;;525:318:6:o;1939:315::-;2090:4;2106:17;2162:15;2126:26;2144:7;2126:17;:26::i;:::-;2180:30;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2106:46;;-1:-1:-1;2180:30:6;;;;;;;;-1:-1:-1;;2180:30:6;;;;;;;;;;;;;;;;8:9:-1;5:2;;;45:16;42:1;39;24:38;77:16;74:1;67:27;5:2;-1:-1;;2180:30:6;;-1:-1:-1;;2180:30:6;;2227:20;;;;;;;;;;;1939:315;-1:-1:-1;;;;;;;;1939:315:6:o;10337:2488:3:-;10417:5;10512:22;10469:7;10460:6;:16;10442:6;:13;:35;;10434:67;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;10575:15;;10603:1967;;;;12711:4;12705:11;12692:24;;12762:4;12751:9;12747:20;12741:4;12734:34;10568:2214;;10603:1967;10785:4;10779:11;10766:24;;11444:2;11435:7;11431:16;11826:9;11819:17;11813:4;11809:28;11797:9;11786;11782:25;11778:60;11874:7;11870:2;11866:16;12126:6;12112:9;12105:17;12099:4;12095:28;12083:9;12075:6;12071:22;12067:57;12063:70;11900:425;12159:3;12155:2;12152:11;11900:425;;;12297:9;;12286:21;;12200:4;12192:13;;;;12232;11900:425;;;-1:-1:-1;;12343:26:3;;;12551:2;12534:11;-1:-1:-1;;12530:25:3;12524:4;12517:39;-1:-1:-1;10568:2214:3;-1:-1:-1;12809:9:3;10337:2488;-1:-1:-1;;;;10337:2488:3:o;12831:359::-;12901:7;13006:19;12946:6;12955:2;12946:11;12928:6;:13;:30;;12920:76;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;;13084:30:3;13100:4;13084:30;13078:37;13117:27;13074:71;;;12831:359::o",
  "source": "pragma solidity 0.4.25;\n\n/** @title CheckBitcoinSigs */\n/** @author Summa (https://summa.one) */\n\nimport {BytesLib} from \"./BytesLib.sol\";\nimport {BTCUtils} from \"./BTCUtils.sol\";\n\n\nlibrary CheckBitcoinSigs {\n\n    using BytesLib for bytes;\n    using BTCUtils for bytes;\n\n    /// @notice          derives an Ethereum Account address from a pubkey\n    /// @dev             the address is the last 20 bytes of the keccak256 of the address\n    /// @param _pubkey   the public key\n    /// @return          the account address\n    function accountFromPubkey(bytes _pubkey) public pure returns (address) {\n        require(_pubkey.length == 64);\n\n        // keccak hash of uncompressed unprefixed pubkey\n        bytes memory _digest = abi.encodePacked(keccak256(_pubkey));\n        return _digest.toAddress(_digest.length - 20);  // last 20 bytes\n    }\n\n    /// @notice          calculates the p2wpkh output script of a pubkey\n    /// @dev             pads uncompressed pubkeys to 65 bytes as required by Bitcoin\n    /// @param _pubkey   the public key\n    /// @return          the p2wkph output script\n    function p2wpkhFromPubkey(bytes _pubkey) public pure returns (bytes) {\n        if (_pubkey.length == 64) {\n            _pubkey = abi.encodePacked(hex\"04\", _pubkey);\n        }\n        require(_pubkey.length == 65);  // prefixed uncompressed\n\n        bytes memory _pubkeyHash = _pubkey.hash160();\n        return abi.encodePacked(hex\"0014\", _pubkeyHash);\n    }\n\n    /// @notice          checks a signed message's validity under a pubkey\n    /// @dev             does this using ecrecover because Ethereum has no soul\n    /// @param _pubkey   the public key to check (64 bytes)\n    /// @param _digest   the message digest signed\n    /// @param _v        the signature recovery value\n    /// @param _r        the signature r value\n    /// @param _s        the signature s value\n    /// @return          true if signature is valid, else false\n    function checkSig(\n        bytes _pubkey,\n        bytes32 _digest,\n        uint8 _v,\n        bytes32 _r,\n        bytes32 _s\n    ) public pure returns (bool) {\n        address _expected = accountFromPubkey(_pubkey);\n        address _actual = ecrecover(_digest, _v, _r, _s);\n        return _actual == _expected;\n    }\n\n    /// @notice                     checks a signed message against a bitcoin p2wpkh output script\n    /// @dev                        does this my verifying the p2wpkh matches an ethereum account\n    /// @param _p2wpkhOutputScript  the bitcoin output script\n    /// @param _pubkey              the public key to check\n    /// @param _digest              the message digest signed\n    /// @param _v                   the signature recovery value\n    /// @param _r                   the signature r value\n    /// @param _s                   the signature s value\n    /// @return                     true if signature is valid, else false\n    function checkBitcoinSig(\n        bytes _p2wpkhOutputScript,\n        bytes _pubkey,\n        bytes32 _digest,\n        uint8 _v,\n        bytes32 _r,\n        bytes32 _s\n    ) public pure returns (bool) {\n        bool _isExpectedSigner = keccak256(p2wpkhFromPubkey(_pubkey)) == keccak256(_p2wpkhOutputScript);  // is it the expected signer?\n        bytes memory _truncatedPubkey = _pubkey.slice(1, _pubkey.length - 1);  // slice off the 04 prefix\n        bool _sigResult = checkSig(_truncatedPubkey, _digest, _v, _r, _s);\n        return (_isExpectedSigner && _sigResult);\n    }\n\n    /// @notice             checks if a message is the sha256 preimage of a digest\n    /// @dev                this is NOT the hash256!  this step is necessary for ECDSA security!\n    /// @param _digest      the digest\n    /// @param _candidate   the purported preimage\n    /// @return             the p2wkph output script\n    function isSha256Preimage(\n        bytes _candidate,\n        bytes32 _digest\n    ) public pure returns (bool) {\n        return sha256(_candidate) == _digest;\n    }\n\n    /// @notice             checks if a message is the keccak256 preimage of a digest\n    /// @dev                this step is necessary for ECDSA security!\n    /// @param _digest      the digest\n    /// @param _candidate   the purported preimage\n    /// @return             the p2wkph output script\n    function isKeccak256Preimage(\n        bytes _candidate,\n        bytes32 _digest\n    ) public pure returns (bool) {\n        return keccak256(_candidate) == _digest;\n    }\n\n\n    /// @notice                 calculates the signature hash of a Bitcoin transaction with the provided details\n    /// @dev                    documented in bip143. many values are hardcoded here\n    /// @param _outpoint        the bitcoin output script\n    /// @param _inputPKH        the input pubkeyhash (hash160(sender_pubkey))\n    /// @param _inputValue      the value of the input in satoshi\n    /// @param _outputValue     the value of the output in satoshi\n    /// @param _outputPKH       the output pubkeyhash (hash160(recipient_pubkey))\n    /// @return                 the double-sha256 (hash256) signature hash as defined by bip143\n    function oneInputOneOutputSighash(\n        bytes _outpoint,  // 36 byte UTXO id\n        bytes20 _inputPKH,  // 20 byte hash160\n        bytes8 _inputValue,  // 8-byte LE\n        bytes8 _outputValue,  // 8-byte LE\n        bytes20 _outputPKH  // 20 byte hash160\n    ) public pure returns (bytes32) {\n        // Fixes elements to easily make a 1-in 1-out sighash digest\n        // Does not support timelocks\n        bytes memory _scriptCode = abi.encodePacked(\n            hex\"1976a914\",  // length, dup, hash160, pkh_length\n            _inputPKH,\n            hex\"88ac\");  // equal, checksig\n        bytes32 _hashOutputs = abi.encodePacked(\n            _outputValue,  // 8-byte LE\n            hex\"160014\",  // this assumes p2wpkh\n            _outputPKH).hash256();\n        bytes memory _sighashPreimage = abi.encodePacked(\n            hex\"01000000\",  // version\n            _outpoint.hash256(),  // hashPrevouts\n            hex\"8cb9012517c817fead650287d61bdd9c68803b6bf9c64133dcab3e65b5a50cb9\",  // hashSequence(00000000)\n            _outpoint,  // outpoint\n            _scriptCode,  // p2wpkh script code\n            _inputValue,  // value of the input in 8-byte LE\n            hex\"00000000\",  // input nSequence\n            _hashOutputs,  // hash of the single output\n            hex\"00000000\",  // nLockTime\n            hex\"01000000\"  // SIGHASH_ALL\n        );\n        return _sighashPreimage.hash256();\n    }\n}\n",
  "sourcePath": "/Users/liamz/go/src/github.com/keep-network/tbtc/implementation/contracts/bitcoin-spv/SigCheck.sol",
  "ast": {
    "absolutePath": "/Users/liamz/go/src/github.com/keep-network/tbtc/implementation/contracts/bitcoin-spv/SigCheck.sol",
    "exportedSymbols": {
      "CheckBitcoinSigs": [
        2737
      ]
    },
    "id": 2738,
    "nodeType": "SourceUnit",
    "nodes": [
      {
        "id": 2472,
        "literals": [
          "solidity",
          "0.4",
          ".25"
        ],
        "nodeType": "PragmaDirective",
        "src": "0:23:6"
      },
      {
        "absolutePath": "/Users/liamz/go/src/github.com/keep-network/tbtc/implementation/contracts/bitcoin-spv/BytesLib.sol",
        "file": "./BytesLib.sol",
        "id": 2474,
        "nodeType": "ImportDirective",
        "scope": 2738,
        "sourceUnit": 1775,
        "src": "98:40:6",
        "symbolAliases": [
          {
            "foreign": 2473,
            "local": null
          }
        ],
        "unitAlias": ""
      },
      {
        "absolutePath": "/Users/liamz/go/src/github.com/keep-network/tbtc/implementation/contracts/bitcoin-spv/BTCUtils.sol",
        "file": "./BTCUtils.sol",
        "id": 2476,
        "nodeType": "ImportDirective",
        "scope": 2738,
        "sourceUnit": 1607,
        "src": "139:40:6",
        "symbolAliases": [
          {
            "foreign": 2475,
            "local": null
          }
        ],
        "unitAlias": ""
      },
      {
        "baseContracts": [],
        "contractDependencies": [],
        "contractKind": "library",
        "documentation": null,
        "fullyImplemented": true,
        "id": 2737,
        "linearizedBaseContracts": [
          2737
        ],
        "name": "CheckBitcoinSigs",
        "nodeType": "ContractDefinition",
        "nodes": [
          {
            "id": 2479,
            "libraryName": {
              "contractScope": null,
              "id": 2477,
              "name": "BytesLib",
              "nodeType": "UserDefinedTypeName",
              "referencedDeclaration": 1774,
              "src": "220:8:6",
              "typeDescriptions": {
                "typeIdentifier": "t_contract$_BytesLib_$1774",
                "typeString": "library BytesLib"
              }
            },
            "nodeType": "UsingForDirective",
            "src": "214:25:6",
            "typeName": {
              "id": 2478,
              "name": "bytes",
              "nodeType": "ElementaryTypeName",
              "src": "233:5:6",
              "typeDescriptions": {
                "typeIdentifier": "t_bytes_storage_ptr",
                "typeString": "bytes"
              }
            }
          },
          {
            "id": 2482,
            "libraryName": {
              "contractScope": null,
              "id": 2480,
              "name": "BTCUtils",
              "nodeType": "UserDefinedTypeName",
              "referencedDeclaration": 1606,
              "src": "250:8:6",
              "typeDescriptions": {
                "typeIdentifier": "t_contract$_BTCUtils_$1606",
                "typeString": "library BTCUtils"
              }
            },
            "nodeType": "UsingForDirective",
            "src": "244:25:6",
            "typeName": {
              "id": 2481,
              "name": "bytes",
              "nodeType": "ElementaryTypeName",
              "src": "263:5:6",
              "typeDescriptions": {
                "typeIdentifier": "t_bytes_storage_ptr",
                "typeString": "bytes"
              }
            }
          },
          {
            "body": {
              "id": 2513,
              "nodeType": "Block",
              "src": "597:246:6",
              "statements": [
                {
                  "expression": {
                    "argumentTypes": null,
                    "arguments": [
                      {
                        "argumentTypes": null,
                        "commonType": {
                          "typeIdentifier": "t_uint256",
                          "typeString": "uint256"
                        },
                        "id": 2493,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": false,
                        "lValueRequested": false,
                        "leftExpression": {
                          "argumentTypes": null,
                          "expression": {
                            "argumentTypes": null,
                            "id": 2490,
                            "name": "_pubkey",
                            "nodeType": "Identifier",
                            "overloadedDeclarations": [],
                            "referencedDeclaration": 2484,
                            "src": "615:7:6",
                            "typeDescriptions": {
                              "typeIdentifier": "t_bytes_memory_ptr",
                              "typeString": "bytes memory"
                            }
                          },
                          "id": 2491,
                          "isConstant": false,
                          "isLValue": false,
                          "isPure": false,
                          "lValueRequested": false,
                          "memberName": "length",
                          "nodeType": "MemberAccess",
                          "referencedDeclaration": null,
                          "src": "615:14:6",
                          "typeDescriptions": {
                            "typeIdentifier": "t_uint256",
                            "typeString": "uint256"
                          }
                        },
                        "nodeType": "BinaryOperation",
                        "operator": "==",
                        "rightExpression": {
                          "argumentTypes": null,
                          "hexValue": "3634",
                          "id": 2492,
                          "isConstant": false,
                          "isLValue": false,
                          "isPure": true,
                          "kind": "number",
                          "lValueRequested": false,
                          "nodeType": "Literal",
                          "src": "633:2:6",
                          "subdenomination": null,
                          "typeDescriptions": {
                            "typeIdentifier": "t_rational_64_by_1",
                            "typeString": "int_const 64"
                          },
                          "value": "64"
                        },
                        "src": "615:20:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bool",
                          "typeString": "bool"
                        }
                      }
                    ],
                    "expression": {
                      "argumentTypes": [
                        {
                          "typeIdentifier": "t_bool",
                          "typeString": "bool"
                        }
                      ],
                      "id": 2489,
                      "name": "require",
                      "nodeType": "Identifier",
                      "overloadedDeclarations": [
                        10519,
                        10520
                      ],
                      "referencedDeclaration": 10519,
                      "src": "607:7:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_function_require_pure$_t_bool_$returns$__$",
                        "typeString": "function (bool) pure"
                      }
                    },
                    "id": 2494,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "kind": "functionCall",
                    "lValueRequested": false,
                    "names": [],
                    "nodeType": "FunctionCall",
                    "src": "607:29:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_tuple$__$",
                      "typeString": "tuple()"
                    }
                  },
                  "id": 2495,
                  "nodeType": "ExpressionStatement",
                  "src": "607:29:6"
                },
                {
                  "assignments": [
                    2497
                  ],
                  "declarations": [
                    {
                      "constant": false,
                      "id": 2497,
                      "name": "_digest",
                      "nodeType": "VariableDeclaration",
                      "scope": 2514,
                      "src": "704:20:6",
                      "stateVariable": false,
                      "storageLocation": "memory",
                      "typeDescriptions": {
                        "typeIdentifier": "t_bytes_memory_ptr",
                        "typeString": "bytes"
                      },
                      "typeName": {
                        "id": 2496,
                        "name": "bytes",
                        "nodeType": "ElementaryTypeName",
                        "src": "704:5:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_storage_ptr",
                          "typeString": "bytes"
                        }
                      },
                      "value": null,
                      "visibility": "internal"
                    }
                  ],
                  "id": 2504,
                  "initialValue": {
                    "argumentTypes": null,
                    "arguments": [
                      {
                        "argumentTypes": null,
                        "arguments": [
                          {
                            "argumentTypes": null,
                            "id": 2501,
                            "name": "_pubkey",
                            "nodeType": "Identifier",
                            "overloadedDeclarations": [],
                            "referencedDeclaration": 2484,
                            "src": "754:7:6",
                            "typeDescriptions": {
                              "typeIdentifier": "t_bytes_memory_ptr",
                              "typeString": "bytes memory"
                            }
                          }
                        ],
                        "expression": {
                          "argumentTypes": [
                            {
                              "typeIdentifier": "t_bytes_memory_ptr",
                              "typeString": "bytes memory"
                            }
                          ],
                          "id": 2500,
                          "name": "keccak256",
                          "nodeType": "Identifier",
                          "overloadedDeclarations": [],
                          "referencedDeclaration": 10510,
                          "src": "744:9:6",
                          "typeDescriptions": {
                            "typeIdentifier": "t_function_sha3_pure$__$returns$_t_bytes32_$",
                            "typeString": "function () pure returns (bytes32)"
                          }
                        },
                        "id": 2502,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": false,
                        "kind": "functionCall",
                        "lValueRequested": false,
                        "names": [],
                        "nodeType": "FunctionCall",
                        "src": "744:18:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        }
                      }
                    ],
                    "expression": {
                      "argumentTypes": [
                        {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        }
                      ],
                      "expression": {
                        "argumentTypes": null,
                        "id": 2498,
                        "name": "abi",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 10503,
                        "src": "727:3:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_magic_abi",
                          "typeString": "abi"
                        }
                      },
                      "id": 2499,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": true,
                      "lValueRequested": false,
                      "memberName": "encodePacked",
                      "nodeType": "MemberAccess",
                      "referencedDeclaration": null,
                      "src": "727:16:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_function_abiencodepacked_pure$__$returns$_t_bytes_memory_ptr_$",
                        "typeString": "function () pure returns (bytes memory)"
                      }
                    },
                    "id": 2503,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "kind": "functionCall",
                    "lValueRequested": false,
                    "names": [],
                    "nodeType": "FunctionCall",
                    "src": "727:36:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_memory_ptr",
                      "typeString": "bytes memory"
                    }
                  },
                  "nodeType": "VariableDeclarationStatement",
                  "src": "704:59:6"
                },
                {
                  "expression": {
                    "argumentTypes": null,
                    "arguments": [
                      {
                        "argumentTypes": null,
                        "commonType": {
                          "typeIdentifier": "t_uint256",
                          "typeString": "uint256"
                        },
                        "id": 2510,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": false,
                        "lValueRequested": false,
                        "leftExpression": {
                          "argumentTypes": null,
                          "expression": {
                            "argumentTypes": null,
                            "id": 2507,
                            "name": "_digest",
                            "nodeType": "Identifier",
                            "overloadedDeclarations": [],
                            "referencedDeclaration": 2497,
                            "src": "798:7:6",
                            "typeDescriptions": {
                              "typeIdentifier": "t_bytes_memory_ptr",
                              "typeString": "bytes memory"
                            }
                          },
                          "id": 2508,
                          "isConstant": false,
                          "isLValue": false,
                          "isPure": false,
                          "lValueRequested": false,
                          "memberName": "length",
                          "nodeType": "MemberAccess",
                          "referencedDeclaration": null,
                          "src": "798:14:6",
                          "typeDescriptions": {
                            "typeIdentifier": "t_uint256",
                            "typeString": "uint256"
                          }
                        },
                        "nodeType": "BinaryOperation",
                        "operator": "-",
                        "rightExpression": {
                          "argumentTypes": null,
                          "hexValue": "3230",
                          "id": 2509,
                          "isConstant": false,
                          "isLValue": false,
                          "isPure": true,
                          "kind": "number",
                          "lValueRequested": false,
                          "nodeType": "Literal",
                          "src": "815:2:6",
                          "subdenomination": null,
                          "typeDescriptions": {
                            "typeIdentifier": "t_rational_20_by_1",
                            "typeString": "int_const 20"
                          },
                          "value": "20"
                        },
                        "src": "798:19:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_uint256",
                          "typeString": "uint256"
                        }
                      }
                    ],
                    "expression": {
                      "argumentTypes": [
                        {
                          "typeIdentifier": "t_uint256",
                          "typeString": "uint256"
                        }
                      ],
                      "expression": {
                        "argumentTypes": null,
                        "id": 2505,
                        "name": "_digest",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2497,
                        "src": "780:7:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        }
                      },
                      "id": 2506,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": false,
                      "lValueRequested": false,
                      "memberName": "toAddress",
                      "nodeType": "MemberAccess",
                      "referencedDeclaration": 1689,
                      "src": "780:17:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_function_internal_pure$_t_bytes_memory_ptr_$_t_uint256_$returns$_t_address_$bound_to$_t_bytes_memory_ptr_$",
                        "typeString": "function (bytes memory,uint256) pure returns (address)"
                      }
                    },
                    "id": 2511,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "kind": "functionCall",
                    "lValueRequested": false,
                    "names": [],
                    "nodeType": "FunctionCall",
                    "src": "780:38:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_address",
                      "typeString": "address"
                    }
                  },
                  "functionReturnParameters": 2488,
                  "id": 2512,
                  "nodeType": "Return",
                  "src": "773:45:6"
                }
              ]
            },
            "documentation": "@notice          derives an Ethereum Account address from a pubkey\n @dev             the address is the last 20 bytes of the keccak256 of the address\n @param _pubkey   the public key\n @return          the account address",
            "id": 2514,
            "implemented": true,
            "isConstructor": false,
            "isDeclaredConst": true,
            "modifiers": [],
            "name": "accountFromPubkey",
            "nodeType": "FunctionDefinition",
            "parameters": {
              "id": 2485,
              "nodeType": "ParameterList",
              "parameters": [
                {
                  "constant": false,
                  "id": 2484,
                  "name": "_pubkey",
                  "nodeType": "VariableDeclaration",
                  "scope": 2514,
                  "src": "552:13:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes_memory_ptr",
                    "typeString": "bytes"
                  },
                  "typeName": {
                    "id": 2483,
                    "name": "bytes",
                    "nodeType": "ElementaryTypeName",
                    "src": "552:5:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_storage_ptr",
                      "typeString": "bytes"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                }
              ],
              "src": "551:15:6"
            },
            "payable": false,
            "returnParameters": {
              "id": 2488,
              "nodeType": "ParameterList",
              "parameters": [
                {
                  "constant": false,
                  "id": 2487,
                  "name": "",
                  "nodeType": "VariableDeclaration",
                  "scope": 2514,
                  "src": "588:7:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_address",
                    "typeString": "address"
                  },
                  "typeName": {
                    "id": 2486,
                    "name": "address",
                    "nodeType": "ElementaryTypeName",
                    "src": "588:7:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_address",
                      "typeString": "address"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                }
              ],
              "src": "587:9:6"
            },
            "scope": 2737,
            "src": "525:318:6",
            "stateMutability": "pure",
            "superFunction": null,
            "visibility": "public"
          },
          {
            "body": {
              "id": 2554,
              "nodeType": "Block",
              "src": "1167:288:6",
              "statements": [
                {
                  "condition": {
                    "argumentTypes": null,
                    "commonType": {
                      "typeIdentifier": "t_uint256",
                      "typeString": "uint256"
                    },
                    "id": 2524,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "lValueRequested": false,
                    "leftExpression": {
                      "argumentTypes": null,
                      "expression": {
                        "argumentTypes": null,
                        "id": 2521,
                        "name": "_pubkey",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2516,
                        "src": "1181:7:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        }
                      },
                      "id": 2522,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": false,
                      "lValueRequested": false,
                      "memberName": "length",
                      "nodeType": "MemberAccess",
                      "referencedDeclaration": null,
                      "src": "1181:14:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_uint256",
                        "typeString": "uint256"
                      }
                    },
                    "nodeType": "BinaryOperation",
                    "operator": "==",
                    "rightExpression": {
                      "argumentTypes": null,
                      "hexValue": "3634",
                      "id": 2523,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": true,
                      "kind": "number",
                      "lValueRequested": false,
                      "nodeType": "Literal",
                      "src": "1199:2:6",
                      "subdenomination": null,
                      "typeDescriptions": {
                        "typeIdentifier": "t_rational_64_by_1",
                        "typeString": "int_const 64"
                      },
                      "value": "64"
                    },
                    "src": "1181:20:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bool",
                      "typeString": "bool"
                    }
                  },
                  "falseBody": null,
                  "id": 2534,
                  "nodeType": "IfStatement",
                  "src": "1177:95:6",
                  "trueBody": {
                    "id": 2533,
                    "nodeType": "Block",
                    "src": "1203:69:6",
                    "statements": [
                      {
                        "expression": {
                          "argumentTypes": null,
                          "id": 2531,
                          "isConstant": false,
                          "isLValue": false,
                          "isPure": false,
                          "lValueRequested": false,
                          "leftHandSide": {
                            "argumentTypes": null,
                            "id": 2525,
                            "name": "_pubkey",
                            "nodeType": "Identifier",
                            "overloadedDeclarations": [],
                            "referencedDeclaration": 2516,
                            "src": "1217:7:6",
                            "typeDescriptions": {
                              "typeIdentifier": "t_bytes_memory_ptr",
                              "typeString": "bytes memory"
                            }
                          },
                          "nodeType": "Assignment",
                          "operator": "=",
                          "rightHandSide": {
                            "argumentTypes": null,
                            "arguments": [
                              {
                                "argumentTypes": null,
                                "hexValue": "04",
                                "id": 2528,
                                "isConstant": false,
                                "isLValue": false,
                                "isPure": true,
                                "kind": "string",
                                "lValueRequested": false,
                                "nodeType": "Literal",
                                "src": "1244:7:6",
                                "subdenomination": null,
                                "typeDescriptions": {
                                  "typeIdentifier": "t_stringliteral_f343681465b9efe82c933c3e8748c70cb8aa06539c361de20f72eac04e766393",
                                  "typeString": "literal_string \"\u0004\""
                                },
                                "value": "\u0004"
                              },
                              {
                                "argumentTypes": null,
                                "id": 2529,
                                "name": "_pubkey",
                                "nodeType": "Identifier",
                                "overloadedDeclarations": [],
                                "referencedDeclaration": 2516,
                                "src": "1253:7:6",
                                "typeDescriptions": {
                                  "typeIdentifier": "t_bytes_memory_ptr",
                                  "typeString": "bytes memory"
                                }
                              }
                            ],
                            "expression": {
                              "argumentTypes": [
                                {
                                  "typeIdentifier": "t_stringliteral_f343681465b9efe82c933c3e8748c70cb8aa06539c361de20f72eac04e766393",
                                  "typeString": "literal_string \"\u0004\""
                                },
                                {
                                  "typeIdentifier": "t_bytes_memory_ptr",
                                  "typeString": "bytes memory"
                                }
                              ],
                              "expression": {
                                "argumentTypes": null,
                                "id": 2526,
                                "name": "abi",
                                "nodeType": "Identifier",
                                "overloadedDeclarations": [],
                                "referencedDeclaration": 10503,
                                "src": "1227:3:6",
                                "typeDescriptions": {
                                  "typeIdentifier": "t_magic_abi",
                                  "typeString": "abi"
                                }
                              },
                              "id": 2527,
                              "isConstant": false,
                              "isLValue": false,
                              "isPure": true,
                              "lValueRequested": false,
                              "memberName": "encodePacked",
                              "nodeType": "MemberAccess",
                              "referencedDeclaration": null,
                              "src": "1227:16:6",
                              "typeDescriptions": {
                                "typeIdentifier": "t_function_abiencodepacked_pure$__$returns$_t_bytes_memory_ptr_$",
                                "typeString": "function () pure returns (bytes memory)"
                              }
                            },
                            "id": 2530,
                            "isConstant": false,
                            "isLValue": false,
                            "isPure": false,
                            "kind": "functionCall",
                            "lValueRequested": false,
                            "names": [],
                            "nodeType": "FunctionCall",
                            "src": "1227:34:6",
                            "typeDescriptions": {
                              "typeIdentifier": "t_bytes_memory_ptr",
                              "typeString": "bytes memory"
                            }
                          },
                          "src": "1217:44:6",
                          "typeDescriptions": {
                            "typeIdentifier": "t_bytes_memory_ptr",
                            "typeString": "bytes memory"
                          }
                        },
                        "id": 2532,
                        "nodeType": "ExpressionStatement",
                        "src": "1217:44:6"
                      }
                    ]
                  }
                },
                {
                  "expression": {
                    "argumentTypes": null,
                    "arguments": [
                      {
                        "argumentTypes": null,
                        "commonType": {
                          "typeIdentifier": "t_uint256",
                          "typeString": "uint256"
                        },
                        "id": 2539,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": false,
                        "lValueRequested": false,
                        "leftExpression": {
                          "argumentTypes": null,
                          "expression": {
                            "argumentTypes": null,
                            "id": 2536,
                            "name": "_pubkey",
                            "nodeType": "Identifier",
                            "overloadedDeclarations": [],
                            "referencedDeclaration": 2516,
                            "src": "1289:7:6",
                            "typeDescriptions": {
                              "typeIdentifier": "t_bytes_memory_ptr",
                              "typeString": "bytes memory"
                            }
                          },
                          "id": 2537,
                          "isConstant": false,
                          "isLValue": false,
                          "isPure": false,
                          "lValueRequested": false,
                          "memberName": "length",
                          "nodeType": "MemberAccess",
                          "referencedDeclaration": null,
                          "src": "1289:14:6",
                          "typeDescriptions": {
                            "typeIdentifier": "t_uint256",
                            "typeString": "uint256"
                          }
                        },
                        "nodeType": "BinaryOperation",
                        "operator": "==",
                        "rightExpression": {
                          "argumentTypes": null,
                          "hexValue": "3635",
                          "id": 2538,
                          "isConstant": false,
                          "isLValue": false,
                          "isPure": true,
                          "kind": "number",
                          "lValueRequested": false,
                          "nodeType": "Literal",
                          "src": "1307:2:6",
                          "subdenomination": null,
                          "typeDescriptions": {
                            "typeIdentifier": "t_rational_65_by_1",
                            "typeString": "int_const 65"
                          },
                          "value": "65"
                        },
                        "src": "1289:20:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bool",
                          "typeString": "bool"
                        }
                      }
                    ],
                    "expression": {
                      "argumentTypes": [
                        {
                          "typeIdentifier": "t_bool",
                          "typeString": "bool"
                        }
                      ],
                      "id": 2535,
                      "name": "require",
                      "nodeType": "Identifier",
                      "overloadedDeclarations": [
                        10519,
                        10520
                      ],
                      "referencedDeclaration": 10519,
                      "src": "1281:7:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_function_require_pure$_t_bool_$returns$__$",
                        "typeString": "function (bool) pure"
                      }
                    },
                    "id": 2540,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "kind": "functionCall",
                    "lValueRequested": false,
                    "names": [],
                    "nodeType": "FunctionCall",
                    "src": "1281:29:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_tuple$__$",
                      "typeString": "tuple()"
                    }
                  },
                  "id": 2541,
                  "nodeType": "ExpressionStatement",
                  "src": "1281:29:6"
                },
                {
                  "assignments": [
                    2543
                  ],
                  "declarations": [
                    {
                      "constant": false,
                      "id": 2543,
                      "name": "_pubkeyHash",
                      "nodeType": "VariableDeclaration",
                      "scope": 2555,
                      "src": "1347:24:6",
                      "stateVariable": false,
                      "storageLocation": "memory",
                      "typeDescriptions": {
                        "typeIdentifier": "t_bytes_memory_ptr",
                        "typeString": "bytes"
                      },
                      "typeName": {
                        "id": 2542,
                        "name": "bytes",
                        "nodeType": "ElementaryTypeName",
                        "src": "1347:5:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_storage_ptr",
                          "typeString": "bytes"
                        }
                      },
                      "value": null,
                      "visibility": "internal"
                    }
                  ],
                  "id": 2547,
                  "initialValue": {
                    "argumentTypes": null,
                    "arguments": [],
                    "expression": {
                      "argumentTypes": [],
                      "expression": {
                        "argumentTypes": null,
                        "id": 2544,
                        "name": "_pubkey",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2516,
                        "src": "1374:7:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        }
                      },
                      "id": 2545,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": false,
                      "lValueRequested": false,
                      "memberName": "hash160",
                      "nodeType": "MemberAccess",
                      "referencedDeclaration": 657,
                      "src": "1374:15:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_function_delegatecall_pure$_t_bytes_memory_ptr_$returns$_t_bytes_memory_ptr_$bound_to$_t_bytes_memory_ptr_$",
                        "typeString": "function (bytes memory) pure returns (bytes memory)"
                      }
                    },
                    "id": 2546,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "kind": "functionCall",
                    "lValueRequested": false,
                    "names": [],
                    "nodeType": "FunctionCall",
                    "src": "1374:17:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_memory_ptr",
                      "typeString": "bytes memory"
                    }
                  },
                  "nodeType": "VariableDeclarationStatement",
                  "src": "1347:44:6"
                },
                {
                  "expression": {
                    "argumentTypes": null,
                    "arguments": [
                      {
                        "argumentTypes": null,
                        "hexValue": "0014",
                        "id": 2550,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": true,
                        "kind": "string",
                        "lValueRequested": false,
                        "nodeType": "Literal",
                        "src": "1425:9:6",
                        "subdenomination": null,
                        "typeDescriptions": {
                          "typeIdentifier": "t_stringliteral_8c9fd6988effdf130d07ed4911a231819d049b576b0676ca29490d955c0caa21",
                          "typeString": "literal_string \"\u0000\u0014\""
                        },
                        "value": "\u0000\u0014"
                      },
                      {
                        "argumentTypes": null,
                        "id": 2551,
                        "name": "_pubkeyHash",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2543,
                        "src": "1436:11:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        }
                      }
                    ],
                    "expression": {
                      "argumentTypes": [
                        {
                          "typeIdentifier": "t_stringliteral_8c9fd6988effdf130d07ed4911a231819d049b576b0676ca29490d955c0caa21",
                          "typeString": "literal_string \"\u0000\u0014\""
                        },
                        {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        }
                      ],
                      "expression": {
                        "argumentTypes": null,
                        "id": 2548,
                        "name": "abi",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 10503,
                        "src": "1408:3:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_magic_abi",
                          "typeString": "abi"
                        }
                      },
                      "id": 2549,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": true,
                      "lValueRequested": false,
                      "memberName": "encodePacked",
                      "nodeType": "MemberAccess",
                      "referencedDeclaration": null,
                      "src": "1408:16:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_function_abiencodepacked_pure$__$returns$_t_bytes_memory_ptr_$",
                        "typeString": "function () pure returns (bytes memory)"
                      }
                    },
                    "id": 2552,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "kind": "functionCall",
                    "lValueRequested": false,
                    "names": [],
                    "nodeType": "FunctionCall",
                    "src": "1408:40:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_memory_ptr",
                      "typeString": "bytes memory"
                    }
                  },
                  "functionReturnParameters": 2520,
                  "id": 2553,
                  "nodeType": "Return",
                  "src": "1401:47:6"
                }
              ]
            },
            "documentation": "@notice          calculates the p2wpkh output script of a pubkey\n @dev             pads uncompressed pubkeys to 65 bytes as required by Bitcoin\n @param _pubkey   the public key\n @return          the p2wkph output script",
            "id": 2555,
            "implemented": true,
            "isConstructor": false,
            "isDeclaredConst": true,
            "modifiers": [],
            "name": "p2wpkhFromPubkey",
            "nodeType": "FunctionDefinition",
            "parameters": {
              "id": 2517,
              "nodeType": "ParameterList",
              "parameters": [
                {
                  "constant": false,
                  "id": 2516,
                  "name": "_pubkey",
                  "nodeType": "VariableDeclaration",
                  "scope": 2555,
                  "src": "1124:13:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes_memory_ptr",
                    "typeString": "bytes"
                  },
                  "typeName": {
                    "id": 2515,
                    "name": "bytes",
                    "nodeType": "ElementaryTypeName",
                    "src": "1124:5:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_storage_ptr",
                      "typeString": "bytes"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                }
              ],
              "src": "1123:15:6"
            },
            "payable": false,
            "returnParameters": {
              "id": 2520,
              "nodeType": "ParameterList",
              "parameters": [
                {
                  "constant": false,
                  "id": 2519,
                  "name": "",
                  "nodeType": "VariableDeclaration",
                  "scope": 2555,
                  "src": "1160:5:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes_memory_ptr",
                    "typeString": "bytes"
                  },
                  "typeName": {
                    "id": 2518,
                    "name": "bytes",
                    "nodeType": "ElementaryTypeName",
                    "src": "1160:5:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_storage_ptr",
                      "typeString": "bytes"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                }
              ],
              "src": "1159:7:6"
            },
            "scope": 2737,
            "src": "1098:357:6",
            "stateMutability": "pure",
            "superFunction": null,
            "visibility": "public"
          },
          {
            "body": {
              "id": 2589,
              "nodeType": "Block",
              "src": "2096:158:6",
              "statements": [
                {
                  "assignments": [
                    2571
                  ],
                  "declarations": [
                    {
                      "constant": false,
                      "id": 2571,
                      "name": "_expected",
                      "nodeType": "VariableDeclaration",
                      "scope": 2590,
                      "src": "2106:17:6",
                      "stateVariable": false,
                      "storageLocation": "default",
                      "typeDescriptions": {
                        "typeIdentifier": "t_address",
                        "typeString": "address"
                      },
                      "typeName": {
                        "id": 2570,
                        "name": "address",
                        "nodeType": "ElementaryTypeName",
                        "src": "2106:7:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_address",
                          "typeString": "address"
                        }
                      },
                      "value": null,
                      "visibility": "internal"
                    }
                  ],
                  "id": 2575,
                  "initialValue": {
                    "argumentTypes": null,
                    "arguments": [
                      {
                        "argumentTypes": null,
                        "id": 2573,
                        "name": "_pubkey",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2557,
                        "src": "2144:7:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        }
                      }
                    ],
                    "expression": {
                      "argumentTypes": [
                        {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        }
                      ],
                      "id": 2572,
                      "name": "accountFromPubkey",
                      "nodeType": "Identifier",
                      "overloadedDeclarations": [],
                      "referencedDeclaration": 2514,
                      "src": "2126:17:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_function_internal_pure$_t_bytes_memory_ptr_$returns$_t_address_$",
                        "typeString": "function (bytes memory) pure returns (address)"
                      }
                    },
                    "id": 2574,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "kind": "functionCall",
                    "lValueRequested": false,
                    "names": [],
                    "nodeType": "FunctionCall",
                    "src": "2126:26:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_address",
                      "typeString": "address"
                    }
                  },
                  "nodeType": "VariableDeclarationStatement",
                  "src": "2106:46:6"
                },
                {
                  "assignments": [
                    2577
                  ],
                  "declarations": [
                    {
                      "constant": false,
                      "id": 2577,
                      "name": "_actual",
                      "nodeType": "VariableDeclaration",
                      "scope": 2590,
                      "src": "2162:15:6",
                      "stateVariable": false,
                      "storageLocation": "default",
                      "typeDescriptions": {
                        "typeIdentifier": "t_address",
                        "typeString": "address"
                      },
                      "typeName": {
                        "id": 2576,
                        "name": "address",
                        "nodeType": "ElementaryTypeName",
                        "src": "2162:7:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_address",
                          "typeString": "address"
                        }
                      },
                      "value": null,
                      "visibility": "internal"
                    }
                  ],
                  "id": 2584,
                  "initialValue": {
                    "argumentTypes": null,
                    "arguments": [
                      {
                        "argumentTypes": null,
                        "id": 2579,
                        "name": "_digest",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2559,
                        "src": "2190:7:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        }
                      },
                      {
                        "argumentTypes": null,
                        "id": 2580,
                        "name": "_v",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2561,
                        "src": "2199:2:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_uint8",
                          "typeString": "uint8"
                        }
                      },
                      {
                        "argumentTypes": null,
                        "id": 2581,
                        "name": "_r",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2563,
                        "src": "2203:2:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        }
                      },
                      {
                        "argumentTypes": null,
                        "id": 2582,
                        "name": "_s",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2565,
                        "src": "2207:2:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        }
                      }
                    ],
                    "expression": {
                      "argumentTypes": [
                        {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        },
                        {
                          "typeIdentifier": "t_uint8",
                          "typeString": "uint8"
                        },
                        {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        },
                        {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        }
                      ],
                      "id": 2578,
                      "name": "ecrecover",
                      "nodeType": "Identifier",
                      "overloadedDeclarations": [],
                      "referencedDeclaration": 10508,
                      "src": "2180:9:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_function_ecrecover_pure$_t_bytes32_$_t_uint8_$_t_bytes32_$_t_bytes32_$returns$_t_address_$",
                        "typeString": "function (bytes32,uint8,bytes32,bytes32) pure returns (address)"
                      }
                    },
                    "id": 2583,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "kind": "functionCall",
                    "lValueRequested": false,
                    "names": [],
                    "nodeType": "FunctionCall",
                    "src": "2180:30:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_address",
                      "typeString": "address"
                    }
                  },
                  "nodeType": "VariableDeclarationStatement",
                  "src": "2162:48:6"
                },
                {
                  "expression": {
                    "argumentTypes": null,
                    "commonType": {
                      "typeIdentifier": "t_address",
                      "typeString": "address"
                    },
                    "id": 2587,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "lValueRequested": false,
                    "leftExpression": {
                      "argumentTypes": null,
                      "id": 2585,
                      "name": "_actual",
                      "nodeType": "Identifier",
                      "overloadedDeclarations": [],
                      "referencedDeclaration": 2577,
                      "src": "2227:7:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_address",
                        "typeString": "address"
                      }
                    },
                    "nodeType": "BinaryOperation",
                    "operator": "==",
                    "rightExpression": {
                      "argumentTypes": null,
                      "id": 2586,
                      "name": "_expected",
                      "nodeType": "Identifier",
                      "overloadedDeclarations": [],
                      "referencedDeclaration": 2571,
                      "src": "2238:9:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_address",
                        "typeString": "address"
                      }
                    },
                    "src": "2227:20:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bool",
                      "typeString": "bool"
                    }
                  },
                  "functionReturnParameters": 2569,
                  "id": 2588,
                  "nodeType": "Return",
                  "src": "2220:27:6"
                }
              ]
            },
            "documentation": "@notice          checks a signed message's validity under a pubkey\n @dev             does this using ecrecover because Ethereum has no soul\n @param _pubkey   the public key to check (64 bytes)\n @param _digest   the message digest signed\n @param _v        the signature recovery value\n @param _r        the signature r value\n @param _s        the signature s value\n @return          true if signature is valid, else false",
            "id": 2590,
            "implemented": true,
            "isConstructor": false,
            "isDeclaredConst": true,
            "modifiers": [],
            "name": "checkSig",
            "nodeType": "FunctionDefinition",
            "parameters": {
              "id": 2566,
              "nodeType": "ParameterList",
              "parameters": [
                {
                  "constant": false,
                  "id": 2557,
                  "name": "_pubkey",
                  "nodeType": "VariableDeclaration",
                  "scope": 2590,
                  "src": "1966:13:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes_memory_ptr",
                    "typeString": "bytes"
                  },
                  "typeName": {
                    "id": 2556,
                    "name": "bytes",
                    "nodeType": "ElementaryTypeName",
                    "src": "1966:5:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_storage_ptr",
                      "typeString": "bytes"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2559,
                  "name": "_digest",
                  "nodeType": "VariableDeclaration",
                  "scope": 2590,
                  "src": "1989:15:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes32",
                    "typeString": "bytes32"
                  },
                  "typeName": {
                    "id": 2558,
                    "name": "bytes32",
                    "nodeType": "ElementaryTypeName",
                    "src": "1989:7:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes32",
                      "typeString": "bytes32"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2561,
                  "name": "_v",
                  "nodeType": "VariableDeclaration",
                  "scope": 2590,
                  "src": "2014:8:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_uint8",
                    "typeString": "uint8"
                  },
                  "typeName": {
                    "id": 2560,
                    "name": "uint8",
                    "nodeType": "ElementaryTypeName",
                    "src": "2014:5:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_uint8",
                      "typeString": "uint8"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2563,
                  "name": "_r",
                  "nodeType": "VariableDeclaration",
                  "scope": 2590,
                  "src": "2032:10:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes32",
                    "typeString": "bytes32"
                  },
                  "typeName": {
                    "id": 2562,
                    "name": "bytes32",
                    "nodeType": "ElementaryTypeName",
                    "src": "2032:7:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes32",
                      "typeString": "bytes32"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2565,
                  "name": "_s",
                  "nodeType": "VariableDeclaration",
                  "scope": 2590,
                  "src": "2052:10:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes32",
                    "typeString": "bytes32"
                  },
                  "typeName": {
                    "id": 2564,
                    "name": "bytes32",
                    "nodeType": "ElementaryTypeName",
                    "src": "2052:7:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes32",
                      "typeString": "bytes32"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                }
              ],
              "src": "1956:112:6"
            },
            "payable": false,
            "returnParameters": {
              "id": 2569,
              "nodeType": "ParameterList",
              "parameters": [
                {
                  "constant": false,
                  "id": 2568,
                  "name": "",
                  "nodeType": "VariableDeclaration",
                  "scope": 2590,
                  "src": "2090:4:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bool",
                    "typeString": "bool"
                  },
                  "typeName": {
                    "id": 2567,
                    "name": "bool",
                    "nodeType": "ElementaryTypeName",
                    "src": "2090:4:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bool",
                      "typeString": "bool"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                }
              ],
              "src": "2089:6:6"
            },
            "scope": 2737,
            "src": "1939:315:6",
            "stateMutability": "pure",
            "superFunction": null,
            "visibility": "public"
          },
          {
            "body": {
              "id": 2645,
              "nodeType": "Block",
              "src": "3096:374:6",
              "statements": [
                {
                  "assignments": [
                    2608
                  ],
                  "declarations": [
                    {
                      "constant": false,
                      "id": 2608,
                      "name": "_isExpectedSigner",
                      "nodeType": "VariableDeclaration",
                      "scope": 2646,
                      "src": "3106:22:6",
                      "stateVariable": false,
                      "storageLocation": "default",
                      "typeDescriptions": {
                        "typeIdentifier": "t_bool",
                        "typeString": "bool"
                      },
                      "typeName": {
                        "id": 2607,
                        "name": "bool",
                        "nodeType": "ElementaryTypeName",
                        "src": "3106:4:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bool",
                          "typeString": "bool"
                        }
                      },
                      "value": null,
                      "visibility": "internal"
                    }
                  ],
                  "id": 2618,
                  "initialValue": {
                    "argumentTypes": null,
                    "commonType": {
                      "typeIdentifier": "t_bytes32",
                      "typeString": "bytes32"
                    },
                    "id": 2617,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "lValueRequested": false,
                    "leftExpression": {
                      "argumentTypes": null,
                      "arguments": [
                        {
                          "argumentTypes": null,
                          "arguments": [
                            {
                              "argumentTypes": null,
                              "id": 2611,
                              "name": "_pubkey",
                              "nodeType": "Identifier",
                              "overloadedDeclarations": [],
                              "referencedDeclaration": 2594,
                              "src": "3158:7:6",
                              "typeDescriptions": {
                                "typeIdentifier": "t_bytes_memory_ptr",
                                "typeString": "bytes memory"
                              }
                            }
                          ],
                          "expression": {
                            "argumentTypes": [
                              {
                                "typeIdentifier": "t_bytes_memory_ptr",
                                "typeString": "bytes memory"
                              }
                            ],
                            "id": 2610,
                            "name": "p2wpkhFromPubkey",
                            "nodeType": "Identifier",
                            "overloadedDeclarations": [],
                            "referencedDeclaration": 2555,
                            "src": "3141:16:6",
                            "typeDescriptions": {
                              "typeIdentifier": "t_function_internal_pure$_t_bytes_memory_ptr_$returns$_t_bytes_memory_ptr_$",
                              "typeString": "function (bytes memory) pure returns (bytes memory)"
                            }
                          },
                          "id": 2612,
                          "isConstant": false,
                          "isLValue": false,
                          "isPure": false,
                          "kind": "functionCall",
                          "lValueRequested": false,
                          "names": [],
                          "nodeType": "FunctionCall",
                          "src": "3141:25:6",
                          "typeDescriptions": {
                            "typeIdentifier": "t_bytes_memory_ptr",
                            "typeString": "bytes memory"
                          }
                        }
                      ],
                      "expression": {
                        "argumentTypes": [
                          {
                            "typeIdentifier": "t_bytes_memory_ptr",
                            "typeString": "bytes memory"
                          }
                        ],
                        "id": 2609,
                        "name": "keccak256",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 10510,
                        "src": "3131:9:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_function_sha3_pure$__$returns$_t_bytes32_$",
                          "typeString": "function () pure returns (bytes32)"
                        }
                      },
                      "id": 2613,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": false,
                      "kind": "functionCall",
                      "lValueRequested": false,
                      "names": [],
                      "nodeType": "FunctionCall",
                      "src": "3131:36:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_bytes32",
                        "typeString": "bytes32"
                      }
                    },
                    "nodeType": "BinaryOperation",
                    "operator": "==",
                    "rightExpression": {
                      "argumentTypes": null,
                      "arguments": [
                        {
                          "argumentTypes": null,
                          "id": 2615,
                          "name": "_p2wpkhOutputScript",
                          "nodeType": "Identifier",
                          "overloadedDeclarations": [],
                          "referencedDeclaration": 2592,
                          "src": "3181:19:6",
                          "typeDescriptions": {
                            "typeIdentifier": "t_bytes_memory_ptr",
                            "typeString": "bytes memory"
                          }
                        }
                      ],
                      "expression": {
                        "argumentTypes": [
                          {
                            "typeIdentifier": "t_bytes_memory_ptr",
                            "typeString": "bytes memory"
                          }
                        ],
                        "id": 2614,
                        "name": "keccak256",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 10510,
                        "src": "3171:9:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_function_sha3_pure$__$returns$_t_bytes32_$",
                          "typeString": "function () pure returns (bytes32)"
                        }
                      },
                      "id": 2616,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": false,
                      "kind": "functionCall",
                      "lValueRequested": false,
                      "names": [],
                      "nodeType": "FunctionCall",
                      "src": "3171:30:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_bytes32",
                        "typeString": "bytes32"
                      }
                    },
                    "src": "3131:70:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bool",
                      "typeString": "bool"
                    }
                  },
                  "nodeType": "VariableDeclarationStatement",
                  "src": "3106:95:6"
                },
                {
                  "assignments": [
                    2620
                  ],
                  "declarations": [
                    {
                      "constant": false,
                      "id": 2620,
                      "name": "_truncatedPubkey",
                      "nodeType": "VariableDeclaration",
                      "scope": 2646,
                      "src": "3242:29:6",
                      "stateVariable": false,
                      "storageLocation": "memory",
                      "typeDescriptions": {
                        "typeIdentifier": "t_bytes_memory_ptr",
                        "typeString": "bytes"
                      },
                      "typeName": {
                        "id": 2619,
                        "name": "bytes",
                        "nodeType": "ElementaryTypeName",
                        "src": "3242:5:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_storage_ptr",
                          "typeString": "bytes"
                        }
                      },
                      "value": null,
                      "visibility": "internal"
                    }
                  ],
                  "id": 2629,
                  "initialValue": {
                    "argumentTypes": null,
                    "arguments": [
                      {
                        "argumentTypes": null,
                        "hexValue": "31",
                        "id": 2623,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": true,
                        "kind": "number",
                        "lValueRequested": false,
                        "nodeType": "Literal",
                        "src": "3288:1:6",
                        "subdenomination": null,
                        "typeDescriptions": {
                          "typeIdentifier": "t_rational_1_by_1",
                          "typeString": "int_const 1"
                        },
                        "value": "1"
                      },
                      {
                        "argumentTypes": null,
                        "commonType": {
                          "typeIdentifier": "t_uint256",
                          "typeString": "uint256"
                        },
                        "id": 2627,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": false,
                        "lValueRequested": false,
                        "leftExpression": {
                          "argumentTypes": null,
                          "expression": {
                            "argumentTypes": null,
                            "id": 2624,
                            "name": "_pubkey",
                            "nodeType": "Identifier",
                            "overloadedDeclarations": [],
                            "referencedDeclaration": 2594,
                            "src": "3291:7:6",
                            "typeDescriptions": {
                              "typeIdentifier": "t_bytes_memory_ptr",
                              "typeString": "bytes memory"
                            }
                          },
                          "id": 2625,
                          "isConstant": false,
                          "isLValue": false,
                          "isPure": false,
                          "lValueRequested": false,
                          "memberName": "length",
                          "nodeType": "MemberAccess",
                          "referencedDeclaration": null,
                          "src": "3291:14:6",
                          "typeDescriptions": {
                            "typeIdentifier": "t_uint256",
                            "typeString": "uint256"
                          }
                        },
                        "nodeType": "BinaryOperation",
                        "operator": "-",
                        "rightExpression": {
                          "argumentTypes": null,
                          "hexValue": "31",
                          "id": 2626,
                          "isConstant": false,
                          "isLValue": false,
                          "isPure": true,
                          "kind": "number",
                          "lValueRequested": false,
                          "nodeType": "Literal",
                          "src": "3308:1:6",
                          "subdenomination": null,
                          "typeDescriptions": {
                            "typeIdentifier": "t_rational_1_by_1",
                            "typeString": "int_const 1"
                          },
                          "value": "1"
                        },
                        "src": "3291:18:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_uint256",
                          "typeString": "uint256"
                        }
                      }
                    ],
                    "expression": {
                      "argumentTypes": [
                        {
                          "typeIdentifier": "t_rational_1_by_1",
                          "typeString": "int_const 1"
                        },
                        {
                          "typeIdentifier": "t_uint256",
                          "typeString": "uint256"
                        }
                      ],
                      "expression": {
                        "argumentTypes": null,
                        "id": 2621,
                        "name": "_pubkey",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2594,
                        "src": "3274:7:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        }
                      },
                      "id": 2622,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": false,
                      "lValueRequested": false,
                      "memberName": "slice",
                      "nodeType": "MemberAccess",
                      "referencedDeclaration": 1662,
                      "src": "3274:13:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_function_internal_pure$_t_bytes_memory_ptr_$_t_uint256_$_t_uint256_$returns$_t_bytes_memory_ptr_$bound_to$_t_bytes_memory_ptr_$",
                        "typeString": "function (bytes memory,uint256,uint256) pure returns (bytes memory)"
                      }
                    },
                    "id": 2628,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "kind": "functionCall",
                    "lValueRequested": false,
                    "names": [],
                    "nodeType": "FunctionCall",
                    "src": "3274:36:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_memory_ptr",
                      "typeString": "bytes memory"
                    }
                  },
                  "nodeType": "VariableDeclarationStatement",
                  "src": "3242:68:6"
                },
                {
                  "assignments": [
                    2631
                  ],
                  "declarations": [
                    {
                      "constant": false,
                      "id": 2631,
                      "name": "_sigResult",
                      "nodeType": "VariableDeclaration",
                      "scope": 2646,
                      "src": "3348:15:6",
                      "stateVariable": false,
                      "storageLocation": "default",
                      "typeDescriptions": {
                        "typeIdentifier": "t_bool",
                        "typeString": "bool"
                      },
                      "typeName": {
                        "id": 2630,
                        "name": "bool",
                        "nodeType": "ElementaryTypeName",
                        "src": "3348:4:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bool",
                          "typeString": "bool"
                        }
                      },
                      "value": null,
                      "visibility": "internal"
                    }
                  ],
                  "id": 2639,
                  "initialValue": {
                    "argumentTypes": null,
                    "arguments": [
                      {
                        "argumentTypes": null,
                        "id": 2633,
                        "name": "_truncatedPubkey",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2620,
                        "src": "3375:16:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        }
                      },
                      {
                        "argumentTypes": null,
                        "id": 2634,
                        "name": "_digest",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2596,
                        "src": "3393:7:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        }
                      },
                      {
                        "argumentTypes": null,
                        "id": 2635,
                        "name": "_v",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2598,
                        "src": "3402:2:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_uint8",
                          "typeString": "uint8"
                        }
                      },
                      {
                        "argumentTypes": null,
                        "id": 2636,
                        "name": "_r",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2600,
                        "src": "3406:2:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        }
                      },
                      {
                        "argumentTypes": null,
                        "id": 2637,
                        "name": "_s",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2602,
                        "src": "3410:2:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        }
                      }
                    ],
                    "expression": {
                      "argumentTypes": [
                        {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        },
                        {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        },
                        {
                          "typeIdentifier": "t_uint8",
                          "typeString": "uint8"
                        },
                        {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        },
                        {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        }
                      ],
                      "id": 2632,
                      "name": "checkSig",
                      "nodeType": "Identifier",
                      "overloadedDeclarations": [],
                      "referencedDeclaration": 2590,
                      "src": "3366:8:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_function_internal_pure$_t_bytes_memory_ptr_$_t_bytes32_$_t_uint8_$_t_bytes32_$_t_bytes32_$returns$_t_bool_$",
                        "typeString": "function (bytes memory,bytes32,uint8,bytes32,bytes32) pure returns (bool)"
                      }
                    },
                    "id": 2638,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "kind": "functionCall",
                    "lValueRequested": false,
                    "names": [],
                    "nodeType": "FunctionCall",
                    "src": "3366:47:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bool",
                      "typeString": "bool"
                    }
                  },
                  "nodeType": "VariableDeclarationStatement",
                  "src": "3348:65:6"
                },
                {
                  "expression": {
                    "argumentTypes": null,
                    "components": [
                      {
                        "argumentTypes": null,
                        "commonType": {
                          "typeIdentifier": "t_bool",
                          "typeString": "bool"
                        },
                        "id": 2642,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": false,
                        "lValueRequested": false,
                        "leftExpression": {
                          "argumentTypes": null,
                          "id": 2640,
                          "name": "_isExpectedSigner",
                          "nodeType": "Identifier",
                          "overloadedDeclarations": [],
                          "referencedDeclaration": 2608,
                          "src": "3431:17:6",
                          "typeDescriptions": {
                            "typeIdentifier": "t_bool",
                            "typeString": "bool"
                          }
                        },
                        "nodeType": "BinaryOperation",
                        "operator": "&&",
                        "rightExpression": {
                          "argumentTypes": null,
                          "id": 2641,
                          "name": "_sigResult",
                          "nodeType": "Identifier",
                          "overloadedDeclarations": [],
                          "referencedDeclaration": 2631,
                          "src": "3452:10:6",
                          "typeDescriptions": {
                            "typeIdentifier": "t_bool",
                            "typeString": "bool"
                          }
                        },
                        "src": "3431:31:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bool",
                          "typeString": "bool"
                        }
                      }
                    ],
                    "id": 2643,
                    "isConstant": false,
                    "isInlineArray": false,
                    "isLValue": false,
                    "isPure": false,
                    "lValueRequested": false,
                    "nodeType": "TupleExpression",
                    "src": "3430:33:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bool",
                      "typeString": "bool"
                    }
                  },
                  "functionReturnParameters": 2606,
                  "id": 2644,
                  "nodeType": "Return",
                  "src": "3423:40:6"
                }
              ]
            },
            "documentation": "@notice                     checks a signed message against a bitcoin p2wpkh output script\n @dev                        does this my verifying the p2wpkh matches an ethereum account\n @param _p2wpkhOutputScript  the bitcoin output script\n @param _pubkey              the public key to check\n @param _digest              the message digest signed\n @param _v                   the signature recovery value\n @param _r                   the signature r value\n @param _s                   the signature s value\n @return                     true if signature is valid, else false",
            "id": 2646,
            "implemented": true,
            "isConstructor": false,
            "isDeclaredConst": true,
            "modifiers": [],
            "name": "checkBitcoinSig",
            "nodeType": "FunctionDefinition",
            "parameters": {
              "id": 2603,
              "nodeType": "ParameterList",
              "parameters": [
                {
                  "constant": false,
                  "id": 2592,
                  "name": "_p2wpkhOutputScript",
                  "nodeType": "VariableDeclaration",
                  "scope": 2646,
                  "src": "2931:25:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes_memory_ptr",
                    "typeString": "bytes"
                  },
                  "typeName": {
                    "id": 2591,
                    "name": "bytes",
                    "nodeType": "ElementaryTypeName",
                    "src": "2931:5:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_storage_ptr",
                      "typeString": "bytes"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2594,
                  "name": "_pubkey",
                  "nodeType": "VariableDeclaration",
                  "scope": 2646,
                  "src": "2966:13:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes_memory_ptr",
                    "typeString": "bytes"
                  },
                  "typeName": {
                    "id": 2593,
                    "name": "bytes",
                    "nodeType": "ElementaryTypeName",
                    "src": "2966:5:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_storage_ptr",
                      "typeString": "bytes"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2596,
                  "name": "_digest",
                  "nodeType": "VariableDeclaration",
                  "scope": 2646,
                  "src": "2989:15:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes32",
                    "typeString": "bytes32"
                  },
                  "typeName": {
                    "id": 2595,
                    "name": "bytes32",
                    "nodeType": "ElementaryTypeName",
                    "src": "2989:7:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes32",
                      "typeString": "bytes32"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2598,
                  "name": "_v",
                  "nodeType": "VariableDeclaration",
                  "scope": 2646,
                  "src": "3014:8:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_uint8",
                    "typeString": "uint8"
                  },
                  "typeName": {
                    "id": 2597,
                    "name": "uint8",
                    "nodeType": "ElementaryTypeName",
                    "src": "3014:5:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_uint8",
                      "typeString": "uint8"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2600,
                  "name": "_r",
                  "nodeType": "VariableDeclaration",
                  "scope": 2646,
                  "src": "3032:10:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes32",
                    "typeString": "bytes32"
                  },
                  "typeName": {
                    "id": 2599,
                    "name": "bytes32",
                    "nodeType": "ElementaryTypeName",
                    "src": "3032:7:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes32",
                      "typeString": "bytes32"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2602,
                  "name": "_s",
                  "nodeType": "VariableDeclaration",
                  "scope": 2646,
                  "src": "3052:10:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes32",
                    "typeString": "bytes32"
                  },
                  "typeName": {
                    "id": 2601,
                    "name": "bytes32",
                    "nodeType": "ElementaryTypeName",
                    "src": "3052:7:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes32",
                      "typeString": "bytes32"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                }
              ],
              "src": "2921:147:6"
            },
            "payable": false,
            "returnParameters": {
              "id": 2606,
              "nodeType": "ParameterList",
              "parameters": [
                {
                  "constant": false,
                  "id": 2605,
                  "name": "",
                  "nodeType": "VariableDeclaration",
                  "scope": 2646,
                  "src": "3090:4:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bool",
                    "typeString": "bool"
                  },
                  "typeName": {
                    "id": 2604,
                    "name": "bool",
                    "nodeType": "ElementaryTypeName",
                    "src": "3090:4:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bool",
                      "typeString": "bool"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                }
              ],
              "src": "3089:6:6"
            },
            "scope": 2737,
            "src": "2897:573:6",
            "stateMutability": "pure",
            "superFunction": null,
            "visibility": "public"
          },
          {
            "body": {
              "id": 2661,
              "nodeType": "Block",
              "src": "3909:53:6",
              "statements": [
                {
                  "expression": {
                    "argumentTypes": null,
                    "commonType": {
                      "typeIdentifier": "t_bytes32",
                      "typeString": "bytes32"
                    },
                    "id": 2659,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "lValueRequested": false,
                    "leftExpression": {
                      "argumentTypes": null,
                      "arguments": [
                        {
                          "argumentTypes": null,
                          "id": 2656,
                          "name": "_candidate",
                          "nodeType": "Identifier",
                          "overloadedDeclarations": [],
                          "referencedDeclaration": 2648,
                          "src": "3933:10:6",
                          "typeDescriptions": {
                            "typeIdentifier": "t_bytes_memory_ptr",
                            "typeString": "bytes memory"
                          }
                        }
                      ],
                      "expression": {
                        "argumentTypes": [
                          {
                            "typeIdentifier": "t_bytes_memory_ptr",
                            "typeString": "bytes memory"
                          }
                        ],
                        "id": 2655,
                        "name": "sha256",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 10525,
                        "src": "3926:6:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_function_sha256_pure$__$returns$_t_bytes32_$",
                          "typeString": "function () pure returns (bytes32)"
                        }
                      },
                      "id": 2657,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": false,
                      "kind": "functionCall",
                      "lValueRequested": false,
                      "names": [],
                      "nodeType": "FunctionCall",
                      "src": "3926:18:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_bytes32",
                        "typeString": "bytes32"
                      }
                    },
                    "nodeType": "BinaryOperation",
                    "operator": "==",
                    "rightExpression": {
                      "argumentTypes": null,
                      "id": 2658,
                      "name": "_digest",
                      "nodeType": "Identifier",
                      "overloadedDeclarations": [],
                      "referencedDeclaration": 2650,
                      "src": "3948:7:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_bytes32",
                        "typeString": "bytes32"
                      }
                    },
                    "src": "3926:29:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bool",
                      "typeString": "bool"
                    }
                  },
                  "functionReturnParameters": 2654,
                  "id": 2660,
                  "nodeType": "Return",
                  "src": "3919:36:6"
                }
              ]
            },
            "documentation": "@notice             checks if a message is the sha256 preimage of a digest\n @dev                this is NOT the hash256!  this step is necessary for ECDSA security!\n @param _digest      the digest\n @param _candidate   the purported preimage\n @return             the p2wkph output script",
            "id": 2662,
            "implemented": true,
            "isConstructor": false,
            "isDeclaredConst": true,
            "modifiers": [],
            "name": "isSha256Preimage",
            "nodeType": "FunctionDefinition",
            "parameters": {
              "id": 2651,
              "nodeType": "ParameterList",
              "parameters": [
                {
                  "constant": false,
                  "id": 2648,
                  "name": "_candidate",
                  "nodeType": "VariableDeclaration",
                  "scope": 2662,
                  "src": "3834:16:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes_memory_ptr",
                    "typeString": "bytes"
                  },
                  "typeName": {
                    "id": 2647,
                    "name": "bytes",
                    "nodeType": "ElementaryTypeName",
                    "src": "3834:5:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_storage_ptr",
                      "typeString": "bytes"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2650,
                  "name": "_digest",
                  "nodeType": "VariableDeclaration",
                  "scope": 2662,
                  "src": "3860:15:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes32",
                    "typeString": "bytes32"
                  },
                  "typeName": {
                    "id": 2649,
                    "name": "bytes32",
                    "nodeType": "ElementaryTypeName",
                    "src": "3860:7:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes32",
                      "typeString": "bytes32"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                }
              ],
              "src": "3824:57:6"
            },
            "payable": false,
            "returnParameters": {
              "id": 2654,
              "nodeType": "ParameterList",
              "parameters": [
                {
                  "constant": false,
                  "id": 2653,
                  "name": "",
                  "nodeType": "VariableDeclaration",
                  "scope": 2662,
                  "src": "3903:4:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bool",
                    "typeString": "bool"
                  },
                  "typeName": {
                    "id": 2652,
                    "name": "bool",
                    "nodeType": "ElementaryTypeName",
                    "src": "3903:4:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bool",
                      "typeString": "bool"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                }
              ],
              "src": "3902:6:6"
            },
            "scope": 2737,
            "src": "3799:163:6",
            "stateMutability": "pure",
            "superFunction": null,
            "visibility": "public"
          },
          {
            "body": {
              "id": 2677,
              "nodeType": "Block",
              "src": "4381:56:6",
              "statements": [
                {
                  "expression": {
                    "argumentTypes": null,
                    "commonType": {
                      "typeIdentifier": "t_bytes32",
                      "typeString": "bytes32"
                    },
                    "id": 2675,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "lValueRequested": false,
                    "leftExpression": {
                      "argumentTypes": null,
                      "arguments": [
                        {
                          "argumentTypes": null,
                          "id": 2672,
                          "name": "_candidate",
                          "nodeType": "Identifier",
                          "overloadedDeclarations": [],
                          "referencedDeclaration": 2664,
                          "src": "4408:10:6",
                          "typeDescriptions": {
                            "typeIdentifier": "t_bytes_memory_ptr",
                            "typeString": "bytes memory"
                          }
                        }
                      ],
                      "expression": {
                        "argumentTypes": [
                          {
                            "typeIdentifier": "t_bytes_memory_ptr",
                            "typeString": "bytes memory"
                          }
                        ],
                        "id": 2671,
                        "name": "keccak256",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 10510,
                        "src": "4398:9:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_function_sha3_pure$__$returns$_t_bytes32_$",
                          "typeString": "function () pure returns (bytes32)"
                        }
                      },
                      "id": 2673,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": false,
                      "kind": "functionCall",
                      "lValueRequested": false,
                      "names": [],
                      "nodeType": "FunctionCall",
                      "src": "4398:21:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_bytes32",
                        "typeString": "bytes32"
                      }
                    },
                    "nodeType": "BinaryOperation",
                    "operator": "==",
                    "rightExpression": {
                      "argumentTypes": null,
                      "id": 2674,
                      "name": "_digest",
                      "nodeType": "Identifier",
                      "overloadedDeclarations": [],
                      "referencedDeclaration": 2666,
                      "src": "4423:7:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_bytes32",
                        "typeString": "bytes32"
                      }
                    },
                    "src": "4398:32:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bool",
                      "typeString": "bool"
                    }
                  },
                  "functionReturnParameters": 2670,
                  "id": 2676,
                  "nodeType": "Return",
                  "src": "4391:39:6"
                }
              ]
            },
            "documentation": "@notice             checks if a message is the keccak256 preimage of a digest\n @dev                this step is necessary for ECDSA security!\n @param _digest      the digest\n @param _candidate   the purported preimage\n @return             the p2wkph output script",
            "id": 2678,
            "implemented": true,
            "isConstructor": false,
            "isDeclaredConst": true,
            "modifiers": [],
            "name": "isKeccak256Preimage",
            "nodeType": "FunctionDefinition",
            "parameters": {
              "id": 2667,
              "nodeType": "ParameterList",
              "parameters": [
                {
                  "constant": false,
                  "id": 2664,
                  "name": "_candidate",
                  "nodeType": "VariableDeclaration",
                  "scope": 2678,
                  "src": "4306:16:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes_memory_ptr",
                    "typeString": "bytes"
                  },
                  "typeName": {
                    "id": 2663,
                    "name": "bytes",
                    "nodeType": "ElementaryTypeName",
                    "src": "4306:5:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_storage_ptr",
                      "typeString": "bytes"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2666,
                  "name": "_digest",
                  "nodeType": "VariableDeclaration",
                  "scope": 2678,
                  "src": "4332:15:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes32",
                    "typeString": "bytes32"
                  },
                  "typeName": {
                    "id": 2665,
                    "name": "bytes32",
                    "nodeType": "ElementaryTypeName",
                    "src": "4332:7:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes32",
                      "typeString": "bytes32"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                }
              ],
              "src": "4296:57:6"
            },
            "payable": false,
            "returnParameters": {
              "id": 2670,
              "nodeType": "ParameterList",
              "parameters": [
                {
                  "constant": false,
                  "id": 2669,
                  "name": "",
                  "nodeType": "VariableDeclaration",
                  "scope": 2678,
                  "src": "4375:4:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bool",
                    "typeString": "bool"
                  },
                  "typeName": {
                    "id": 2668,
                    "name": "bool",
                    "nodeType": "ElementaryTypeName",
                    "src": "4375:4:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bool",
                      "typeString": "bool"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                }
              ],
              "src": "4374:6:6"
            },
            "scope": 2737,
            "src": "4268:169:6",
            "stateMutability": "pure",
            "superFunction": null,
            "visibility": "public"
          },
          {
            "body": {
              "id": 2735,
              "nodeType": "Block",
              "src": "5384:1113:6",
              "statements": [
                {
                  "assignments": [
                    2694
                  ],
                  "declarations": [
                    {
                      "constant": false,
                      "id": 2694,
                      "name": "_scriptCode",
                      "nodeType": "VariableDeclaration",
                      "scope": 2736,
                      "src": "5501:24:6",
                      "stateVariable": false,
                      "storageLocation": "memory",
                      "typeDescriptions": {
                        "typeIdentifier": "t_bytes_memory_ptr",
                        "typeString": "bytes"
                      },
                      "typeName": {
                        "id": 2693,
                        "name": "bytes",
                        "nodeType": "ElementaryTypeName",
                        "src": "5501:5:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_storage_ptr",
                          "typeString": "bytes"
                        }
                      },
                      "value": null,
                      "visibility": "internal"
                    }
                  ],
                  "id": 2701,
                  "initialValue": {
                    "argumentTypes": null,
                    "arguments": [
                      {
                        "argumentTypes": null,
                        "hexValue": "1976a914",
                        "id": 2697,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": true,
                        "kind": "string",
                        "lValueRequested": false,
                        "nodeType": "Literal",
                        "src": "5558:13:6",
                        "subdenomination": null,
                        "typeDescriptions": {
                          "typeIdentifier": "t_stringliteral_16c8cfb2189d45894fd227d6cf32ba616da47433f9bbc2f735a1096c3618c12f",
                          "typeString": "literal_string (contains invalid UTF-8 sequence at position 2)"
                        },
                        "value": null
                      },
                      {
                        "argumentTypes": null,
                        "id": 2698,
                        "name": "_inputPKH",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2682,
                        "src": "5622:9:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes20",
                          "typeString": "bytes20"
                        }
                      },
                      {
                        "argumentTypes": null,
                        "hexValue": "88ac",
                        "id": 2699,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": true,
                        "kind": "string",
                        "lValueRequested": false,
                        "nodeType": "Literal",
                        "src": "5645:9:6",
                        "subdenomination": null,
                        "typeDescriptions": {
                          "typeIdentifier": "t_stringliteral_3b50b2715f5a28d2a7eeb517f17ec797e8536bd425bf31fc4f6bf7ce1e34b77d",
                          "typeString": "literal_string (contains invalid UTF-8 sequence at position 0)"
                        },
                        "value": null
                      }
                    ],
                    "expression": {
                      "argumentTypes": [
                        {
                          "typeIdentifier": "t_stringliteral_16c8cfb2189d45894fd227d6cf32ba616da47433f9bbc2f735a1096c3618c12f",
                          "typeString": "literal_string (contains invalid UTF-8 sequence at position 2)"
                        },
                        {
                          "typeIdentifier": "t_bytes20",
                          "typeString": "bytes20"
                        },
                        {
                          "typeIdentifier": "t_stringliteral_3b50b2715f5a28d2a7eeb517f17ec797e8536bd425bf31fc4f6bf7ce1e34b77d",
                          "typeString": "literal_string (contains invalid UTF-8 sequence at position 0)"
                        }
                      ],
                      "expression": {
                        "argumentTypes": null,
                        "id": 2695,
                        "name": "abi",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 10503,
                        "src": "5528:3:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_magic_abi",
                          "typeString": "abi"
                        }
                      },
                      "id": 2696,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": true,
                      "lValueRequested": false,
                      "memberName": "encodePacked",
                      "nodeType": "MemberAccess",
                      "referencedDeclaration": null,
                      "src": "5528:16:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_function_abiencodepacked_pure$__$returns$_t_bytes_memory_ptr_$",
                        "typeString": "function () pure returns (bytes memory)"
                      }
                    },
                    "id": 2700,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "kind": "functionCall",
                    "lValueRequested": false,
                    "names": [],
                    "nodeType": "FunctionCall",
                    "src": "5528:127:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_memory_ptr",
                      "typeString": "bytes memory"
                    }
                  },
                  "nodeType": "VariableDeclarationStatement",
                  "src": "5501:154:6"
                },
                {
                  "assignments": [
                    2703
                  ],
                  "declarations": [
                    {
                      "constant": false,
                      "id": 2703,
                      "name": "_hashOutputs",
                      "nodeType": "VariableDeclaration",
                      "scope": 2736,
                      "src": "5685:20:6",
                      "stateVariable": false,
                      "storageLocation": "default",
                      "typeDescriptions": {
                        "typeIdentifier": "t_bytes32",
                        "typeString": "bytes32"
                      },
                      "typeName": {
                        "id": 2702,
                        "name": "bytes32",
                        "nodeType": "ElementaryTypeName",
                        "src": "5685:7:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        }
                      },
                      "value": null,
                      "visibility": "internal"
                    }
                  ],
                  "id": 2712,
                  "initialValue": {
                    "argumentTypes": null,
                    "arguments": [],
                    "expression": {
                      "argumentTypes": [],
                      "expression": {
                        "argumentTypes": null,
                        "arguments": [
                          {
                            "argumentTypes": null,
                            "id": 2706,
                            "name": "_outputValue",
                            "nodeType": "Identifier",
                            "overloadedDeclarations": [],
                            "referencedDeclaration": 2686,
                            "src": "5738:12:6",
                            "typeDescriptions": {
                              "typeIdentifier": "t_bytes8",
                              "typeString": "bytes8"
                            }
                          },
                          {
                            "argumentTypes": null,
                            "hexValue": "160014",
                            "id": 2707,
                            "isConstant": false,
                            "isLValue": false,
                            "isPure": true,
                            "kind": "string",
                            "lValueRequested": false,
                            "nodeType": "Literal",
                            "src": "5778:11:6",
                            "subdenomination": null,
                            "typeDescriptions": {
                              "typeIdentifier": "t_stringliteral_bde11925feafe00f4d9d48ef4480be1ea68d808b9c557770a6133e20d41f44bf",
                              "typeString": "literal_string \"\u0016\u0000\u0014\""
                            },
                            "value": "\u0016\u0000\u0014"
                          },
                          {
                            "argumentTypes": null,
                            "id": 2708,
                            "name": "_outputPKH",
                            "nodeType": "Identifier",
                            "overloadedDeclarations": [],
                            "referencedDeclaration": 2688,
                            "src": "5827:10:6",
                            "typeDescriptions": {
                              "typeIdentifier": "t_bytes20",
                              "typeString": "bytes20"
                            }
                          }
                        ],
                        "expression": {
                          "argumentTypes": [
                            {
                              "typeIdentifier": "t_bytes8",
                              "typeString": "bytes8"
                            },
                            {
                              "typeIdentifier": "t_stringliteral_bde11925feafe00f4d9d48ef4480be1ea68d808b9c557770a6133e20d41f44bf",
                              "typeString": "literal_string \"\u0016\u0000\u0014\""
                            },
                            {
                              "typeIdentifier": "t_bytes20",
                              "typeString": "bytes20"
                            }
                          ],
                          "expression": {
                            "argumentTypes": null,
                            "id": 2704,
                            "name": "abi",
                            "nodeType": "Identifier",
                            "overloadedDeclarations": [],
                            "referencedDeclaration": 10503,
                            "src": "5708:3:6",
                            "typeDescriptions": {
                              "typeIdentifier": "t_magic_abi",
                              "typeString": "abi"
                            }
                          },
                          "id": 2705,
                          "isConstant": false,
                          "isLValue": false,
                          "isPure": true,
                          "lValueRequested": false,
                          "memberName": "encodePacked",
                          "nodeType": "MemberAccess",
                          "referencedDeclaration": null,
                          "src": "5708:16:6",
                          "typeDescriptions": {
                            "typeIdentifier": "t_function_abiencodepacked_pure$__$returns$_t_bytes_memory_ptr_$",
                            "typeString": "function () pure returns (bytes memory)"
                          }
                        },
                        "id": 2709,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": false,
                        "kind": "functionCall",
                        "lValueRequested": false,
                        "names": [],
                        "nodeType": "FunctionCall",
                        "src": "5708:130:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        }
                      },
                      "id": 2710,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": false,
                      "lValueRequested": false,
                      "memberName": "hash256",
                      "nodeType": "MemberAccess",
                      "referencedDeclaration": 679,
                      "src": "5708:138:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_function_delegatecall_pure$_t_bytes_memory_ptr_$returns$_t_bytes32_$bound_to$_t_bytes_memory_ptr_$",
                        "typeString": "function (bytes memory) pure returns (bytes32)"
                      }
                    },
                    "id": 2711,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "kind": "functionCall",
                    "lValueRequested": false,
                    "names": [],
                    "nodeType": "FunctionCall",
                    "src": "5708:140:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes32",
                      "typeString": "bytes32"
                    }
                  },
                  "nodeType": "VariableDeclarationStatement",
                  "src": "5685:163:6"
                },
                {
                  "assignments": [
                    2714
                  ],
                  "declarations": [
                    {
                      "constant": false,
                      "id": 2714,
                      "name": "_sighashPreimage",
                      "nodeType": "VariableDeclaration",
                      "scope": 2736,
                      "src": "5858:29:6",
                      "stateVariable": false,
                      "storageLocation": "memory",
                      "typeDescriptions": {
                        "typeIdentifier": "t_bytes_memory_ptr",
                        "typeString": "bytes"
                      },
                      "typeName": {
                        "id": 2713,
                        "name": "bytes",
                        "nodeType": "ElementaryTypeName",
                        "src": "5858:5:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_storage_ptr",
                          "typeString": "bytes"
                        }
                      },
                      "value": null,
                      "visibility": "internal"
                    }
                  ],
                  "id": 2730,
                  "initialValue": {
                    "argumentTypes": null,
                    "arguments": [
                      {
                        "argumentTypes": null,
                        "hexValue": "01000000",
                        "id": 2717,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": true,
                        "kind": "string",
                        "lValueRequested": false,
                        "nodeType": "Literal",
                        "src": "5920:13:6",
                        "subdenomination": null,
                        "typeDescriptions": {
                          "typeIdentifier": "t_stringliteral_e37890bf230cf36ea140a5dbb9a561aa7ef84f8f995873db8386eba4a95c7bbe",
                          "typeString": "literal_string \"\u0001\u0000\u0000\u0000\""
                        },
                        "value": "\u0001\u0000\u0000\u0000"
                      },
                      {
                        "argumentTypes": null,
                        "arguments": [],
                        "expression": {
                          "argumentTypes": [],
                          "expression": {
                            "argumentTypes": null,
                            "id": 2718,
                            "name": "_outpoint",
                            "nodeType": "Identifier",
                            "overloadedDeclarations": [],
                            "referencedDeclaration": 2680,
                            "src": "5959:9:6",
                            "typeDescriptions": {
                              "typeIdentifier": "t_bytes_memory_ptr",
                              "typeString": "bytes memory"
                            }
                          },
                          "id": 2719,
                          "isConstant": false,
                          "isLValue": false,
                          "isPure": false,
                          "lValueRequested": false,
                          "memberName": "hash256",
                          "nodeType": "MemberAccess",
                          "referencedDeclaration": 679,
                          "src": "5959:17:6",
                          "typeDescriptions": {
                            "typeIdentifier": "t_function_delegatecall_pure$_t_bytes_memory_ptr_$returns$_t_bytes32_$bound_to$_t_bytes_memory_ptr_$",
                            "typeString": "function (bytes memory) pure returns (bytes32)"
                          }
                        },
                        "id": 2720,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": false,
                        "kind": "functionCall",
                        "lValueRequested": false,
                        "names": [],
                        "nodeType": "FunctionCall",
                        "src": "5959:19:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        }
                      },
                      {
                        "argumentTypes": null,
                        "hexValue": "8cb9012517c817fead650287d61bdd9c68803b6bf9c64133dcab3e65b5a50cb9",
                        "id": 2721,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": true,
                        "kind": "string",
                        "lValueRequested": false,
                        "nodeType": "Literal",
                        "src": "6009:69:6",
                        "subdenomination": null,
                        "typeDescriptions": {
                          "typeIdentifier": "t_stringliteral_de9eeb8dbbea7702bb2ae084a168f6422ddcaa5a73975470e9f2441f0c122d45",
                          "typeString": "literal_string (contains invalid UTF-8 sequence at position 0)"
                        },
                        "value": null
                      },
                      {
                        "argumentTypes": null,
                        "id": 2722,
                        "name": "_outpoint",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2680,
                        "src": "6119:9:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        }
                      },
                      {
                        "argumentTypes": null,
                        "id": 2723,
                        "name": "_scriptCode",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2694,
                        "src": "6155:11:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        }
                      },
                      {
                        "argumentTypes": null,
                        "id": 2724,
                        "name": "_inputValue",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2684,
                        "src": "6203:11:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes8",
                          "typeString": "bytes8"
                        }
                      },
                      {
                        "argumentTypes": null,
                        "hexValue": "00000000",
                        "id": 2725,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": true,
                        "kind": "string",
                        "lValueRequested": false,
                        "nodeType": "Literal",
                        "src": "6264:13:6",
                        "subdenomination": null,
                        "typeDescriptions": {
                          "typeIdentifier": "t_stringliteral_e8e77626586f73b955364c7b4bbf0bb7f7685ebd40e852b164633a4acbd3244c",
                          "typeString": "literal_string \"\u0000\u0000\u0000\u0000\""
                        },
                        "value": "\u0000\u0000\u0000\u0000"
                      },
                      {
                        "argumentTypes": null,
                        "id": 2726,
                        "name": "_hashOutputs",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2703,
                        "src": "6311:12:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        }
                      },
                      {
                        "argumentTypes": null,
                        "hexValue": "00000000",
                        "id": 2727,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": true,
                        "kind": "string",
                        "lValueRequested": false,
                        "nodeType": "Literal",
                        "src": "6367:13:6",
                        "subdenomination": null,
                        "typeDescriptions": {
                          "typeIdentifier": "t_stringliteral_e8e77626586f73b955364c7b4bbf0bb7f7685ebd40e852b164633a4acbd3244c",
                          "typeString": "literal_string \"\u0000\u0000\u0000\u0000\""
                        },
                        "value": "\u0000\u0000\u0000\u0000"
                      },
                      {
                        "argumentTypes": null,
                        "hexValue": "01000000",
                        "id": 2728,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": true,
                        "kind": "string",
                        "lValueRequested": false,
                        "nodeType": "Literal",
                        "src": "6408:13:6",
                        "subdenomination": null,
                        "typeDescriptions": {
                          "typeIdentifier": "t_stringliteral_e37890bf230cf36ea140a5dbb9a561aa7ef84f8f995873db8386eba4a95c7bbe",
                          "typeString": "literal_string \"\u0001\u0000\u0000\u0000\""
                        },
                        "value": "\u0001\u0000\u0000\u0000"
                      }
                    ],
                    "expression": {
                      "argumentTypes": [
                        {
                          "typeIdentifier": "t_stringliteral_e37890bf230cf36ea140a5dbb9a561aa7ef84f8f995873db8386eba4a95c7bbe",
                          "typeString": "literal_string \"\u0001\u0000\u0000\u0000\""
                        },
                        {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        },
                        {
                          "typeIdentifier": "t_stringliteral_de9eeb8dbbea7702bb2ae084a168f6422ddcaa5a73975470e9f2441f0c122d45",
                          "typeString": "literal_string (contains invalid UTF-8 sequence at position 0)"
                        },
                        {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        },
                        {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        },
                        {
                          "typeIdentifier": "t_bytes8",
                          "typeString": "bytes8"
                        },
                        {
                          "typeIdentifier": "t_stringliteral_e8e77626586f73b955364c7b4bbf0bb7f7685ebd40e852b164633a4acbd3244c",
                          "typeString": "literal_string \"\u0000\u0000\u0000\u0000\""
                        },
                        {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        },
                        {
                          "typeIdentifier": "t_stringliteral_e8e77626586f73b955364c7b4bbf0bb7f7685ebd40e852b164633a4acbd3244c",
                          "typeString": "literal_string \"\u0000\u0000\u0000\u0000\""
                        },
                        {
                          "typeIdentifier": "t_stringliteral_e37890bf230cf36ea140a5dbb9a561aa7ef84f8f995873db8386eba4a95c7bbe",
                          "typeString": "literal_string \"\u0001\u0000\u0000\u0000\""
                        }
                      ],
                      "expression": {
                        "argumentTypes": null,
                        "id": 2715,
                        "name": "abi",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 10503,
                        "src": "5890:3:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_magic_abi",
                          "typeString": "abi"
                        }
                      },
                      "id": 2716,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": true,
                      "lValueRequested": false,
                      "memberName": "encodePacked",
                      "nodeType": "MemberAccess",
                      "referencedDeclaration": null,
                      "src": "5890:16:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_function_abiencodepacked_pure$__$returns$_t_bytes_memory_ptr_$",
                        "typeString": "function () pure returns (bytes memory)"
                      }
                    },
                    "id": 2729,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "kind": "functionCall",
                    "lValueRequested": false,
                    "names": [],
                    "nodeType": "FunctionCall",
                    "src": "5890:557:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_memory_ptr",
                      "typeString": "bytes memory"
                    }
                  },
                  "nodeType": "VariableDeclarationStatement",
                  "src": "5858:589:6"
                },
                {
                  "expression": {
                    "argumentTypes": null,
                    "arguments": [],
                    "expression": {
                      "argumentTypes": [],
                      "expression": {
                        "argumentTypes": null,
                        "id": 2731,
                        "name": "_sighashPreimage",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2714,
                        "src": "6464:16:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        }
                      },
                      "id": 2732,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": false,
                      "lValueRequested": false,
                      "memberName": "hash256",
                      "nodeType": "MemberAccess",
                      "referencedDeclaration": 679,
                      "src": "6464:24:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_function_delegatecall_pure$_t_bytes_memory_ptr_$returns$_t_bytes32_$bound_to$_t_bytes_memory_ptr_$",
                        "typeString": "function (bytes memory) pure returns (bytes32)"
                      }
                    },
                    "id": 2733,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "kind": "functionCall",
                    "lValueRequested": false,
                    "names": [],
                    "nodeType": "FunctionCall",
                    "src": "6464:26:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes32",
                      "typeString": "bytes32"
                    }
                  },
                  "functionReturnParameters": 2692,
                  "id": 2734,
                  "nodeType": "Return",
                  "src": "6457:33:6"
                }
              ]
            },
            "documentation": "@notice                 calculates the signature hash of a Bitcoin transaction with the provided details\n @dev                    documented in bip143. many values are hardcoded here\n @param _outpoint        the bitcoin output script\n @param _inputPKH        the input pubkeyhash (hash160(sender_pubkey))\n @param _inputValue      the value of the input in satoshi\n @param _outputValue     the value of the output in satoshi\n @param _outputPKH       the output pubkeyhash (hash160(recipient_pubkey))\n @return                 the double-sha256 (hash256) signature hash as defined by bip143",
            "id": 2736,
            "implemented": true,
            "isConstructor": false,
            "isDeclaredConst": true,
            "modifiers": [],
            "name": "oneInputOneOutputSighash",
            "nodeType": "FunctionDefinition",
            "parameters": {
              "id": 2689,
              "nodeType": "ParameterList",
              "parameters": [
                {
                  "constant": false,
                  "id": 2680,
                  "name": "_outpoint",
                  "nodeType": "VariableDeclaration",
                  "scope": 2736,
                  "src": "5132:15:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes_memory_ptr",
                    "typeString": "bytes"
                  },
                  "typeName": {
                    "id": 2679,
                    "name": "bytes",
                    "nodeType": "ElementaryTypeName",
                    "src": "5132:5:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_storage_ptr",
                      "typeString": "bytes"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2682,
                  "name": "_inputPKH",
                  "nodeType": "VariableDeclaration",
                  "scope": 2736,
                  "src": "5177:17:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes20",
                    "typeString": "bytes20"
                  },
                  "typeName": {
                    "id": 2681,
                    "name": "bytes20",
                    "nodeType": "ElementaryTypeName",
                    "src": "5177:7:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes20",
                      "typeString": "bytes20"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2684,
                  "name": "_inputValue",
                  "nodeType": "VariableDeclaration",
                  "scope": 2736,
                  "src": "5224:18:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes8",
                    "typeString": "bytes8"
                  },
                  "typeName": {
                    "id": 2683,
                    "name": "bytes8",
                    "nodeType": "ElementaryTypeName",
                    "src": "5224:6:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes8",
                      "typeString": "bytes8"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2686,
                  "name": "_outputValue",
                  "nodeType": "VariableDeclaration",
                  "scope": 2736,
                  "src": "5266:19:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes8",
                    "typeString": "bytes8"
                  },
                  "typeName": {
                    "id": 2685,
                    "name": "bytes8",
                    "nodeType": "ElementaryTypeName",
                    "src": "5266:6:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes8",
                      "typeString": "bytes8"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2688,
                  "name": "_outputPKH",
                  "nodeType": "VariableDeclaration",
                  "scope": 2736,
                  "src": "5309:18:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes20",
                    "typeString": "bytes20"
                  },
                  "typeName": {
                    "id": 2687,
                    "name": "bytes20",
                    "nodeType": "ElementaryTypeName",
                    "src": "5309:7:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes20",
                      "typeString": "bytes20"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                }
              ],
              "src": "5122:231:6"
            },
            "payable": false,
            "returnParameters": {
              "id": 2692,
              "nodeType": "ParameterList",
              "parameters": [
                {
                  "constant": false,
                  "id": 2691,
                  "name": "",
                  "nodeType": "VariableDeclaration",
                  "scope": 2736,
                  "src": "5375:7:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes32",
                    "typeString": "bytes32"
                  },
                  "typeName": {
                    "id": 2690,
                    "name": "bytes32",
                    "nodeType": "ElementaryTypeName",
                    "src": "5375:7:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes32",
                      "typeString": "bytes32"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                }
              ],
              "src": "5374:9:6"
            },
            "scope": 2737,
            "src": "5089:1408:6",
            "stateMutability": "pure",
            "superFunction": null,
            "visibility": "public"
          }
        ],
        "scope": 2738,
        "src": "182:6317:6"
      }
    ],
    "src": "0:6500:6"
  },
  "legacyAST": {
    "absolutePath": "/Users/liamz/go/src/github.com/keep-network/tbtc/implementation/contracts/bitcoin-spv/SigCheck.sol",
    "exportedSymbols": {
      "CheckBitcoinSigs": [
        2737
      ]
    },
    "id": 2738,
    "nodeType": "SourceUnit",
    "nodes": [
      {
        "id": 2472,
        "literals": [
          "solidity",
          "0.4",
          ".25"
        ],
        "nodeType": "PragmaDirective",
        "src": "0:23:6"
      },
      {
        "absolutePath": "/Users/liamz/go/src/github.com/keep-network/tbtc/implementation/contracts/bitcoin-spv/BytesLib.sol",
        "file": "./BytesLib.sol",
        "id": 2474,
        "nodeType": "ImportDirective",
        "scope": 2738,
        "sourceUnit": 1775,
        "src": "98:40:6",
        "symbolAliases": [
          {
            "foreign": 2473,
            "local": null
          }
        ],
        "unitAlias": ""
      },
      {
        "absolutePath": "/Users/liamz/go/src/github.com/keep-network/tbtc/implementation/contracts/bitcoin-spv/BTCUtils.sol",
        "file": "./BTCUtils.sol",
        "id": 2476,
        "nodeType": "ImportDirective",
        "scope": 2738,
        "sourceUnit": 1607,
        "src": "139:40:6",
        "symbolAliases": [
          {
            "foreign": 2475,
            "local": null
          }
        ],
        "unitAlias": ""
      },
      {
        "baseContracts": [],
        "contractDependencies": [],
        "contractKind": "library",
        "documentation": null,
        "fullyImplemented": true,
        "id": 2737,
        "linearizedBaseContracts": [
          2737
        ],
        "name": "CheckBitcoinSigs",
        "nodeType": "ContractDefinition",
        "nodes": [
          {
            "id": 2479,
            "libraryName": {
              "contractScope": null,
              "id": 2477,
              "name": "BytesLib",
              "nodeType": "UserDefinedTypeName",
              "referencedDeclaration": 1774,
              "src": "220:8:6",
              "typeDescriptions": {
                "typeIdentifier": "t_contract$_BytesLib_$1774",
                "typeString": "library BytesLib"
              }
            },
            "nodeType": "UsingForDirective",
            "src": "214:25:6",
            "typeName": {
              "id": 2478,
              "name": "bytes",
              "nodeType": "ElementaryTypeName",
              "src": "233:5:6",
              "typeDescriptions": {
                "typeIdentifier": "t_bytes_storage_ptr",
                "typeString": "bytes"
              }
            }
          },
          {
            "id": 2482,
            "libraryName": {
              "contractScope": null,
              "id": 2480,
              "name": "BTCUtils",
              "nodeType": "UserDefinedTypeName",
              "referencedDeclaration": 1606,
              "src": "250:8:6",
              "typeDescriptions": {
                "typeIdentifier": "t_contract$_BTCUtils_$1606",
                "typeString": "library BTCUtils"
              }
            },
            "nodeType": "UsingForDirective",
            "src": "244:25:6",
            "typeName": {
              "id": 2481,
              "name": "bytes",
              "nodeType": "ElementaryTypeName",
              "src": "263:5:6",
              "typeDescriptions": {
                "typeIdentifier": "t_bytes_storage_ptr",
                "typeString": "bytes"
              }
            }
          },
          {
            "body": {
              "id": 2513,
              "nodeType": "Block",
              "src": "597:246:6",
              "statements": [
                {
                  "expression": {
                    "argumentTypes": null,
                    "arguments": [
                      {
                        "argumentTypes": null,
                        "commonType": {
                          "typeIdentifier": "t_uint256",
                          "typeString": "uint256"
                        },
                        "id": 2493,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": false,
                        "lValueRequested": false,
                        "leftExpression": {
                          "argumentTypes": null,
                          "expression": {
                            "argumentTypes": null,
                            "id": 2490,
                            "name": "_pubkey",
                            "nodeType": "Identifier",
                            "overloadedDeclarations": [],
                            "referencedDeclaration": 2484,
                            "src": "615:7:6",
                            "typeDescriptions": {
                              "typeIdentifier": "t_bytes_memory_ptr",
                              "typeString": "bytes memory"
                            }
                          },
                          "id": 2491,
                          "isConstant": false,
                          "isLValue": false,
                          "isPure": false,
                          "lValueRequested": false,
                          "memberName": "length",
                          "nodeType": "MemberAccess",
                          "referencedDeclaration": null,
                          "src": "615:14:6",
                          "typeDescriptions": {
                            "typeIdentifier": "t_uint256",
                            "typeString": "uint256"
                          }
                        },
                        "nodeType": "BinaryOperation",
                        "operator": "==",
                        "rightExpression": {
                          "argumentTypes": null,
                          "hexValue": "3634",
                          "id": 2492,
                          "isConstant": false,
                          "isLValue": false,
                          "isPure": true,
                          "kind": "number",
                          "lValueRequested": false,
                          "nodeType": "Literal",
                          "src": "633:2:6",
                          "subdenomination": null,
                          "typeDescriptions": {
                            "typeIdentifier": "t_rational_64_by_1",
                            "typeString": "int_const 64"
                          },
                          "value": "64"
                        },
                        "src": "615:20:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bool",
                          "typeString": "bool"
                        }
                      }
                    ],
                    "expression": {
                      "argumentTypes": [
                        {
                          "typeIdentifier": "t_bool",
                          "typeString": "bool"
                        }
                      ],
                      "id": 2489,
                      "name": "require",
                      "nodeType": "Identifier",
                      "overloadedDeclarations": [
                        10519,
                        10520
                      ],
                      "referencedDeclaration": 10519,
                      "src": "607:7:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_function_require_pure$_t_bool_$returns$__$",
                        "typeString": "function (bool) pure"
                      }
                    },
                    "id": 2494,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "kind": "functionCall",
                    "lValueRequested": false,
                    "names": [],
                    "nodeType": "FunctionCall",
                    "src": "607:29:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_tuple$__$",
                      "typeString": "tuple()"
                    }
                  },
                  "id": 2495,
                  "nodeType": "ExpressionStatement",
                  "src": "607:29:6"
                },
                {
                  "assignments": [
                    2497
                  ],
                  "declarations": [
                    {
                      "constant": false,
                      "id": 2497,
                      "name": "_digest",
                      "nodeType": "VariableDeclaration",
                      "scope": 2514,
                      "src": "704:20:6",
                      "stateVariable": false,
                      "storageLocation": "memory",
                      "typeDescriptions": {
                        "typeIdentifier": "t_bytes_memory_ptr",
                        "typeString": "bytes"
                      },
                      "typeName": {
                        "id": 2496,
                        "name": "bytes",
                        "nodeType": "ElementaryTypeName",
                        "src": "704:5:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_storage_ptr",
                          "typeString": "bytes"
                        }
                      },
                      "value": null,
                      "visibility": "internal"
                    }
                  ],
                  "id": 2504,
                  "initialValue": {
                    "argumentTypes": null,
                    "arguments": [
                      {
                        "argumentTypes": null,
                        "arguments": [
                          {
                            "argumentTypes": null,
                            "id": 2501,
                            "name": "_pubkey",
                            "nodeType": "Identifier",
                            "overloadedDeclarations": [],
                            "referencedDeclaration": 2484,
                            "src": "754:7:6",
                            "typeDescriptions": {
                              "typeIdentifier": "t_bytes_memory_ptr",
                              "typeString": "bytes memory"
                            }
                          }
                        ],
                        "expression": {
                          "argumentTypes": [
                            {
                              "typeIdentifier": "t_bytes_memory_ptr",
                              "typeString": "bytes memory"
                            }
                          ],
                          "id": 2500,
                          "name": "keccak256",
                          "nodeType": "Identifier",
                          "overloadedDeclarations": [],
                          "referencedDeclaration": 10510,
                          "src": "744:9:6",
                          "typeDescriptions": {
                            "typeIdentifier": "t_function_sha3_pure$__$returns$_t_bytes32_$",
                            "typeString": "function () pure returns (bytes32)"
                          }
                        },
                        "id": 2502,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": false,
                        "kind": "functionCall",
                        "lValueRequested": false,
                        "names": [],
                        "nodeType": "FunctionCall",
                        "src": "744:18:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        }
                      }
                    ],
                    "expression": {
                      "argumentTypes": [
                        {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        }
                      ],
                      "expression": {
                        "argumentTypes": null,
                        "id": 2498,
                        "name": "abi",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 10503,
                        "src": "727:3:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_magic_abi",
                          "typeString": "abi"
                        }
                      },
                      "id": 2499,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": true,
                      "lValueRequested": false,
                      "memberName": "encodePacked",
                      "nodeType": "MemberAccess",
                      "referencedDeclaration": null,
                      "src": "727:16:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_function_abiencodepacked_pure$__$returns$_t_bytes_memory_ptr_$",
                        "typeString": "function () pure returns (bytes memory)"
                      }
                    },
                    "id": 2503,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "kind": "functionCall",
                    "lValueRequested": false,
                    "names": [],
                    "nodeType": "FunctionCall",
                    "src": "727:36:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_memory_ptr",
                      "typeString": "bytes memory"
                    }
                  },
                  "nodeType": "VariableDeclarationStatement",
                  "src": "704:59:6"
                },
                {
                  "expression": {
                    "argumentTypes": null,
                    "arguments": [
                      {
                        "argumentTypes": null,
                        "commonType": {
                          "typeIdentifier": "t_uint256",
                          "typeString": "uint256"
                        },
                        "id": 2510,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": false,
                        "lValueRequested": false,
                        "leftExpression": {
                          "argumentTypes": null,
                          "expression": {
                            "argumentTypes": null,
                            "id": 2507,
                            "name": "_digest",
                            "nodeType": "Identifier",
                            "overloadedDeclarations": [],
                            "referencedDeclaration": 2497,
                            "src": "798:7:6",
                            "typeDescriptions": {
                              "typeIdentifier": "t_bytes_memory_ptr",
                              "typeString": "bytes memory"
                            }
                          },
                          "id": 2508,
                          "isConstant": false,
                          "isLValue": false,
                          "isPure": false,
                          "lValueRequested": false,
                          "memberName": "length",
                          "nodeType": "MemberAccess",
                          "referencedDeclaration": null,
                          "src": "798:14:6",
                          "typeDescriptions": {
                            "typeIdentifier": "t_uint256",
                            "typeString": "uint256"
                          }
                        },
                        "nodeType": "BinaryOperation",
                        "operator": "-",
                        "rightExpression": {
                          "argumentTypes": null,
                          "hexValue": "3230",
                          "id": 2509,
                          "isConstant": false,
                          "isLValue": false,
                          "isPure": true,
                          "kind": "number",
                          "lValueRequested": false,
                          "nodeType": "Literal",
                          "src": "815:2:6",
                          "subdenomination": null,
                          "typeDescriptions": {
                            "typeIdentifier": "t_rational_20_by_1",
                            "typeString": "int_const 20"
                          },
                          "value": "20"
                        },
                        "src": "798:19:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_uint256",
                          "typeString": "uint256"
                        }
                      }
                    ],
                    "expression": {
                      "argumentTypes": [
                        {
                          "typeIdentifier": "t_uint256",
                          "typeString": "uint256"
                        }
                      ],
                      "expression": {
                        "argumentTypes": null,
                        "id": 2505,
                        "name": "_digest",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2497,
                        "src": "780:7:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        }
                      },
                      "id": 2506,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": false,
                      "lValueRequested": false,
                      "memberName": "toAddress",
                      "nodeType": "MemberAccess",
                      "referencedDeclaration": 1689,
                      "src": "780:17:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_function_internal_pure$_t_bytes_memory_ptr_$_t_uint256_$returns$_t_address_$bound_to$_t_bytes_memory_ptr_$",
                        "typeString": "function (bytes memory,uint256) pure returns (address)"
                      }
                    },
                    "id": 2511,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "kind": "functionCall",
                    "lValueRequested": false,
                    "names": [],
                    "nodeType": "FunctionCall",
                    "src": "780:38:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_address",
                      "typeString": "address"
                    }
                  },
                  "functionReturnParameters": 2488,
                  "id": 2512,
                  "nodeType": "Return",
                  "src": "773:45:6"
                }
              ]
            },
            "documentation": "@notice          derives an Ethereum Account address from a pubkey\n @dev             the address is the last 20 bytes of the keccak256 of the address\n @param _pubkey   the public key\n @return          the account address",
            "id": 2514,
            "implemented": true,
            "isConstructor": false,
            "isDeclaredConst": true,
            "modifiers": [],
            "name": "accountFromPubkey",
            "nodeType": "FunctionDefinition",
            "parameters": {
              "id": 2485,
              "nodeType": "ParameterList",
              "parameters": [
                {
                  "constant": false,
                  "id": 2484,
                  "name": "_pubkey",
                  "nodeType": "VariableDeclaration",
                  "scope": 2514,
                  "src": "552:13:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes_memory_ptr",
                    "typeString": "bytes"
                  },
                  "typeName": {
                    "id": 2483,
                    "name": "bytes",
                    "nodeType": "ElementaryTypeName",
                    "src": "552:5:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_storage_ptr",
                      "typeString": "bytes"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                }
              ],
              "src": "551:15:6"
            },
            "payable": false,
            "returnParameters": {
              "id": 2488,
              "nodeType": "ParameterList",
              "parameters": [
                {
                  "constant": false,
                  "id": 2487,
                  "name": "",
                  "nodeType": "VariableDeclaration",
                  "scope": 2514,
                  "src": "588:7:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_address",
                    "typeString": "address"
                  },
                  "typeName": {
                    "id": 2486,
                    "name": "address",
                    "nodeType": "ElementaryTypeName",
                    "src": "588:7:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_address",
                      "typeString": "address"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                }
              ],
              "src": "587:9:6"
            },
            "scope": 2737,
            "src": "525:318:6",
            "stateMutability": "pure",
            "superFunction": null,
            "visibility": "public"
          },
          {
            "body": {
              "id": 2554,
              "nodeType": "Block",
              "src": "1167:288:6",
              "statements": [
                {
                  "condition": {
                    "argumentTypes": null,
                    "commonType": {
                      "typeIdentifier": "t_uint256",
                      "typeString": "uint256"
                    },
                    "id": 2524,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "lValueRequested": false,
                    "leftExpression": {
                      "argumentTypes": null,
                      "expression": {
                        "argumentTypes": null,
                        "id": 2521,
                        "name": "_pubkey",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2516,
                        "src": "1181:7:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        }
                      },
                      "id": 2522,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": false,
                      "lValueRequested": false,
                      "memberName": "length",
                      "nodeType": "MemberAccess",
                      "referencedDeclaration": null,
                      "src": "1181:14:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_uint256",
                        "typeString": "uint256"
                      }
                    },
                    "nodeType": "BinaryOperation",
                    "operator": "==",
                    "rightExpression": {
                      "argumentTypes": null,
                      "hexValue": "3634",
                      "id": 2523,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": true,
                      "kind": "number",
                      "lValueRequested": false,
                      "nodeType": "Literal",
                      "src": "1199:2:6",
                      "subdenomination": null,
                      "typeDescriptions": {
                        "typeIdentifier": "t_rational_64_by_1",
                        "typeString": "int_const 64"
                      },
                      "value": "64"
                    },
                    "src": "1181:20:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bool",
                      "typeString": "bool"
                    }
                  },
                  "falseBody": null,
                  "id": 2534,
                  "nodeType": "IfStatement",
                  "src": "1177:95:6",
                  "trueBody": {
                    "id": 2533,
                    "nodeType": "Block",
                    "src": "1203:69:6",
                    "statements": [
                      {
                        "expression": {
                          "argumentTypes": null,
                          "id": 2531,
                          "isConstant": false,
                          "isLValue": false,
                          "isPure": false,
                          "lValueRequested": false,
                          "leftHandSide": {
                            "argumentTypes": null,
                            "id": 2525,
                            "name": "_pubkey",
                            "nodeType": "Identifier",
                            "overloadedDeclarations": [],
                            "referencedDeclaration": 2516,
                            "src": "1217:7:6",
                            "typeDescriptions": {
                              "typeIdentifier": "t_bytes_memory_ptr",
                              "typeString": "bytes memory"
                            }
                          },
                          "nodeType": "Assignment",
                          "operator": "=",
                          "rightHandSide": {
                            "argumentTypes": null,
                            "arguments": [
                              {
                                "argumentTypes": null,
                                "hexValue": "04",
                                "id": 2528,
                                "isConstant": false,
                                "isLValue": false,
                                "isPure": true,
                                "kind": "string",
                                "lValueRequested": false,
                                "nodeType": "Literal",
                                "src": "1244:7:6",
                                "subdenomination": null,
                                "typeDescriptions": {
                                  "typeIdentifier": "t_stringliteral_f343681465b9efe82c933c3e8748c70cb8aa06539c361de20f72eac04e766393",
                                  "typeString": "literal_string \"\u0004\""
                                },
                                "value": "\u0004"
                              },
                              {
                                "argumentTypes": null,
                                "id": 2529,
                                "name": "_pubkey",
                                "nodeType": "Identifier",
                                "overloadedDeclarations": [],
                                "referencedDeclaration": 2516,
                                "src": "1253:7:6",
                                "typeDescriptions": {
                                  "typeIdentifier": "t_bytes_memory_ptr",
                                  "typeString": "bytes memory"
                                }
                              }
                            ],
                            "expression": {
                              "argumentTypes": [
                                {
                                  "typeIdentifier": "t_stringliteral_f343681465b9efe82c933c3e8748c70cb8aa06539c361de20f72eac04e766393",
                                  "typeString": "literal_string \"\u0004\""
                                },
                                {
                                  "typeIdentifier": "t_bytes_memory_ptr",
                                  "typeString": "bytes memory"
                                }
                              ],
                              "expression": {
                                "argumentTypes": null,
                                "id": 2526,
                                "name": "abi",
                                "nodeType": "Identifier",
                                "overloadedDeclarations": [],
                                "referencedDeclaration": 10503,
                                "src": "1227:3:6",
                                "typeDescriptions": {
                                  "typeIdentifier": "t_magic_abi",
                                  "typeString": "abi"
                                }
                              },
                              "id": 2527,
                              "isConstant": false,
                              "isLValue": false,
                              "isPure": true,
                              "lValueRequested": false,
                              "memberName": "encodePacked",
                              "nodeType": "MemberAccess",
                              "referencedDeclaration": null,
                              "src": "1227:16:6",
                              "typeDescriptions": {
                                "typeIdentifier": "t_function_abiencodepacked_pure$__$returns$_t_bytes_memory_ptr_$",
                                "typeString": "function () pure returns (bytes memory)"
                              }
                            },
                            "id": 2530,
                            "isConstant": false,
                            "isLValue": false,
                            "isPure": false,
                            "kind": "functionCall",
                            "lValueRequested": false,
                            "names": [],
                            "nodeType": "FunctionCall",
                            "src": "1227:34:6",
                            "typeDescriptions": {
                              "typeIdentifier": "t_bytes_memory_ptr",
                              "typeString": "bytes memory"
                            }
                          },
                          "src": "1217:44:6",
                          "typeDescriptions": {
                            "typeIdentifier": "t_bytes_memory_ptr",
                            "typeString": "bytes memory"
                          }
                        },
                        "id": 2532,
                        "nodeType": "ExpressionStatement",
                        "src": "1217:44:6"
                      }
                    ]
                  }
                },
                {
                  "expression": {
                    "argumentTypes": null,
                    "arguments": [
                      {
                        "argumentTypes": null,
                        "commonType": {
                          "typeIdentifier": "t_uint256",
                          "typeString": "uint256"
                        },
                        "id": 2539,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": false,
                        "lValueRequested": false,
                        "leftExpression": {
                          "argumentTypes": null,
                          "expression": {
                            "argumentTypes": null,
                            "id": 2536,
                            "name": "_pubkey",
                            "nodeType": "Identifier",
                            "overloadedDeclarations": [],
                            "referencedDeclaration": 2516,
                            "src": "1289:7:6",
                            "typeDescriptions": {
                              "typeIdentifier": "t_bytes_memory_ptr",
                              "typeString": "bytes memory"
                            }
                          },
                          "id": 2537,
                          "isConstant": false,
                          "isLValue": false,
                          "isPure": false,
                          "lValueRequested": false,
                          "memberName": "length",
                          "nodeType": "MemberAccess",
                          "referencedDeclaration": null,
                          "src": "1289:14:6",
                          "typeDescriptions": {
                            "typeIdentifier": "t_uint256",
                            "typeString": "uint256"
                          }
                        },
                        "nodeType": "BinaryOperation",
                        "operator": "==",
                        "rightExpression": {
                          "argumentTypes": null,
                          "hexValue": "3635",
                          "id": 2538,
                          "isConstant": false,
                          "isLValue": false,
                          "isPure": true,
                          "kind": "number",
                          "lValueRequested": false,
                          "nodeType": "Literal",
                          "src": "1307:2:6",
                          "subdenomination": null,
                          "typeDescriptions": {
                            "typeIdentifier": "t_rational_65_by_1",
                            "typeString": "int_const 65"
                          },
                          "value": "65"
                        },
                        "src": "1289:20:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bool",
                          "typeString": "bool"
                        }
                      }
                    ],
                    "expression": {
                      "argumentTypes": [
                        {
                          "typeIdentifier": "t_bool",
                          "typeString": "bool"
                        }
                      ],
                      "id": 2535,
                      "name": "require",
                      "nodeType": "Identifier",
                      "overloadedDeclarations": [
                        10519,
                        10520
                      ],
                      "referencedDeclaration": 10519,
                      "src": "1281:7:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_function_require_pure$_t_bool_$returns$__$",
                        "typeString": "function (bool) pure"
                      }
                    },
                    "id": 2540,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "kind": "functionCall",
                    "lValueRequested": false,
                    "names": [],
                    "nodeType": "FunctionCall",
                    "src": "1281:29:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_tuple$__$",
                      "typeString": "tuple()"
                    }
                  },
                  "id": 2541,
                  "nodeType": "ExpressionStatement",
                  "src": "1281:29:6"
                },
                {
                  "assignments": [
                    2543
                  ],
                  "declarations": [
                    {
                      "constant": false,
                      "id": 2543,
                      "name": "_pubkeyHash",
                      "nodeType": "VariableDeclaration",
                      "scope": 2555,
                      "src": "1347:24:6",
                      "stateVariable": false,
                      "storageLocation": "memory",
                      "typeDescriptions": {
                        "typeIdentifier": "t_bytes_memory_ptr",
                        "typeString": "bytes"
                      },
                      "typeName": {
                        "id": 2542,
                        "name": "bytes",
                        "nodeType": "ElementaryTypeName",
                        "src": "1347:5:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_storage_ptr",
                          "typeString": "bytes"
                        }
                      },
                      "value": null,
                      "visibility": "internal"
                    }
                  ],
                  "id": 2547,
                  "initialValue": {
                    "argumentTypes": null,
                    "arguments": [],
                    "expression": {
                      "argumentTypes": [],
                      "expression": {
                        "argumentTypes": null,
                        "id": 2544,
                        "name": "_pubkey",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2516,
                        "src": "1374:7:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        }
                      },
                      "id": 2545,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": false,
                      "lValueRequested": false,
                      "memberName": "hash160",
                      "nodeType": "MemberAccess",
                      "referencedDeclaration": 657,
                      "src": "1374:15:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_function_delegatecall_pure$_t_bytes_memory_ptr_$returns$_t_bytes_memory_ptr_$bound_to$_t_bytes_memory_ptr_$",
                        "typeString": "function (bytes memory) pure returns (bytes memory)"
                      }
                    },
                    "id": 2546,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "kind": "functionCall",
                    "lValueRequested": false,
                    "names": [],
                    "nodeType": "FunctionCall",
                    "src": "1374:17:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_memory_ptr",
                      "typeString": "bytes memory"
                    }
                  },
                  "nodeType": "VariableDeclarationStatement",
                  "src": "1347:44:6"
                },
                {
                  "expression": {
                    "argumentTypes": null,
                    "arguments": [
                      {
                        "argumentTypes": null,
                        "hexValue": "0014",
                        "id": 2550,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": true,
                        "kind": "string",
                        "lValueRequested": false,
                        "nodeType": "Literal",
                        "src": "1425:9:6",
                        "subdenomination": null,
                        "typeDescriptions": {
                          "typeIdentifier": "t_stringliteral_8c9fd6988effdf130d07ed4911a231819d049b576b0676ca29490d955c0caa21",
                          "typeString": "literal_string \"\u0000\u0014\""
                        },
                        "value": "\u0000\u0014"
                      },
                      {
                        "argumentTypes": null,
                        "id": 2551,
                        "name": "_pubkeyHash",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2543,
                        "src": "1436:11:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        }
                      }
                    ],
                    "expression": {
                      "argumentTypes": [
                        {
                          "typeIdentifier": "t_stringliteral_8c9fd6988effdf130d07ed4911a231819d049b576b0676ca29490d955c0caa21",
                          "typeString": "literal_string \"\u0000\u0014\""
                        },
                        {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        }
                      ],
                      "expression": {
                        "argumentTypes": null,
                        "id": 2548,
                        "name": "abi",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 10503,
                        "src": "1408:3:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_magic_abi",
                          "typeString": "abi"
                        }
                      },
                      "id": 2549,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": true,
                      "lValueRequested": false,
                      "memberName": "encodePacked",
                      "nodeType": "MemberAccess",
                      "referencedDeclaration": null,
                      "src": "1408:16:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_function_abiencodepacked_pure$__$returns$_t_bytes_memory_ptr_$",
                        "typeString": "function () pure returns (bytes memory)"
                      }
                    },
                    "id": 2552,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "kind": "functionCall",
                    "lValueRequested": false,
                    "names": [],
                    "nodeType": "FunctionCall",
                    "src": "1408:40:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_memory_ptr",
                      "typeString": "bytes memory"
                    }
                  },
                  "functionReturnParameters": 2520,
                  "id": 2553,
                  "nodeType": "Return",
                  "src": "1401:47:6"
                }
              ]
            },
            "documentation": "@notice          calculates the p2wpkh output script of a pubkey\n @dev             pads uncompressed pubkeys to 65 bytes as required by Bitcoin\n @param _pubkey   the public key\n @return          the p2wkph output script",
            "id": 2555,
            "implemented": true,
            "isConstructor": false,
            "isDeclaredConst": true,
            "modifiers": [],
            "name": "p2wpkhFromPubkey",
            "nodeType": "FunctionDefinition",
            "parameters": {
              "id": 2517,
              "nodeType": "ParameterList",
              "parameters": [
                {
                  "constant": false,
                  "id": 2516,
                  "name": "_pubkey",
                  "nodeType": "VariableDeclaration",
                  "scope": 2555,
                  "src": "1124:13:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes_memory_ptr",
                    "typeString": "bytes"
                  },
                  "typeName": {
                    "id": 2515,
                    "name": "bytes",
                    "nodeType": "ElementaryTypeName",
                    "src": "1124:5:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_storage_ptr",
                      "typeString": "bytes"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                }
              ],
              "src": "1123:15:6"
            },
            "payable": false,
            "returnParameters": {
              "id": 2520,
              "nodeType": "ParameterList",
              "parameters": [
                {
                  "constant": false,
                  "id": 2519,
                  "name": "",
                  "nodeType": "VariableDeclaration",
                  "scope": 2555,
                  "src": "1160:5:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes_memory_ptr",
                    "typeString": "bytes"
                  },
                  "typeName": {
                    "id": 2518,
                    "name": "bytes",
                    "nodeType": "ElementaryTypeName",
                    "src": "1160:5:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_storage_ptr",
                      "typeString": "bytes"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                }
              ],
              "src": "1159:7:6"
            },
            "scope": 2737,
            "src": "1098:357:6",
            "stateMutability": "pure",
            "superFunction": null,
            "visibility": "public"
          },
          {
            "body": {
              "id": 2589,
              "nodeType": "Block",
              "src": "2096:158:6",
              "statements": [
                {
                  "assignments": [
                    2571
                  ],
                  "declarations": [
                    {
                      "constant": false,
                      "id": 2571,
                      "name": "_expected",
                      "nodeType": "VariableDeclaration",
                      "scope": 2590,
                      "src": "2106:17:6",
                      "stateVariable": false,
                      "storageLocation": "default",
                      "typeDescriptions": {
                        "typeIdentifier": "t_address",
                        "typeString": "address"
                      },
                      "typeName": {
                        "id": 2570,
                        "name": "address",
                        "nodeType": "ElementaryTypeName",
                        "src": "2106:7:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_address",
                          "typeString": "address"
                        }
                      },
                      "value": null,
                      "visibility": "internal"
                    }
                  ],
                  "id": 2575,
                  "initialValue": {
                    "argumentTypes": null,
                    "arguments": [
                      {
                        "argumentTypes": null,
                        "id": 2573,
                        "name": "_pubkey",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2557,
                        "src": "2144:7:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        }
                      }
                    ],
                    "expression": {
                      "argumentTypes": [
                        {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        }
                      ],
                      "id": 2572,
                      "name": "accountFromPubkey",
                      "nodeType": "Identifier",
                      "overloadedDeclarations": [],
                      "referencedDeclaration": 2514,
                      "src": "2126:17:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_function_internal_pure$_t_bytes_memory_ptr_$returns$_t_address_$",
                        "typeString": "function (bytes memory) pure returns (address)"
                      }
                    },
                    "id": 2574,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "kind": "functionCall",
                    "lValueRequested": false,
                    "names": [],
                    "nodeType": "FunctionCall",
                    "src": "2126:26:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_address",
                      "typeString": "address"
                    }
                  },
                  "nodeType": "VariableDeclarationStatement",
                  "src": "2106:46:6"
                },
                {
                  "assignments": [
                    2577
                  ],
                  "declarations": [
                    {
                      "constant": false,
                      "id": 2577,
                      "name": "_actual",
                      "nodeType": "VariableDeclaration",
                      "scope": 2590,
                      "src": "2162:15:6",
                      "stateVariable": false,
                      "storageLocation": "default",
                      "typeDescriptions": {
                        "typeIdentifier": "t_address",
                        "typeString": "address"
                      },
                      "typeName": {
                        "id": 2576,
                        "name": "address",
                        "nodeType": "ElementaryTypeName",
                        "src": "2162:7:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_address",
                          "typeString": "address"
                        }
                      },
                      "value": null,
                      "visibility": "internal"
                    }
                  ],
                  "id": 2584,
                  "initialValue": {
                    "argumentTypes": null,
                    "arguments": [
                      {
                        "argumentTypes": null,
                        "id": 2579,
                        "name": "_digest",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2559,
                        "src": "2190:7:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        }
                      },
                      {
                        "argumentTypes": null,
                        "id": 2580,
                        "name": "_v",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2561,
                        "src": "2199:2:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_uint8",
                          "typeString": "uint8"
                        }
                      },
                      {
                        "argumentTypes": null,
                        "id": 2581,
                        "name": "_r",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2563,
                        "src": "2203:2:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        }
                      },
                      {
                        "argumentTypes": null,
                        "id": 2582,
                        "name": "_s",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2565,
                        "src": "2207:2:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        }
                      }
                    ],
                    "expression": {
                      "argumentTypes": [
                        {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        },
                        {
                          "typeIdentifier": "t_uint8",
                          "typeString": "uint8"
                        },
                        {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        },
                        {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        }
                      ],
                      "id": 2578,
                      "name": "ecrecover",
                      "nodeType": "Identifier",
                      "overloadedDeclarations": [],
                      "referencedDeclaration": 10508,
                      "src": "2180:9:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_function_ecrecover_pure$_t_bytes32_$_t_uint8_$_t_bytes32_$_t_bytes32_$returns$_t_address_$",
                        "typeString": "function (bytes32,uint8,bytes32,bytes32) pure returns (address)"
                      }
                    },
                    "id": 2583,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "kind": "functionCall",
                    "lValueRequested": false,
                    "names": [],
                    "nodeType": "FunctionCall",
                    "src": "2180:30:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_address",
                      "typeString": "address"
                    }
                  },
                  "nodeType": "VariableDeclarationStatement",
                  "src": "2162:48:6"
                },
                {
                  "expression": {
                    "argumentTypes": null,
                    "commonType": {
                      "typeIdentifier": "t_address",
                      "typeString": "address"
                    },
                    "id": 2587,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "lValueRequested": false,
                    "leftExpression": {
                      "argumentTypes": null,
                      "id": 2585,
                      "name": "_actual",
                      "nodeType": "Identifier",
                      "overloadedDeclarations": [],
                      "referencedDeclaration": 2577,
                      "src": "2227:7:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_address",
                        "typeString": "address"
                      }
                    },
                    "nodeType": "BinaryOperation",
                    "operator": "==",
                    "rightExpression": {
                      "argumentTypes": null,
                      "id": 2586,
                      "name": "_expected",
                      "nodeType": "Identifier",
                      "overloadedDeclarations": [],
                      "referencedDeclaration": 2571,
                      "src": "2238:9:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_address",
                        "typeString": "address"
                      }
                    },
                    "src": "2227:20:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bool",
                      "typeString": "bool"
                    }
                  },
                  "functionReturnParameters": 2569,
                  "id": 2588,
                  "nodeType": "Return",
                  "src": "2220:27:6"
                }
              ]
            },
            "documentation": "@notice          checks a signed message's validity under a pubkey\n @dev             does this using ecrecover because Ethereum has no soul\n @param _pubkey   the public key to check (64 bytes)\n @param _digest   the message digest signed\n @param _v        the signature recovery value\n @param _r        the signature r value\n @param _s        the signature s value\n @return          true if signature is valid, else false",
            "id": 2590,
            "implemented": true,
            "isConstructor": false,
            "isDeclaredConst": true,
            "modifiers": [],
            "name": "checkSig",
            "nodeType": "FunctionDefinition",
            "parameters": {
              "id": 2566,
              "nodeType": "ParameterList",
              "parameters": [
                {
                  "constant": false,
                  "id": 2557,
                  "name": "_pubkey",
                  "nodeType": "VariableDeclaration",
                  "scope": 2590,
                  "src": "1966:13:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes_memory_ptr",
                    "typeString": "bytes"
                  },
                  "typeName": {
                    "id": 2556,
                    "name": "bytes",
                    "nodeType": "ElementaryTypeName",
                    "src": "1966:5:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_storage_ptr",
                      "typeString": "bytes"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2559,
                  "name": "_digest",
                  "nodeType": "VariableDeclaration",
                  "scope": 2590,
                  "src": "1989:15:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes32",
                    "typeString": "bytes32"
                  },
                  "typeName": {
                    "id": 2558,
                    "name": "bytes32",
                    "nodeType": "ElementaryTypeName",
                    "src": "1989:7:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes32",
                      "typeString": "bytes32"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2561,
                  "name": "_v",
                  "nodeType": "VariableDeclaration",
                  "scope": 2590,
                  "src": "2014:8:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_uint8",
                    "typeString": "uint8"
                  },
                  "typeName": {
                    "id": 2560,
                    "name": "uint8",
                    "nodeType": "ElementaryTypeName",
                    "src": "2014:5:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_uint8",
                      "typeString": "uint8"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2563,
                  "name": "_r",
                  "nodeType": "VariableDeclaration",
                  "scope": 2590,
                  "src": "2032:10:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes32",
                    "typeString": "bytes32"
                  },
                  "typeName": {
                    "id": 2562,
                    "name": "bytes32",
                    "nodeType": "ElementaryTypeName",
                    "src": "2032:7:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes32",
                      "typeString": "bytes32"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2565,
                  "name": "_s",
                  "nodeType": "VariableDeclaration",
                  "scope": 2590,
                  "src": "2052:10:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes32",
                    "typeString": "bytes32"
                  },
                  "typeName": {
                    "id": 2564,
                    "name": "bytes32",
                    "nodeType": "ElementaryTypeName",
                    "src": "2052:7:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes32",
                      "typeString": "bytes32"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                }
              ],
              "src": "1956:112:6"
            },
            "payable": false,
            "returnParameters": {
              "id": 2569,
              "nodeType": "ParameterList",
              "parameters": [
                {
                  "constant": false,
                  "id": 2568,
                  "name": "",
                  "nodeType": "VariableDeclaration",
                  "scope": 2590,
                  "src": "2090:4:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bool",
                    "typeString": "bool"
                  },
                  "typeName": {
                    "id": 2567,
                    "name": "bool",
                    "nodeType": "ElementaryTypeName",
                    "src": "2090:4:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bool",
                      "typeString": "bool"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                }
              ],
              "src": "2089:6:6"
            },
            "scope": 2737,
            "src": "1939:315:6",
            "stateMutability": "pure",
            "superFunction": null,
            "visibility": "public"
          },
          {
            "body": {
              "id": 2645,
              "nodeType": "Block",
              "src": "3096:374:6",
              "statements": [
                {
                  "assignments": [
                    2608
                  ],
                  "declarations": [
                    {
                      "constant": false,
                      "id": 2608,
                      "name": "_isExpectedSigner",
                      "nodeType": "VariableDeclaration",
                      "scope": 2646,
                      "src": "3106:22:6",
                      "stateVariable": false,
                      "storageLocation": "default",
                      "typeDescriptions": {
                        "typeIdentifier": "t_bool",
                        "typeString": "bool"
                      },
                      "typeName": {
                        "id": 2607,
                        "name": "bool",
                        "nodeType": "ElementaryTypeName",
                        "src": "3106:4:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bool",
                          "typeString": "bool"
                        }
                      },
                      "value": null,
                      "visibility": "internal"
                    }
                  ],
                  "id": 2618,
                  "initialValue": {
                    "argumentTypes": null,
                    "commonType": {
                      "typeIdentifier": "t_bytes32",
                      "typeString": "bytes32"
                    },
                    "id": 2617,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "lValueRequested": false,
                    "leftExpression": {
                      "argumentTypes": null,
                      "arguments": [
                        {
                          "argumentTypes": null,
                          "arguments": [
                            {
                              "argumentTypes": null,
                              "id": 2611,
                              "name": "_pubkey",
                              "nodeType": "Identifier",
                              "overloadedDeclarations": [],
                              "referencedDeclaration": 2594,
                              "src": "3158:7:6",
                              "typeDescriptions": {
                                "typeIdentifier": "t_bytes_memory_ptr",
                                "typeString": "bytes memory"
                              }
                            }
                          ],
                          "expression": {
                            "argumentTypes": [
                              {
                                "typeIdentifier": "t_bytes_memory_ptr",
                                "typeString": "bytes memory"
                              }
                            ],
                            "id": 2610,
                            "name": "p2wpkhFromPubkey",
                            "nodeType": "Identifier",
                            "overloadedDeclarations": [],
                            "referencedDeclaration": 2555,
                            "src": "3141:16:6",
                            "typeDescriptions": {
                              "typeIdentifier": "t_function_internal_pure$_t_bytes_memory_ptr_$returns$_t_bytes_memory_ptr_$",
                              "typeString": "function (bytes memory) pure returns (bytes memory)"
                            }
                          },
                          "id": 2612,
                          "isConstant": false,
                          "isLValue": false,
                          "isPure": false,
                          "kind": "functionCall",
                          "lValueRequested": false,
                          "names": [],
                          "nodeType": "FunctionCall",
                          "src": "3141:25:6",
                          "typeDescriptions": {
                            "typeIdentifier": "t_bytes_memory_ptr",
                            "typeString": "bytes memory"
                          }
                        }
                      ],
                      "expression": {
                        "argumentTypes": [
                          {
                            "typeIdentifier": "t_bytes_memory_ptr",
                            "typeString": "bytes memory"
                          }
                        ],
                        "id": 2609,
                        "name": "keccak256",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 10510,
                        "src": "3131:9:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_function_sha3_pure$__$returns$_t_bytes32_$",
                          "typeString": "function () pure returns (bytes32)"
                        }
                      },
                      "id": 2613,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": false,
                      "kind": "functionCall",
                      "lValueRequested": false,
                      "names": [],
                      "nodeType": "FunctionCall",
                      "src": "3131:36:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_bytes32",
                        "typeString": "bytes32"
                      }
                    },
                    "nodeType": "BinaryOperation",
                    "operator": "==",
                    "rightExpression": {
                      "argumentTypes": null,
                      "arguments": [
                        {
                          "argumentTypes": null,
                          "id": 2615,
                          "name": "_p2wpkhOutputScript",
                          "nodeType": "Identifier",
                          "overloadedDeclarations": [],
                          "referencedDeclaration": 2592,
                          "src": "3181:19:6",
                          "typeDescriptions": {
                            "typeIdentifier": "t_bytes_memory_ptr",
                            "typeString": "bytes memory"
                          }
                        }
                      ],
                      "expression": {
                        "argumentTypes": [
                          {
                            "typeIdentifier": "t_bytes_memory_ptr",
                            "typeString": "bytes memory"
                          }
                        ],
                        "id": 2614,
                        "name": "keccak256",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 10510,
                        "src": "3171:9:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_function_sha3_pure$__$returns$_t_bytes32_$",
                          "typeString": "function () pure returns (bytes32)"
                        }
                      },
                      "id": 2616,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": false,
                      "kind": "functionCall",
                      "lValueRequested": false,
                      "names": [],
                      "nodeType": "FunctionCall",
                      "src": "3171:30:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_bytes32",
                        "typeString": "bytes32"
                      }
                    },
                    "src": "3131:70:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bool",
                      "typeString": "bool"
                    }
                  },
                  "nodeType": "VariableDeclarationStatement",
                  "src": "3106:95:6"
                },
                {
                  "assignments": [
                    2620
                  ],
                  "declarations": [
                    {
                      "constant": false,
                      "id": 2620,
                      "name": "_truncatedPubkey",
                      "nodeType": "VariableDeclaration",
                      "scope": 2646,
                      "src": "3242:29:6",
                      "stateVariable": false,
                      "storageLocation": "memory",
                      "typeDescriptions": {
                        "typeIdentifier": "t_bytes_memory_ptr",
                        "typeString": "bytes"
                      },
                      "typeName": {
                        "id": 2619,
                        "name": "bytes",
                        "nodeType": "ElementaryTypeName",
                        "src": "3242:5:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_storage_ptr",
                          "typeString": "bytes"
                        }
                      },
                      "value": null,
                      "visibility": "internal"
                    }
                  ],
                  "id": 2629,
                  "initialValue": {
                    "argumentTypes": null,
                    "arguments": [
                      {
                        "argumentTypes": null,
                        "hexValue": "31",
                        "id": 2623,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": true,
                        "kind": "number",
                        "lValueRequested": false,
                        "nodeType": "Literal",
                        "src": "3288:1:6",
                        "subdenomination": null,
                        "typeDescriptions": {
                          "typeIdentifier": "t_rational_1_by_1",
                          "typeString": "int_const 1"
                        },
                        "value": "1"
                      },
                      {
                        "argumentTypes": null,
                        "commonType": {
                          "typeIdentifier": "t_uint256",
                          "typeString": "uint256"
                        },
                        "id": 2627,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": false,
                        "lValueRequested": false,
                        "leftExpression": {
                          "argumentTypes": null,
                          "expression": {
                            "argumentTypes": null,
                            "id": 2624,
                            "name": "_pubkey",
                            "nodeType": "Identifier",
                            "overloadedDeclarations": [],
                            "referencedDeclaration": 2594,
                            "src": "3291:7:6",
                            "typeDescriptions": {
                              "typeIdentifier": "t_bytes_memory_ptr",
                              "typeString": "bytes memory"
                            }
                          },
                          "id": 2625,
                          "isConstant": false,
                          "isLValue": false,
                          "isPure": false,
                          "lValueRequested": false,
                          "memberName": "length",
                          "nodeType": "MemberAccess",
                          "referencedDeclaration": null,
                          "src": "3291:14:6",
                          "typeDescriptions": {
                            "typeIdentifier": "t_uint256",
                            "typeString": "uint256"
                          }
                        },
                        "nodeType": "BinaryOperation",
                        "operator": "-",
                        "rightExpression": {
                          "argumentTypes": null,
                          "hexValue": "31",
                          "id": 2626,
                          "isConstant": false,
                          "isLValue": false,
                          "isPure": true,
                          "kind": "number",
                          "lValueRequested": false,
                          "nodeType": "Literal",
                          "src": "3308:1:6",
                          "subdenomination": null,
                          "typeDescriptions": {
                            "typeIdentifier": "t_rational_1_by_1",
                            "typeString": "int_const 1"
                          },
                          "value": "1"
                        },
                        "src": "3291:18:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_uint256",
                          "typeString": "uint256"
                        }
                      }
                    ],
                    "expression": {
                      "argumentTypes": [
                        {
                          "typeIdentifier": "t_rational_1_by_1",
                          "typeString": "int_const 1"
                        },
                        {
                          "typeIdentifier": "t_uint256",
                          "typeString": "uint256"
                        }
                      ],
                      "expression": {
                        "argumentTypes": null,
                        "id": 2621,
                        "name": "_pubkey",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2594,
                        "src": "3274:7:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        }
                      },
                      "id": 2622,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": false,
                      "lValueRequested": false,
                      "memberName": "slice",
                      "nodeType": "MemberAccess",
                      "referencedDeclaration": 1662,
                      "src": "3274:13:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_function_internal_pure$_t_bytes_memory_ptr_$_t_uint256_$_t_uint256_$returns$_t_bytes_memory_ptr_$bound_to$_t_bytes_memory_ptr_$",
                        "typeString": "function (bytes memory,uint256,uint256) pure returns (bytes memory)"
                      }
                    },
                    "id": 2628,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "kind": "functionCall",
                    "lValueRequested": false,
                    "names": [],
                    "nodeType": "FunctionCall",
                    "src": "3274:36:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_memory_ptr",
                      "typeString": "bytes memory"
                    }
                  },
                  "nodeType": "VariableDeclarationStatement",
                  "src": "3242:68:6"
                },
                {
                  "assignments": [
                    2631
                  ],
                  "declarations": [
                    {
                      "constant": false,
                      "id": 2631,
                      "name": "_sigResult",
                      "nodeType": "VariableDeclaration",
                      "scope": 2646,
                      "src": "3348:15:6",
                      "stateVariable": false,
                      "storageLocation": "default",
                      "typeDescriptions": {
                        "typeIdentifier": "t_bool",
                        "typeString": "bool"
                      },
                      "typeName": {
                        "id": 2630,
                        "name": "bool",
                        "nodeType": "ElementaryTypeName",
                        "src": "3348:4:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bool",
                          "typeString": "bool"
                        }
                      },
                      "value": null,
                      "visibility": "internal"
                    }
                  ],
                  "id": 2639,
                  "initialValue": {
                    "argumentTypes": null,
                    "arguments": [
                      {
                        "argumentTypes": null,
                        "id": 2633,
                        "name": "_truncatedPubkey",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2620,
                        "src": "3375:16:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        }
                      },
                      {
                        "argumentTypes": null,
                        "id": 2634,
                        "name": "_digest",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2596,
                        "src": "3393:7:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        }
                      },
                      {
                        "argumentTypes": null,
                        "id": 2635,
                        "name": "_v",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2598,
                        "src": "3402:2:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_uint8",
                          "typeString": "uint8"
                        }
                      },
                      {
                        "argumentTypes": null,
                        "id": 2636,
                        "name": "_r",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2600,
                        "src": "3406:2:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        }
                      },
                      {
                        "argumentTypes": null,
                        "id": 2637,
                        "name": "_s",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2602,
                        "src": "3410:2:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        }
                      }
                    ],
                    "expression": {
                      "argumentTypes": [
                        {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        },
                        {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        },
                        {
                          "typeIdentifier": "t_uint8",
                          "typeString": "uint8"
                        },
                        {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        },
                        {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        }
                      ],
                      "id": 2632,
                      "name": "checkSig",
                      "nodeType": "Identifier",
                      "overloadedDeclarations": [],
                      "referencedDeclaration": 2590,
                      "src": "3366:8:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_function_internal_pure$_t_bytes_memory_ptr_$_t_bytes32_$_t_uint8_$_t_bytes32_$_t_bytes32_$returns$_t_bool_$",
                        "typeString": "function (bytes memory,bytes32,uint8,bytes32,bytes32) pure returns (bool)"
                      }
                    },
                    "id": 2638,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "kind": "functionCall",
                    "lValueRequested": false,
                    "names": [],
                    "nodeType": "FunctionCall",
                    "src": "3366:47:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bool",
                      "typeString": "bool"
                    }
                  },
                  "nodeType": "VariableDeclarationStatement",
                  "src": "3348:65:6"
                },
                {
                  "expression": {
                    "argumentTypes": null,
                    "components": [
                      {
                        "argumentTypes": null,
                        "commonType": {
                          "typeIdentifier": "t_bool",
                          "typeString": "bool"
                        },
                        "id": 2642,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": false,
                        "lValueRequested": false,
                        "leftExpression": {
                          "argumentTypes": null,
                          "id": 2640,
                          "name": "_isExpectedSigner",
                          "nodeType": "Identifier",
                          "overloadedDeclarations": [],
                          "referencedDeclaration": 2608,
                          "src": "3431:17:6",
                          "typeDescriptions": {
                            "typeIdentifier": "t_bool",
                            "typeString": "bool"
                          }
                        },
                        "nodeType": "BinaryOperation",
                        "operator": "&&",
                        "rightExpression": {
                          "argumentTypes": null,
                          "id": 2641,
                          "name": "_sigResult",
                          "nodeType": "Identifier",
                          "overloadedDeclarations": [],
                          "referencedDeclaration": 2631,
                          "src": "3452:10:6",
                          "typeDescriptions": {
                            "typeIdentifier": "t_bool",
                            "typeString": "bool"
                          }
                        },
                        "src": "3431:31:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bool",
                          "typeString": "bool"
                        }
                      }
                    ],
                    "id": 2643,
                    "isConstant": false,
                    "isInlineArray": false,
                    "isLValue": false,
                    "isPure": false,
                    "lValueRequested": false,
                    "nodeType": "TupleExpression",
                    "src": "3430:33:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bool",
                      "typeString": "bool"
                    }
                  },
                  "functionReturnParameters": 2606,
                  "id": 2644,
                  "nodeType": "Return",
                  "src": "3423:40:6"
                }
              ]
            },
            "documentation": "@notice                     checks a signed message against a bitcoin p2wpkh output script\n @dev                        does this my verifying the p2wpkh matches an ethereum account\n @param _p2wpkhOutputScript  the bitcoin output script\n @param _pubkey              the public key to check\n @param _digest              the message digest signed\n @param _v                   the signature recovery value\n @param _r                   the signature r value\n @param _s                   the signature s value\n @return                     true if signature is valid, else false",
            "id": 2646,
            "implemented": true,
            "isConstructor": false,
            "isDeclaredConst": true,
            "modifiers": [],
            "name": "checkBitcoinSig",
            "nodeType": "FunctionDefinition",
            "parameters": {
              "id": 2603,
              "nodeType": "ParameterList",
              "parameters": [
                {
                  "constant": false,
                  "id": 2592,
                  "name": "_p2wpkhOutputScript",
                  "nodeType": "VariableDeclaration",
                  "scope": 2646,
                  "src": "2931:25:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes_memory_ptr",
                    "typeString": "bytes"
                  },
                  "typeName": {
                    "id": 2591,
                    "name": "bytes",
                    "nodeType": "ElementaryTypeName",
                    "src": "2931:5:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_storage_ptr",
                      "typeString": "bytes"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2594,
                  "name": "_pubkey",
                  "nodeType": "VariableDeclaration",
                  "scope": 2646,
                  "src": "2966:13:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes_memory_ptr",
                    "typeString": "bytes"
                  },
                  "typeName": {
                    "id": 2593,
                    "name": "bytes",
                    "nodeType": "ElementaryTypeName",
                    "src": "2966:5:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_storage_ptr",
                      "typeString": "bytes"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2596,
                  "name": "_digest",
                  "nodeType": "VariableDeclaration",
                  "scope": 2646,
                  "src": "2989:15:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes32",
                    "typeString": "bytes32"
                  },
                  "typeName": {
                    "id": 2595,
                    "name": "bytes32",
                    "nodeType": "ElementaryTypeName",
                    "src": "2989:7:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes32",
                      "typeString": "bytes32"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2598,
                  "name": "_v",
                  "nodeType": "VariableDeclaration",
                  "scope": 2646,
                  "src": "3014:8:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_uint8",
                    "typeString": "uint8"
                  },
                  "typeName": {
                    "id": 2597,
                    "name": "uint8",
                    "nodeType": "ElementaryTypeName",
                    "src": "3014:5:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_uint8",
                      "typeString": "uint8"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2600,
                  "name": "_r",
                  "nodeType": "VariableDeclaration",
                  "scope": 2646,
                  "src": "3032:10:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes32",
                    "typeString": "bytes32"
                  },
                  "typeName": {
                    "id": 2599,
                    "name": "bytes32",
                    "nodeType": "ElementaryTypeName",
                    "src": "3032:7:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes32",
                      "typeString": "bytes32"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2602,
                  "name": "_s",
                  "nodeType": "VariableDeclaration",
                  "scope": 2646,
                  "src": "3052:10:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes32",
                    "typeString": "bytes32"
                  },
                  "typeName": {
                    "id": 2601,
                    "name": "bytes32",
                    "nodeType": "ElementaryTypeName",
                    "src": "3052:7:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes32",
                      "typeString": "bytes32"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                }
              ],
              "src": "2921:147:6"
            },
            "payable": false,
            "returnParameters": {
              "id": 2606,
              "nodeType": "ParameterList",
              "parameters": [
                {
                  "constant": false,
                  "id": 2605,
                  "name": "",
                  "nodeType": "VariableDeclaration",
                  "scope": 2646,
                  "src": "3090:4:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bool",
                    "typeString": "bool"
                  },
                  "typeName": {
                    "id": 2604,
                    "name": "bool",
                    "nodeType": "ElementaryTypeName",
                    "src": "3090:4:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bool",
                      "typeString": "bool"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                }
              ],
              "src": "3089:6:6"
            },
            "scope": 2737,
            "src": "2897:573:6",
            "stateMutability": "pure",
            "superFunction": null,
            "visibility": "public"
          },
          {
            "body": {
              "id": 2661,
              "nodeType": "Block",
              "src": "3909:53:6",
              "statements": [
                {
                  "expression": {
                    "argumentTypes": null,
                    "commonType": {
                      "typeIdentifier": "t_bytes32",
                      "typeString": "bytes32"
                    },
                    "id": 2659,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "lValueRequested": false,
                    "leftExpression": {
                      "argumentTypes": null,
                      "arguments": [
                        {
                          "argumentTypes": null,
                          "id": 2656,
                          "name": "_candidate",
                          "nodeType": "Identifier",
                          "overloadedDeclarations": [],
                          "referencedDeclaration": 2648,
                          "src": "3933:10:6",
                          "typeDescriptions": {
                            "typeIdentifier": "t_bytes_memory_ptr",
                            "typeString": "bytes memory"
                          }
                        }
                      ],
                      "expression": {
                        "argumentTypes": [
                          {
                            "typeIdentifier": "t_bytes_memory_ptr",
                            "typeString": "bytes memory"
                          }
                        ],
                        "id": 2655,
                        "name": "sha256",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 10525,
                        "src": "3926:6:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_function_sha256_pure$__$returns$_t_bytes32_$",
                          "typeString": "function () pure returns (bytes32)"
                        }
                      },
                      "id": 2657,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": false,
                      "kind": "functionCall",
                      "lValueRequested": false,
                      "names": [],
                      "nodeType": "FunctionCall",
                      "src": "3926:18:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_bytes32",
                        "typeString": "bytes32"
                      }
                    },
                    "nodeType": "BinaryOperation",
                    "operator": "==",
                    "rightExpression": {
                      "argumentTypes": null,
                      "id": 2658,
                      "name": "_digest",
                      "nodeType": "Identifier",
                      "overloadedDeclarations": [],
                      "referencedDeclaration": 2650,
                      "src": "3948:7:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_bytes32",
                        "typeString": "bytes32"
                      }
                    },
                    "src": "3926:29:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bool",
                      "typeString": "bool"
                    }
                  },
                  "functionReturnParameters": 2654,
                  "id": 2660,
                  "nodeType": "Return",
                  "src": "3919:36:6"
                }
              ]
            },
            "documentation": "@notice             checks if a message is the sha256 preimage of a digest\n @dev                this is NOT the hash256!  this step is necessary for ECDSA security!\n @param _digest      the digest\n @param _candidate   the purported preimage\n @return             the p2wkph output script",
            "id": 2662,
            "implemented": true,
            "isConstructor": false,
            "isDeclaredConst": true,
            "modifiers": [],
            "name": "isSha256Preimage",
            "nodeType": "FunctionDefinition",
            "parameters": {
              "id": 2651,
              "nodeType": "ParameterList",
              "parameters": [
                {
                  "constant": false,
                  "id": 2648,
                  "name": "_candidate",
                  "nodeType": "VariableDeclaration",
                  "scope": 2662,
                  "src": "3834:16:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes_memory_ptr",
                    "typeString": "bytes"
                  },
                  "typeName": {
                    "id": 2647,
                    "name": "bytes",
                    "nodeType": "ElementaryTypeName",
                    "src": "3834:5:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_storage_ptr",
                      "typeString": "bytes"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2650,
                  "name": "_digest",
                  "nodeType": "VariableDeclaration",
                  "scope": 2662,
                  "src": "3860:15:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes32",
                    "typeString": "bytes32"
                  },
                  "typeName": {
                    "id": 2649,
                    "name": "bytes32",
                    "nodeType": "ElementaryTypeName",
                    "src": "3860:7:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes32",
                      "typeString": "bytes32"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                }
              ],
              "src": "3824:57:6"
            },
            "payable": false,
            "returnParameters": {
              "id": 2654,
              "nodeType": "ParameterList",
              "parameters": [
                {
                  "constant": false,
                  "id": 2653,
                  "name": "",
                  "nodeType": "VariableDeclaration",
                  "scope": 2662,
                  "src": "3903:4:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bool",
                    "typeString": "bool"
                  },
                  "typeName": {
                    "id": 2652,
                    "name": "bool",
                    "nodeType": "ElementaryTypeName",
                    "src": "3903:4:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bool",
                      "typeString": "bool"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                }
              ],
              "src": "3902:6:6"
            },
            "scope": 2737,
            "src": "3799:163:6",
            "stateMutability": "pure",
            "superFunction": null,
            "visibility": "public"
          },
          {
            "body": {
              "id": 2677,
              "nodeType": "Block",
              "src": "4381:56:6",
              "statements": [
                {
                  "expression": {
                    "argumentTypes": null,
                    "commonType": {
                      "typeIdentifier": "t_bytes32",
                      "typeString": "bytes32"
                    },
                    "id": 2675,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "lValueRequested": false,
                    "leftExpression": {
                      "argumentTypes": null,
                      "arguments": [
                        {
                          "argumentTypes": null,
                          "id": 2672,
                          "name": "_candidate",
                          "nodeType": "Identifier",
                          "overloadedDeclarations": [],
                          "referencedDeclaration": 2664,
                          "src": "4408:10:6",
                          "typeDescriptions": {
                            "typeIdentifier": "t_bytes_memory_ptr",
                            "typeString": "bytes memory"
                          }
                        }
                      ],
                      "expression": {
                        "argumentTypes": [
                          {
                            "typeIdentifier": "t_bytes_memory_ptr",
                            "typeString": "bytes memory"
                          }
                        ],
                        "id": 2671,
                        "name": "keccak256",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 10510,
                        "src": "4398:9:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_function_sha3_pure$__$returns$_t_bytes32_$",
                          "typeString": "function () pure returns (bytes32)"
                        }
                      },
                      "id": 2673,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": false,
                      "kind": "functionCall",
                      "lValueRequested": false,
                      "names": [],
                      "nodeType": "FunctionCall",
                      "src": "4398:21:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_bytes32",
                        "typeString": "bytes32"
                      }
                    },
                    "nodeType": "BinaryOperation",
                    "operator": "==",
                    "rightExpression": {
                      "argumentTypes": null,
                      "id": 2674,
                      "name": "_digest",
                      "nodeType": "Identifier",
                      "overloadedDeclarations": [],
                      "referencedDeclaration": 2666,
                      "src": "4423:7:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_bytes32",
                        "typeString": "bytes32"
                      }
                    },
                    "src": "4398:32:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bool",
                      "typeString": "bool"
                    }
                  },
                  "functionReturnParameters": 2670,
                  "id": 2676,
                  "nodeType": "Return",
                  "src": "4391:39:6"
                }
              ]
            },
            "documentation": "@notice             checks if a message is the keccak256 preimage of a digest\n @dev                this step is necessary for ECDSA security!\n @param _digest      the digest\n @param _candidate   the purported preimage\n @return             the p2wkph output script",
            "id": 2678,
            "implemented": true,
            "isConstructor": false,
            "isDeclaredConst": true,
            "modifiers": [],
            "name": "isKeccak256Preimage",
            "nodeType": "FunctionDefinition",
            "parameters": {
              "id": 2667,
              "nodeType": "ParameterList",
              "parameters": [
                {
                  "constant": false,
                  "id": 2664,
                  "name": "_candidate",
                  "nodeType": "VariableDeclaration",
                  "scope": 2678,
                  "src": "4306:16:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes_memory_ptr",
                    "typeString": "bytes"
                  },
                  "typeName": {
                    "id": 2663,
                    "name": "bytes",
                    "nodeType": "ElementaryTypeName",
                    "src": "4306:5:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_storage_ptr",
                      "typeString": "bytes"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2666,
                  "name": "_digest",
                  "nodeType": "VariableDeclaration",
                  "scope": 2678,
                  "src": "4332:15:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes32",
                    "typeString": "bytes32"
                  },
                  "typeName": {
                    "id": 2665,
                    "name": "bytes32",
                    "nodeType": "ElementaryTypeName",
                    "src": "4332:7:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes32",
                      "typeString": "bytes32"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                }
              ],
              "src": "4296:57:6"
            },
            "payable": false,
            "returnParameters": {
              "id": 2670,
              "nodeType": "ParameterList",
              "parameters": [
                {
                  "constant": false,
                  "id": 2669,
                  "name": "",
                  "nodeType": "VariableDeclaration",
                  "scope": 2678,
                  "src": "4375:4:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bool",
                    "typeString": "bool"
                  },
                  "typeName": {
                    "id": 2668,
                    "name": "bool",
                    "nodeType": "ElementaryTypeName",
                    "src": "4375:4:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bool",
                      "typeString": "bool"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                }
              ],
              "src": "4374:6:6"
            },
            "scope": 2737,
            "src": "4268:169:6",
            "stateMutability": "pure",
            "superFunction": null,
            "visibility": "public"
          },
          {
            "body": {
              "id": 2735,
              "nodeType": "Block",
              "src": "5384:1113:6",
              "statements": [
                {
                  "assignments": [
                    2694
                  ],
                  "declarations": [
                    {
                      "constant": false,
                      "id": 2694,
                      "name": "_scriptCode",
                      "nodeType": "VariableDeclaration",
                      "scope": 2736,
                      "src": "5501:24:6",
                      "stateVariable": false,
                      "storageLocation": "memory",
                      "typeDescriptions": {
                        "typeIdentifier": "t_bytes_memory_ptr",
                        "typeString": "bytes"
                      },
                      "typeName": {
                        "id": 2693,
                        "name": "bytes",
                        "nodeType": "ElementaryTypeName",
                        "src": "5501:5:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_storage_ptr",
                          "typeString": "bytes"
                        }
                      },
                      "value": null,
                      "visibility": "internal"
                    }
                  ],
                  "id": 2701,
                  "initialValue": {
                    "argumentTypes": null,
                    "arguments": [
                      {
                        "argumentTypes": null,
                        "hexValue": "1976a914",
                        "id": 2697,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": true,
                        "kind": "string",
                        "lValueRequested": false,
                        "nodeType": "Literal",
                        "src": "5558:13:6",
                        "subdenomination": null,
                        "typeDescriptions": {
                          "typeIdentifier": "t_stringliteral_16c8cfb2189d45894fd227d6cf32ba616da47433f9bbc2f735a1096c3618c12f",
                          "typeString": "literal_string (contains invalid UTF-8 sequence at position 2)"
                        },
                        "value": null
                      },
                      {
                        "argumentTypes": null,
                        "id": 2698,
                        "name": "_inputPKH",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2682,
                        "src": "5622:9:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes20",
                          "typeString": "bytes20"
                        }
                      },
                      {
                        "argumentTypes": null,
                        "hexValue": "88ac",
                        "id": 2699,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": true,
                        "kind": "string",
                        "lValueRequested": false,
                        "nodeType": "Literal",
                        "src": "5645:9:6",
                        "subdenomination": null,
                        "typeDescriptions": {
                          "typeIdentifier": "t_stringliteral_3b50b2715f5a28d2a7eeb517f17ec797e8536bd425bf31fc4f6bf7ce1e34b77d",
                          "typeString": "literal_string (contains invalid UTF-8 sequence at position 0)"
                        },
                        "value": null
                      }
                    ],
                    "expression": {
                      "argumentTypes": [
                        {
                          "typeIdentifier": "t_stringliteral_16c8cfb2189d45894fd227d6cf32ba616da47433f9bbc2f735a1096c3618c12f",
                          "typeString": "literal_string (contains invalid UTF-8 sequence at position 2)"
                        },
                        {
                          "typeIdentifier": "t_bytes20",
                          "typeString": "bytes20"
                        },
                        {
                          "typeIdentifier": "t_stringliteral_3b50b2715f5a28d2a7eeb517f17ec797e8536bd425bf31fc4f6bf7ce1e34b77d",
                          "typeString": "literal_string (contains invalid UTF-8 sequence at position 0)"
                        }
                      ],
                      "expression": {
                        "argumentTypes": null,
                        "id": 2695,
                        "name": "abi",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 10503,
                        "src": "5528:3:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_magic_abi",
                          "typeString": "abi"
                        }
                      },
                      "id": 2696,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": true,
                      "lValueRequested": false,
                      "memberName": "encodePacked",
                      "nodeType": "MemberAccess",
                      "referencedDeclaration": null,
                      "src": "5528:16:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_function_abiencodepacked_pure$__$returns$_t_bytes_memory_ptr_$",
                        "typeString": "function () pure returns (bytes memory)"
                      }
                    },
                    "id": 2700,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "kind": "functionCall",
                    "lValueRequested": false,
                    "names": [],
                    "nodeType": "FunctionCall",
                    "src": "5528:127:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_memory_ptr",
                      "typeString": "bytes memory"
                    }
                  },
                  "nodeType": "VariableDeclarationStatement",
                  "src": "5501:154:6"
                },
                {
                  "assignments": [
                    2703
                  ],
                  "declarations": [
                    {
                      "constant": false,
                      "id": 2703,
                      "name": "_hashOutputs",
                      "nodeType": "VariableDeclaration",
                      "scope": 2736,
                      "src": "5685:20:6",
                      "stateVariable": false,
                      "storageLocation": "default",
                      "typeDescriptions": {
                        "typeIdentifier": "t_bytes32",
                        "typeString": "bytes32"
                      },
                      "typeName": {
                        "id": 2702,
                        "name": "bytes32",
                        "nodeType": "ElementaryTypeName",
                        "src": "5685:7:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        }
                      },
                      "value": null,
                      "visibility": "internal"
                    }
                  ],
                  "id": 2712,
                  "initialValue": {
                    "argumentTypes": null,
                    "arguments": [],
                    "expression": {
                      "argumentTypes": [],
                      "expression": {
                        "argumentTypes": null,
                        "arguments": [
                          {
                            "argumentTypes": null,
                            "id": 2706,
                            "name": "_outputValue",
                            "nodeType": "Identifier",
                            "overloadedDeclarations": [],
                            "referencedDeclaration": 2686,
                            "src": "5738:12:6",
                            "typeDescriptions": {
                              "typeIdentifier": "t_bytes8",
                              "typeString": "bytes8"
                            }
                          },
                          {
                            "argumentTypes": null,
                            "hexValue": "160014",
                            "id": 2707,
                            "isConstant": false,
                            "isLValue": false,
                            "isPure": true,
                            "kind": "string",
                            "lValueRequested": false,
                            "nodeType": "Literal",
                            "src": "5778:11:6",
                            "subdenomination": null,
                            "typeDescriptions": {
                              "typeIdentifier": "t_stringliteral_bde11925feafe00f4d9d48ef4480be1ea68d808b9c557770a6133e20d41f44bf",
                              "typeString": "literal_string \"\u0016\u0000\u0014\""
                            },
                            "value": "\u0016\u0000\u0014"
                          },
                          {
                            "argumentTypes": null,
                            "id": 2708,
                            "name": "_outputPKH",
                            "nodeType": "Identifier",
                            "overloadedDeclarations": [],
                            "referencedDeclaration": 2688,
                            "src": "5827:10:6",
                            "typeDescriptions": {
                              "typeIdentifier": "t_bytes20",
                              "typeString": "bytes20"
                            }
                          }
                        ],
                        "expression": {
                          "argumentTypes": [
                            {
                              "typeIdentifier": "t_bytes8",
                              "typeString": "bytes8"
                            },
                            {
                              "typeIdentifier": "t_stringliteral_bde11925feafe00f4d9d48ef4480be1ea68d808b9c557770a6133e20d41f44bf",
                              "typeString": "literal_string \"\u0016\u0000\u0014\""
                            },
                            {
                              "typeIdentifier": "t_bytes20",
                              "typeString": "bytes20"
                            }
                          ],
                          "expression": {
                            "argumentTypes": null,
                            "id": 2704,
                            "name": "abi",
                            "nodeType": "Identifier",
                            "overloadedDeclarations": [],
                            "referencedDeclaration": 10503,
                            "src": "5708:3:6",
                            "typeDescriptions": {
                              "typeIdentifier": "t_magic_abi",
                              "typeString": "abi"
                            }
                          },
                          "id": 2705,
                          "isConstant": false,
                          "isLValue": false,
                          "isPure": true,
                          "lValueRequested": false,
                          "memberName": "encodePacked",
                          "nodeType": "MemberAccess",
                          "referencedDeclaration": null,
                          "src": "5708:16:6",
                          "typeDescriptions": {
                            "typeIdentifier": "t_function_abiencodepacked_pure$__$returns$_t_bytes_memory_ptr_$",
                            "typeString": "function () pure returns (bytes memory)"
                          }
                        },
                        "id": 2709,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": false,
                        "kind": "functionCall",
                        "lValueRequested": false,
                        "names": [],
                        "nodeType": "FunctionCall",
                        "src": "5708:130:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        }
                      },
                      "id": 2710,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": false,
                      "lValueRequested": false,
                      "memberName": "hash256",
                      "nodeType": "MemberAccess",
                      "referencedDeclaration": 679,
                      "src": "5708:138:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_function_delegatecall_pure$_t_bytes_memory_ptr_$returns$_t_bytes32_$bound_to$_t_bytes_memory_ptr_$",
                        "typeString": "function (bytes memory) pure returns (bytes32)"
                      }
                    },
                    "id": 2711,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "kind": "functionCall",
                    "lValueRequested": false,
                    "names": [],
                    "nodeType": "FunctionCall",
                    "src": "5708:140:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes32",
                      "typeString": "bytes32"
                    }
                  },
                  "nodeType": "VariableDeclarationStatement",
                  "src": "5685:163:6"
                },
                {
                  "assignments": [
                    2714
                  ],
                  "declarations": [
                    {
                      "constant": false,
                      "id": 2714,
                      "name": "_sighashPreimage",
                      "nodeType": "VariableDeclaration",
                      "scope": 2736,
                      "src": "5858:29:6",
                      "stateVariable": false,
                      "storageLocation": "memory",
                      "typeDescriptions": {
                        "typeIdentifier": "t_bytes_memory_ptr",
                        "typeString": "bytes"
                      },
                      "typeName": {
                        "id": 2713,
                        "name": "bytes",
                        "nodeType": "ElementaryTypeName",
                        "src": "5858:5:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_storage_ptr",
                          "typeString": "bytes"
                        }
                      },
                      "value": null,
                      "visibility": "internal"
                    }
                  ],
                  "id": 2730,
                  "initialValue": {
                    "argumentTypes": null,
                    "arguments": [
                      {
                        "argumentTypes": null,
                        "hexValue": "01000000",
                        "id": 2717,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": true,
                        "kind": "string",
                        "lValueRequested": false,
                        "nodeType": "Literal",
                        "src": "5920:13:6",
                        "subdenomination": null,
                        "typeDescriptions": {
                          "typeIdentifier": "t_stringliteral_e37890bf230cf36ea140a5dbb9a561aa7ef84f8f995873db8386eba4a95c7bbe",
                          "typeString": "literal_string \"\u0001\u0000\u0000\u0000\""
                        },
                        "value": "\u0001\u0000\u0000\u0000"
                      },
                      {
                        "argumentTypes": null,
                        "arguments": [],
                        "expression": {
                          "argumentTypes": [],
                          "expression": {
                            "argumentTypes": null,
                            "id": 2718,
                            "name": "_outpoint",
                            "nodeType": "Identifier",
                            "overloadedDeclarations": [],
                            "referencedDeclaration": 2680,
                            "src": "5959:9:6",
                            "typeDescriptions": {
                              "typeIdentifier": "t_bytes_memory_ptr",
                              "typeString": "bytes memory"
                            }
                          },
                          "id": 2719,
                          "isConstant": false,
                          "isLValue": false,
                          "isPure": false,
                          "lValueRequested": false,
                          "memberName": "hash256",
                          "nodeType": "MemberAccess",
                          "referencedDeclaration": 679,
                          "src": "5959:17:6",
                          "typeDescriptions": {
                            "typeIdentifier": "t_function_delegatecall_pure$_t_bytes_memory_ptr_$returns$_t_bytes32_$bound_to$_t_bytes_memory_ptr_$",
                            "typeString": "function (bytes memory) pure returns (bytes32)"
                          }
                        },
                        "id": 2720,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": false,
                        "kind": "functionCall",
                        "lValueRequested": false,
                        "names": [],
                        "nodeType": "FunctionCall",
                        "src": "5959:19:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        }
                      },
                      {
                        "argumentTypes": null,
                        "hexValue": "8cb9012517c817fead650287d61bdd9c68803b6bf9c64133dcab3e65b5a50cb9",
                        "id": 2721,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": true,
                        "kind": "string",
                        "lValueRequested": false,
                        "nodeType": "Literal",
                        "src": "6009:69:6",
                        "subdenomination": null,
                        "typeDescriptions": {
                          "typeIdentifier": "t_stringliteral_de9eeb8dbbea7702bb2ae084a168f6422ddcaa5a73975470e9f2441f0c122d45",
                          "typeString": "literal_string (contains invalid UTF-8 sequence at position 0)"
                        },
                        "value": null
                      },
                      {
                        "argumentTypes": null,
                        "id": 2722,
                        "name": "_outpoint",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2680,
                        "src": "6119:9:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        }
                      },
                      {
                        "argumentTypes": null,
                        "id": 2723,
                        "name": "_scriptCode",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2694,
                        "src": "6155:11:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        }
                      },
                      {
                        "argumentTypes": null,
                        "id": 2724,
                        "name": "_inputValue",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2684,
                        "src": "6203:11:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes8",
                          "typeString": "bytes8"
                        }
                      },
                      {
                        "argumentTypes": null,
                        "hexValue": "00000000",
                        "id": 2725,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": true,
                        "kind": "string",
                        "lValueRequested": false,
                        "nodeType": "Literal",
                        "src": "6264:13:6",
                        "subdenomination": null,
                        "typeDescriptions": {
                          "typeIdentifier": "t_stringliteral_e8e77626586f73b955364c7b4bbf0bb7f7685ebd40e852b164633a4acbd3244c",
                          "typeString": "literal_string \"\u0000\u0000\u0000\u0000\""
                        },
                        "value": "\u0000\u0000\u0000\u0000"
                      },
                      {
                        "argumentTypes": null,
                        "id": 2726,
                        "name": "_hashOutputs",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2703,
                        "src": "6311:12:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        }
                      },
                      {
                        "argumentTypes": null,
                        "hexValue": "00000000",
                        "id": 2727,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": true,
                        "kind": "string",
                        "lValueRequested": false,
                        "nodeType": "Literal",
                        "src": "6367:13:6",
                        "subdenomination": null,
                        "typeDescriptions": {
                          "typeIdentifier": "t_stringliteral_e8e77626586f73b955364c7b4bbf0bb7f7685ebd40e852b164633a4acbd3244c",
                          "typeString": "literal_string \"\u0000\u0000\u0000\u0000\""
                        },
                        "value": "\u0000\u0000\u0000\u0000"
                      },
                      {
                        "argumentTypes": null,
                        "hexValue": "01000000",
                        "id": 2728,
                        "isConstant": false,
                        "isLValue": false,
                        "isPure": true,
                        "kind": "string",
                        "lValueRequested": false,
                        "nodeType": "Literal",
                        "src": "6408:13:6",
                        "subdenomination": null,
                        "typeDescriptions": {
                          "typeIdentifier": "t_stringliteral_e37890bf230cf36ea140a5dbb9a561aa7ef84f8f995873db8386eba4a95c7bbe",
                          "typeString": "literal_string \"\u0001\u0000\u0000\u0000\""
                        },
                        "value": "\u0001\u0000\u0000\u0000"
                      }
                    ],
                    "expression": {
                      "argumentTypes": [
                        {
                          "typeIdentifier": "t_stringliteral_e37890bf230cf36ea140a5dbb9a561aa7ef84f8f995873db8386eba4a95c7bbe",
                          "typeString": "literal_string \"\u0001\u0000\u0000\u0000\""
                        },
                        {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        },
                        {
                          "typeIdentifier": "t_stringliteral_de9eeb8dbbea7702bb2ae084a168f6422ddcaa5a73975470e9f2441f0c122d45",
                          "typeString": "literal_string (contains invalid UTF-8 sequence at position 0)"
                        },
                        {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        },
                        {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        },
                        {
                          "typeIdentifier": "t_bytes8",
                          "typeString": "bytes8"
                        },
                        {
                          "typeIdentifier": "t_stringliteral_e8e77626586f73b955364c7b4bbf0bb7f7685ebd40e852b164633a4acbd3244c",
                          "typeString": "literal_string \"\u0000\u0000\u0000\u0000\""
                        },
                        {
                          "typeIdentifier": "t_bytes32",
                          "typeString": "bytes32"
                        },
                        {
                          "typeIdentifier": "t_stringliteral_e8e77626586f73b955364c7b4bbf0bb7f7685ebd40e852b164633a4acbd3244c",
                          "typeString": "literal_string \"\u0000\u0000\u0000\u0000\""
                        },
                        {
                          "typeIdentifier": "t_stringliteral_e37890bf230cf36ea140a5dbb9a561aa7ef84f8f995873db8386eba4a95c7bbe",
                          "typeString": "literal_string \"\u0001\u0000\u0000\u0000\""
                        }
                      ],
                      "expression": {
                        "argumentTypes": null,
                        "id": 2715,
                        "name": "abi",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 10503,
                        "src": "5890:3:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_magic_abi",
                          "typeString": "abi"
                        }
                      },
                      "id": 2716,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": true,
                      "lValueRequested": false,
                      "memberName": "encodePacked",
                      "nodeType": "MemberAccess",
                      "referencedDeclaration": null,
                      "src": "5890:16:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_function_abiencodepacked_pure$__$returns$_t_bytes_memory_ptr_$",
                        "typeString": "function () pure returns (bytes memory)"
                      }
                    },
                    "id": 2729,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "kind": "functionCall",
                    "lValueRequested": false,
                    "names": [],
                    "nodeType": "FunctionCall",
                    "src": "5890:557:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_memory_ptr",
                      "typeString": "bytes memory"
                    }
                  },
                  "nodeType": "VariableDeclarationStatement",
                  "src": "5858:589:6"
                },
                {
                  "expression": {
                    "argumentTypes": null,
                    "arguments": [],
                    "expression": {
                      "argumentTypes": [],
                      "expression": {
                        "argumentTypes": null,
                        "id": 2731,
                        "name": "_sighashPreimage",
                        "nodeType": "Identifier",
                        "overloadedDeclarations": [],
                        "referencedDeclaration": 2714,
                        "src": "6464:16:6",
                        "typeDescriptions": {
                          "typeIdentifier": "t_bytes_memory_ptr",
                          "typeString": "bytes memory"
                        }
                      },
                      "id": 2732,
                      "isConstant": false,
                      "isLValue": false,
                      "isPure": false,
                      "lValueRequested": false,
                      "memberName": "hash256",
                      "nodeType": "MemberAccess",
                      "referencedDeclaration": 679,
                      "src": "6464:24:6",
                      "typeDescriptions": {
                        "typeIdentifier": "t_function_delegatecall_pure$_t_bytes_memory_ptr_$returns$_t_bytes32_$bound_to$_t_bytes_memory_ptr_$",
                        "typeString": "function (bytes memory) pure returns (bytes32)"
                      }
                    },
                    "id": 2733,
                    "isConstant": false,
                    "isLValue": false,
                    "isPure": false,
                    "kind": "functionCall",
                    "lValueRequested": false,
                    "names": [],
                    "nodeType": "FunctionCall",
                    "src": "6464:26:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes32",
                      "typeString": "bytes32"
                    }
                  },
                  "functionReturnParameters": 2692,
                  "id": 2734,
                  "nodeType": "Return",
                  "src": "6457:33:6"
                }
              ]
            },
            "documentation": "@notice                 calculates the signature hash of a Bitcoin transaction with the provided details\n @dev                    documented in bip143. many values are hardcoded here\n @param _outpoint        the bitcoin output script\n @param _inputPKH        the input pubkeyhash (hash160(sender_pubkey))\n @param _inputValue      the value of the input in satoshi\n @param _outputValue     the value of the output in satoshi\n @param _outputPKH       the output pubkeyhash (hash160(recipient_pubkey))\n @return                 the double-sha256 (hash256) signature hash as defined by bip143",
            "id": 2736,
            "implemented": true,
            "isConstructor": false,
            "isDeclaredConst": true,
            "modifiers": [],
            "name": "oneInputOneOutputSighash",
            "nodeType": "FunctionDefinition",
            "parameters": {
              "id": 2689,
              "nodeType": "ParameterList",
              "parameters": [
                {
                  "constant": false,
                  "id": 2680,
                  "name": "_outpoint",
                  "nodeType": "VariableDeclaration",
                  "scope": 2736,
                  "src": "5132:15:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes_memory_ptr",
                    "typeString": "bytes"
                  },
                  "typeName": {
                    "id": 2679,
                    "name": "bytes",
                    "nodeType": "ElementaryTypeName",
                    "src": "5132:5:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes_storage_ptr",
                      "typeString": "bytes"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2682,
                  "name": "_inputPKH",
                  "nodeType": "VariableDeclaration",
                  "scope": 2736,
                  "src": "5177:17:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes20",
                    "typeString": "bytes20"
                  },
                  "typeName": {
                    "id": 2681,
                    "name": "bytes20",
                    "nodeType": "ElementaryTypeName",
                    "src": "5177:7:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes20",
                      "typeString": "bytes20"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2684,
                  "name": "_inputValue",
                  "nodeType": "VariableDeclaration",
                  "scope": 2736,
                  "src": "5224:18:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes8",
                    "typeString": "bytes8"
                  },
                  "typeName": {
                    "id": 2683,
                    "name": "bytes8",
                    "nodeType": "ElementaryTypeName",
                    "src": "5224:6:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes8",
                      "typeString": "bytes8"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2686,
                  "name": "_outputValue",
                  "nodeType": "VariableDeclaration",
                  "scope": 2736,
                  "src": "5266:19:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes8",
                    "typeString": "bytes8"
                  },
                  "typeName": {
                    "id": 2685,
                    "name": "bytes8",
                    "nodeType": "ElementaryTypeName",
                    "src": "5266:6:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes8",
                      "typeString": "bytes8"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                },
                {
                  "constant": false,
                  "id": 2688,
                  "name": "_outputPKH",
                  "nodeType": "VariableDeclaration",
                  "scope": 2736,
                  "src": "5309:18:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes20",
                    "typeString": "bytes20"
                  },
                  "typeName": {
                    "id": 2687,
                    "name": "bytes20",
                    "nodeType": "ElementaryTypeName",
                    "src": "5309:7:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes20",
                      "typeString": "bytes20"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                }
              ],
              "src": "5122:231:6"
            },
            "payable": false,
            "returnParameters": {
              "id": 2692,
              "nodeType": "ParameterList",
              "parameters": [
                {
                  "constant": false,
                  "id": 2691,
                  "name": "",
                  "nodeType": "VariableDeclaration",
                  "scope": 2736,
                  "src": "5375:7:6",
                  "stateVariable": false,
                  "storageLocation": "default",
                  "typeDescriptions": {
                    "typeIdentifier": "t_bytes32",
                    "typeString": "bytes32"
                  },
                  "typeName": {
                    "id": 2690,
                    "name": "bytes32",
                    "nodeType": "ElementaryTypeName",
                    "src": "5375:7:6",
                    "typeDescriptions": {
                      "typeIdentifier": "t_bytes32",
                      "typeString": "bytes32"
                    }
                  },
                  "value": null,
                  "visibility": "internal"
                }
              ],
              "src": "5374:9:6"
            },
            "scope": 2737,
            "src": "5089:1408:6",
            "stateMutability": "pure",
            "superFunction": null,
            "visibility": "public"
          }
        ],
        "scope": 2738,
        "src": "182:6317:6"
      }
    ],
    "src": "0:6500:6"
  },
  "compiler": {
    "name": "solc",
    "version": "0.4.25+commit.59dbf8f1.Emscripten.clang"
  },
  "networks": {
    "1563533123569": {
      "events": {},
      "links": {
        "BTCUtils": "0x55e4645BD26a537D4134ca8d31fF820369027583"
      },
      "address": "0x44C683292eb5A3C5A52aF6959953F2FFc81F454C",
      "transactionHash": "0xc5801a3247cf5c4e13b7d0ceffd6881707d0414908cc7908d9e67413a6d129ec"
    },
    "1564486898078": {
      "events": {},
      "links": {
        "BTCUtils": "0x9b0FC4d71064Bce86280e783DAAD6215ce458790"
      },
      "address": "0xD828c19EF059Dade5cCd08585477e43893BfE351",
      "transactionHash": "0xd52b2ba8c53c7b06ff48e36db7beaefb58eb35336727f15730e3e0c5f3408498"
    },
    "1564576405726": {
      "events": {},
      "links": {
        "BTCUtils": "0x9d7e99654e7b3460c43335e9De97FCf3382Ff96d"
      },
      "address": "0x8E7506008bC25a4d1A690002a8cf0F18B1221774",
      "transactionHash": "0x27bfc4b3f745740cc2bf6b3cdc2536c71b6f1579e811e768129d610336da58c3"
    },
    "1564669548315": {
      "events": {},
      "links": {
        "BTCUtils": "0xAcD4869E1DC79aC0218234BB2873D9BfEdcd6360"
      },
      "address": "0x8a8Ee16715B3dD19691d7b916Ee49D17D59f6Ef7",
      "transactionHash": "0xc08de1e24a355ba524daab1e82d64088b06266a59f22983be0f8a4b72ef851d7"
    }
  },
  "schemaVersion": "3.0.10",
  "updatedAt": "2019-08-01T17:39:26.721Z",
  "devdoc": {
    "methods": {
      "accountFromPubkey(bytes)": {
        "details": "the address is the last 20 bytes of the keccak256 of the address",
        "params": {
          "_pubkey": "the public key"
        },
        "return": "the account address"
      },
      "checkBitcoinSig(bytes,bytes,bytes32,uint8,bytes32,bytes32)": {
        "details": "does this my verifying the p2wpkh matches an ethereum account",
        "params": {
          "_digest": "the message digest signed",
          "_p2wpkhOutputScript": "the bitcoin output script",
          "_pubkey": "the public key to check",
          "_r": "the signature r value",
          "_s": "the signature s value",
          "_v": "the signature recovery value"
        },
        "return": "true if signature is valid, else false"
      },
      "checkSig(bytes,bytes32,uint8,bytes32,bytes32)": {
        "details": "does this using ecrecover because Ethereum has no soul",
        "params": {
          "_digest": "the message digest signed",
          "_pubkey": "the public key to check (64 bytes)",
          "_r": "the signature r value",
          "_s": "the signature s value",
          "_v": "the signature recovery value"
        },
        "return": "true if signature is valid, else false"
      },
      "isKeccak256Preimage(bytes,bytes32)": {
        "details": "this step is necessary for ECDSA security!",
        "params": {
          "_candidate": "the purported preimage",
          "_digest": "the digest"
        },
        "return": "the p2wkph output script"
      },
      "isSha256Preimage(bytes,bytes32)": {
        "details": "this is NOT the hash256!  this step is necessary for ECDSA security!",
        "params": {
          "_candidate": "the purported preimage",
          "_digest": "the digest"
        },
        "return": "the p2wkph output script"
      },
      "oneInputOneOutputSighash(bytes,bytes20,bytes8,bytes8,bytes20)": {
        "details": "documented in bip143. many values are hardcoded here",
        "params": {
          "_inputPKH": "the input pubkeyhash (hash160(sender_pubkey))",
          "_inputValue": "the value of the input in satoshi",
          "_outpoint": "the bitcoin output script",
          "_outputPKH": "the output pubkeyhash (hash160(recipient_pubkey))",
          "_outputValue": "the value of the output in satoshi"
        },
        "return": "the double-sha256 (hash256) signature hash as defined by bip143"
      },
      "p2wpkhFromPubkey(bytes)": {
        "details": "pads uncompressed pubkeys to 65 bytes as required by Bitcoin",
        "params": {
          "_pubkey": "the public key"
        },
        "return": "the p2wkph output script"
      }
    }
  },
  "userdoc": {
    "methods": {
      "accountFromPubkey(bytes)": {
        "notice": "derives an Ethereum Account address from a pubkey"
      },
      "checkBitcoinSig(bytes,bytes,bytes32,uint8,bytes32,bytes32)": {
        "notice": "checks a signed message against a bitcoin p2wpkh output script"
      },
      "checkSig(bytes,bytes32,uint8,bytes32,bytes32)": {
        "notice": "checks a signed message's validity under a pubkey"
      },
      "isKeccak256Preimage(bytes,bytes32)": {
        "notice": "checks if a message is the keccak256 preimage of a digest"
      },
      "isSha256Preimage(bytes,bytes32)": {
        "notice": "checks if a message is the sha256 preimage of a digest"
      },
      "oneInputOneOutputSighash(bytes,bytes20,bytes8,bytes8,bytes20)": {
        "notice": "calculates the signature hash of a Bitcoin transaction with the provided details"
      },
      "p2wpkhFromPubkey(bytes)": {
        "notice": "calculates the p2wpkh output script of a pubkey"
      }
    }
  }
}